{"result_index": 0, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.\n(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/extension.js", "start_line": 407, "start_column": 42, "end_line": null, "end_column": 46, "snippet": "  402: }\n  403: \n  404: /////\n  405: \n  406: function setEventEmitterEvents() {\n  407:     eventEmitter.on('send_ch4_message', (data) => {\n  408:         websocketProvider.send_ch4_message(data);\n  409:     });\n  410: \n  411:     eventEmitter.on('request_connect', (environment) => {\n  412:         refreshEnvironmentsInSidebar().then(() => {"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 290, "start_column": 90, "end_line": null, "end_column": 102, "snippet": "  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });"}}, {"message": "[\"mkdir ... id() }]", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 290, "start_column": 80, "end_line": null, "end_column": 156, "snippet": "  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });"}}, {"message": "data", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/extension.js", "start_line": 407, "start_column": 42, "end_line": null, "end_column": 46, "snippet": "  402: }\n  403: \n  404: /////\n  405: \n  406: function setEventEmitterEvents() {\n  407:     eventEmitter.on('send_ch4_message', (data) => {\n  408:         websocketProvider.send_ch4_message(data);\n  409:     });\n  410: \n  411:     eventEmitter.on('request_connect', (environment) => {\n  412:         refreshEnvironmentsInSidebar().then(() => {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 290, "start_column": 90, "end_line": null, "end_column": 102, "snippet": "  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });"}}, {"message": "[\"mkdir ... id() }]", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 290, "start_column": 80, "end_line": null, "end_column": 156, "snippet": "  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });"}}, {"message": "data", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/extension.js", "start_line": 407, "start_column": 42, "end_line": null, "end_column": 46, "snippet": "  402: }\n  403: \n  404: /////\n  405: \n  406: function setEventEmitterEvents() {\n  407:     eventEmitter.on('send_ch4_message', (data) => {\n  408:         websocketProvider.send_ch4_message(data);\n  409:     });\n  410: \n  411:     eventEmitter.on('request_connect', (environment) => {\n  412:         refreshEnvironmentsInSidebar().then(() => {"}}, {"message": "data", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/extension.js", "start_line": 407, "start_column": 42, "end_line": null, "end_column": 46, "snippet": "  402: }\n  403: \n  404: /////\n  405: \n  406: function setEventEmitterEvents() {\n  407:     eventEmitter.on('send_ch4_message', (data) => {\n  408:         websocketProvider.send_ch4_message(data);\n  409:     });\n  410: \n  411:     eventEmitter.on('request_connect', (environment) => {\n  412:         refreshEnvironmentsInSidebar().then(() => {"}}]}
{"result_index": 1, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/extension.js", "start_line": 408, "start_column": 44, "end_line": null, "end_column": 48, "snippet": "  403: \n  404: /////\n  405: \n  406: function setEventEmitterEvents() {\n  407:     eventEmitter.on('send_ch4_message', (data) => {\n  408:         websocketProvider.send_ch4_message(data);\n  409:     });\n  410: \n  411:     eventEmitter.on('request_connect', (environment) => {\n  412:         refreshEnvironmentsInSidebar().then(() => {\n  413:             commandConnect(environment);"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 290, "start_column": 90, "end_line": null, "end_column": 102, "snippet": "  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });"}}, {"message": "[\"mkdir ... id() }]", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 290, "start_column": 80, "end_line": null, "end_column": 156, "snippet": "  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });"}}, {"message": "data", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/extension.js", "start_line": 407, "start_column": 42, "end_line": null, "end_column": 46, "snippet": "  402: }\n  403: \n  404: /////\n  405: \n  406: function setEventEmitterEvents() {\n  407:     eventEmitter.on('send_ch4_message', (data) => {\n  408:         websocketProvider.send_ch4_message(data);\n  409:     });\n  410: \n  411:     eventEmitter.on('request_connect', (environment) => {\n  412:         refreshEnvironmentsInSidebar().then(() => {"}}, {"message": "data", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/extension.js", "start_line": 408, "start_column": 44, "end_line": null, "end_column": 48, "snippet": "  403: \n  404: /////\n  405: \n  406: function setEventEmitterEvents() {\n  407:     eventEmitter.on('send_ch4_message', (data) => {\n  408:         websocketProvider.send_ch4_message(data);\n  409:     });\n  410: \n  411:     eventEmitter.on('request_connect', (environment) => {\n  412:         refreshEnvironmentsInSidebar().then(() => {\n  413:             commandConnect(environment);"}}]}
{"result_index": 2, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.\n(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 177, "start_column": 24, "end_line": null, "end_column": 32, "snippet": "  172:         });\n  173:     }\n  174:     uploadNewFile(filename) {\n  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 313, "start_column": 65, "end_line": null, "end_column": 77, "snippet": "  308:                                         console.log(\"Uploading new file\");\n  309:                                         this.uploadRemoteFile(relativePath, fs.readFileSync(filepath));\n  310:                                     }\n  311:                                     else if (lftime > ftime + SYNC_TIME_VARIANCE) {\n  312:                                         console.log(\"Updating existing file\");\n  313:                                         this.uploadExistingFile(relativePath, fs.readFileSync(filepath));\n  314:                                     }\n  315:                                     resolve();\n  316:                                 }\n  317:                                 else {\n  318:                                     console.log(\"Unknown file type\");"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 177, "start_column": 24, "end_line": null, "end_column": 32, "snippet": "  172:         });\n  173:     }\n  174:     uploadNewFile(filename) {\n  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 313, "start_column": 65, "end_line": null, "end_column": 77, "snippet": "  308:                                         console.log(\"Uploading new file\");\n  309:                                         this.uploadRemoteFile(relativePath, fs.readFileSync(filepath));\n  310:                                     }\n  311:                                     else if (lftime > ftime + SYNC_TIME_VARIANCE) {\n  312:                                         console.log(\"Updating existing file\");\n  313:                                         this.uploadExistingFile(relativePath, fs.readFileSync(filepath));\n  314:                                     }\n  315:                                     resolve();\n  316:                                 }\n  317:                                 else {\n  318:                                     console.log(\"Unknown file type\");"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 177, "start_column": 24, "end_line": null, "end_column": 32, "snippet": "  172:         });\n  173:     }\n  174:     uploadNewFile(filename) {\n  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 177, "start_column": 24, "end_line": null, "end_column": 32, "snippet": "  172:         });\n  173:     }\n  174:     uploadNewFile(filename) {\n  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({"}}]}
{"result_index": 3, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 178, "start_column": 38, "end_line": null, "end_column": 46, "snippet": "  173:     }\n  174:     uploadNewFile(filename) {\n  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 313, "start_column": 65, "end_line": null, "end_column": 77, "snippet": "  308:                                         console.log(\"Uploading new file\");\n  309:                                         this.uploadRemoteFile(relativePath, fs.readFileSync(filepath));\n  310:                                     }\n  311:                                     else if (lftime > ftime + SYNC_TIME_VARIANCE) {\n  312:                                         console.log(\"Updating existing file\");\n  313:                                         this.uploadExistingFile(relativePath, fs.readFileSync(filepath));\n  314:                                     }\n  315:                                     resolve();\n  316:                                 }\n  317:                                 else {\n  318:                                     console.log(\"Unknown file type\");"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 177, "start_column": 24, "end_line": null, "end_column": 32, "snippet": "  172:         });\n  173:     }\n  174:     uploadNewFile(filename) {\n  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 178, "start_column": 38, "end_line": null, "end_column": 46, "snippet": "  173:     }\n  174:     uploadNewFile(filename) {\n  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,"}}]}
{"result_index": 4, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.\n(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.\n(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 180, "start_column": 22, "end_line": null, "end_column": 30, "snippet": "  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,\n  184:                 jar: this.cookieJar,\n  185:                 headers: {"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 309, "start_column": 63, "end_line": null, "end_column": 75, "snippet": "  304:                                         }\n  305:                                     });\n  306:                                     console.log(\"ftime: \" + ftime);\n  307:                                     if (ftime == null) {\n  308:                                         console.log(\"Uploading new file\");\n  309:                                         this.uploadRemoteFile(relativePath, fs.readFileSync(filepath));\n  310:                                     }\n  311:                                     else if (lftime > ftime + SYNC_TIME_VARIANCE) {\n  312:                                         console.log(\"Updating existing file\");\n  313:                                         this.uploadExistingFile(relativePath, fs.readFileSync(filepath));\n  314:                                     }"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 180, "start_column": 22, "end_line": null, "end_column": 30, "snippet": "  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,\n  184:                 jar: this.cookieJar,\n  185:                 headers: {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 313, "start_column": 65, "end_line": null, "end_column": 77, "snippet": "  308:                                         console.log(\"Uploading new file\");\n  309:                                         this.uploadRemoteFile(relativePath, fs.readFileSync(filepath));\n  310:                                     }\n  311:                                     else if (lftime > ftime + SYNC_TIME_VARIANCE) {\n  312:                                         console.log(\"Updating existing file\");\n  313:                                         this.uploadExistingFile(relativePath, fs.readFileSync(filepath));\n  314:                                     }\n  315:                                     resolve();\n  316:                                 }\n  317:                                 else {\n  318:                                     console.log(\"Unknown file type\");"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 177, "start_column": 24, "end_line": null, "end_column": 32, "snippet": "  172:         });\n  173:     }\n  174:     uploadNewFile(filename) {\n  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 178, "start_column": 38, "end_line": null, "end_column": 46, "snippet": "  173:     }\n  174:     uploadNewFile(filename) {\n  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 180, "start_column": 22, "end_line": null, "end_column": 30, "snippet": "  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,\n  184:                 jar: this.cookieJar,\n  185:                 headers: {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 309, "start_column": 63, "end_line": null, "end_column": 75, "snippet": "  304:                                         }\n  305:                                     });\n  306:                                     console.log(\"ftime: \" + ftime);\n  307:                                     if (ftime == null) {\n  308:                                         console.log(\"Uploading new file\");\n  309:                                         this.uploadRemoteFile(relativePath, fs.readFileSync(filepath));\n  310:                                     }\n  311:                                     else if (lftime > ftime + SYNC_TIME_VARIANCE) {\n  312:                                         console.log(\"Updating existing file\");\n  313:                                         this.uploadExistingFile(relativePath, fs.readFileSync(filepath));\n  314:                                     }"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 180, "start_column": 22, "end_line": null, "end_column": 30, "snippet": "  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,\n  184:                 jar: this.cookieJar,\n  185:                 headers: {"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 180, "start_column": 22, "end_line": null, "end_column": 30, "snippet": "  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,\n  184:                 jar: this.cookieJar,\n  185:                 headers: {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 309, "start_column": 63, "end_line": null, "end_column": 75, "snippet": "  304:                                         }\n  305:                                     });\n  306:                                     console.log(\"ftime: \" + ftime);\n  307:                                     if (ftime == null) {\n  308:                                         console.log(\"Uploading new file\");\n  309:                                         this.uploadRemoteFile(relativePath, fs.readFileSync(filepath));\n  310:                                     }\n  311:                                     else if (lftime > ftime + SYNC_TIME_VARIANCE) {\n  312:                                         console.log(\"Updating existing file\");\n  313:                                         this.uploadExistingFile(relativePath, fs.readFileSync(filepath));\n  314:                                     }"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 180, "start_column": 22, "end_line": null, "end_column": 30, "snippet": "  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,\n  184:                 jar: this.cookieJar,\n  185:                 headers: {"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 180, "start_column": 22, "end_line": null, "end_column": 30, "snippet": "  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,\n  184:                 jar: this.cookieJar,\n  185:                 headers: {"}}]}
{"result_index": 5, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 183, "start_column": 22, "end_line": null, "end_column": 134, "snippet": "  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,\n  184:                 jar: this.cookieJar,\n  185:                 headers: {\n  186:                     'Content-Type': 'text/plain',\n  187:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  188:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 309, "start_column": 63, "end_line": null, "end_column": 75, "snippet": "  304:                                         }\n  305:                                     });\n  306:                                     console.log(\"ftime: \" + ftime);\n  307:                                     if (ftime == null) {\n  308:                                         console.log(\"Uploading new file\");\n  309:                                         this.uploadRemoteFile(relativePath, fs.readFileSync(filepath));\n  310:                                     }\n  311:                                     else if (lftime > ftime + SYNC_TIME_VARIANCE) {\n  312:                                         console.log(\"Updating existing file\");\n  313:                                         this.uploadExistingFile(relativePath, fs.readFileSync(filepath));\n  314:                                     }"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 180, "start_column": 22, "end_line": null, "end_column": 30, "snippet": "  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,\n  184:                 jar: this.cookieJar,\n  185:                 headers: {"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 183, "start_column": 126, "end_line": null, "end_column": 134, "snippet": "  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,\n  184:                 jar: this.cookieJar,\n  185:                 headers: {\n  186:                     'Content-Type': 'text/plain',\n  187:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  188:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}, {"message": "'https: ... ilename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 183, "start_column": 22, "end_line": null, "end_column": 134, "snippet": "  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,\n  184:                 jar: this.cookieJar,\n  185:                 headers: {\n  186:                     'Content-Type': 'text/plain',\n  187:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  188:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 313, "start_column": 65, "end_line": null, "end_column": 77, "snippet": "  308:                                         console.log(\"Uploading new file\");\n  309:                                         this.uploadRemoteFile(relativePath, fs.readFileSync(filepath));\n  310:                                     }\n  311:                                     else if (lftime > ftime + SYNC_TIME_VARIANCE) {\n  312:                                         console.log(\"Updating existing file\");\n  313:                                         this.uploadExistingFile(relativePath, fs.readFileSync(filepath));\n  314:                                     }\n  315:                                     resolve();\n  316:                                 }\n  317:                                 else {\n  318:                                     console.log(\"Unknown file type\");"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 177, "start_column": 24, "end_line": null, "end_column": 32, "snippet": "  172:         });\n  173:     }\n  174:     uploadNewFile(filename) {\n  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 178, "start_column": 38, "end_line": null, "end_column": 46, "snippet": "  173:     }\n  174:     uploadNewFile(filename) {\n  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 180, "start_column": 22, "end_line": null, "end_column": 30, "snippet": "  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,\n  184:                 jar: this.cookieJar,\n  185:                 headers: {"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 183, "start_column": 126, "end_line": null, "end_column": 134, "snippet": "  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,\n  184:                 jar: this.cookieJar,\n  185:                 headers: {\n  186:                     'Content-Type': 'text/plain',\n  187:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  188:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}, {"message": "'https: ... ilename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 183, "start_column": 22, "end_line": null, "end_column": 134, "snippet": "  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,\n  184:                 jar: this.cookieJar,\n  185:                 headers: {\n  186:                     'Content-Type': 'text/plain',\n  187:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  188:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}]}
{"result_index": 6, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 183, "start_column": 126, "end_line": null, "end_column": 134, "snippet": "  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,\n  184:                 jar: this.cookieJar,\n  185:                 headers: {\n  186:                     'Content-Type': 'text/plain',\n  187:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  188:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 309, "start_column": 63, "end_line": null, "end_column": 75, "snippet": "  304:                                         }\n  305:                                     });\n  306:                                     console.log(\"ftime: \" + ftime);\n  307:                                     if (ftime == null) {\n  308:                                         console.log(\"Uploading new file\");\n  309:                                         this.uploadRemoteFile(relativePath, fs.readFileSync(filepath));\n  310:                                     }\n  311:                                     else if (lftime > ftime + SYNC_TIME_VARIANCE) {\n  312:                                         console.log(\"Updating existing file\");\n  313:                                         this.uploadExistingFile(relativePath, fs.readFileSync(filepath));\n  314:                                     }"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 180, "start_column": 22, "end_line": null, "end_column": 30, "snippet": "  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,\n  184:                 jar: this.cookieJar,\n  185:                 headers: {"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 183, "start_column": 126, "end_line": null, "end_column": 134, "snippet": "  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,\n  184:                 jar: this.cookieJar,\n  185:                 headers: {\n  186:                     'Content-Type': 'text/plain',\n  187:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  188:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 313, "start_column": 65, "end_line": null, "end_column": 77, "snippet": "  308:                                         console.log(\"Uploading new file\");\n  309:                                         this.uploadRemoteFile(relativePath, fs.readFileSync(filepath));\n  310:                                     }\n  311:                                     else if (lftime > ftime + SYNC_TIME_VARIANCE) {\n  312:                                         console.log(\"Updating existing file\");\n  313:                                         this.uploadExistingFile(relativePath, fs.readFileSync(filepath));\n  314:                                     }\n  315:                                     resolve();\n  316:                                 }\n  317:                                 else {\n  318:                                     console.log(\"Unknown file type\");"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 177, "start_column": 24, "end_line": null, "end_column": 32, "snippet": "  172:         });\n  173:     }\n  174:     uploadNewFile(filename) {\n  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 178, "start_column": 38, "end_line": null, "end_column": 46, "snippet": "  173:     }\n  174:     uploadNewFile(filename) {\n  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 180, "start_column": 22, "end_line": null, "end_column": 30, "snippet": "  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,\n  184:                 jar: this.cookieJar,\n  185:                 headers: {"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 183, "start_column": 126, "end_line": null, "end_column": 134, "snippet": "  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,\n  184:                 jar: this.cookieJar,\n  185:                 headers: {\n  186:                     'Content-Type': 'text/plain',\n  187:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  188:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}]}
{"result_index": 7, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 200, "start_column": 47, "end_line": null, "end_column": 55, "snippet": "  195:                 console.log(body);\n  196:                 let response = httpResponse; //JSON.parse(httpResponse);\n  197:                 if (response && response.statusCode == 429) { // retry with backoff\n  198:                     console.warn(\"retrying with backoff\");\n  199:                     setTimeout(() => {\n  200:                         this.uploadRemoteFile(filename, content).then(() => {\n  201:                             resolve();\n  202:                         }).catch(err => {\n  203:                             reject(err);\n  204:                         });\n  205:                     }, response.error.retryIn);"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 309, "start_column": 63, "end_line": null, "end_column": 75, "snippet": "  304:                                         }\n  305:                                     });\n  306:                                     console.log(\"ftime: \" + ftime);\n  307:                                     if (ftime == null) {\n  308:                                         console.log(\"Uploading new file\");\n  309:                                         this.uploadRemoteFile(relativePath, fs.readFileSync(filepath));\n  310:                                     }\n  311:                                     else if (lftime > ftime + SYNC_TIME_VARIANCE) {\n  312:                                         console.log(\"Updating existing file\");\n  313:                                         this.uploadExistingFile(relativePath, fs.readFileSync(filepath));\n  314:                                     }"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 180, "start_column": 22, "end_line": null, "end_column": 30, "snippet": "  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,\n  184:                 jar: this.cookieJar,\n  185:                 headers: {"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 200, "start_column": 47, "end_line": null, "end_column": 55, "snippet": "  195:                 console.log(body);\n  196:                 let response = httpResponse; //JSON.parse(httpResponse);\n  197:                 if (response && response.statusCode == 429) { // retry with backoff\n  198:                     console.warn(\"retrying with backoff\");\n  199:                     setTimeout(() => {\n  200:                         this.uploadRemoteFile(filename, content).then(() => {\n  201:                             resolve();\n  202:                         }).catch(err => {\n  203:                             reject(err);\n  204:                         });\n  205:                     }, response.error.retryIn);"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 313, "start_column": 65, "end_line": null, "end_column": 77, "snippet": "  308:                                         console.log(\"Uploading new file\");\n  309:                                         this.uploadRemoteFile(relativePath, fs.readFileSync(filepath));\n  310:                                     }\n  311:                                     else if (lftime > ftime + SYNC_TIME_VARIANCE) {\n  312:                                         console.log(\"Updating existing file\");\n  313:                                         this.uploadExistingFile(relativePath, fs.readFileSync(filepath));\n  314:                                     }\n  315:                                     resolve();\n  316:                                 }\n  317:                                 else {\n  318:                                     console.log(\"Unknown file type\");"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 177, "start_column": 24, "end_line": null, "end_column": 32, "snippet": "  172:         });\n  173:     }\n  174:     uploadNewFile(filename) {\n  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 178, "start_column": 38, "end_line": null, "end_column": 46, "snippet": "  173:     }\n  174:     uploadNewFile(filename) {\n  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 180, "start_column": 22, "end_line": null, "end_column": 30, "snippet": "  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,\n  184:                 jar: this.cookieJar,\n  185:                 headers: {"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 200, "start_column": 47, "end_line": null, "end_column": 55, "snippet": "  195:                 console.log(body);\n  196:                 let response = httpResponse; //JSON.parse(httpResponse);\n  197:                 if (response && response.statusCode == 429) { // retry with backoff\n  198:                     console.warn(\"retrying with backoff\");\n  199:                     setTimeout(() => {\n  200:                         this.uploadRemoteFile(filename, content).then(() => {\n  201:                             resolve();\n  202:                         }).catch(err => {\n  203:                             reject(err);\n  204:                         });\n  205:                     }, response.error.retryIn);"}}]}
{"result_index": 8, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.\n(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.\n(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}]}
{"result_index": 9, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 234, "start_column": 49, "end_line": null, "end_column": 58, "snippet": "  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 234, "start_column": 49, "end_line": null, "end_column": 58, "snippet": "  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");"}}]}
{"result_index": 10, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 29, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 63, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "startPath + \"/\"", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 69, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "path.jo ...  + \"/\")", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 29, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}]}
{"result_index": 11, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 63, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 63, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}]}
{"result_index": 12, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 244, "start_column": 22, "end_line": null, "end_column": 166, "snippet": "  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',\n  248:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  249:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 244, "start_column": 150, "end_line": null, "end_column": 159, "snippet": "  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',\n  248:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  249:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}, {"message": "Utils.E ... rtPath)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 244, "start_column": 125, "end_line": null, "end_column": 160, "snippet": "  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',\n  248:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  249:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}, {"message": "'https: ... ) + \"/\"", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 244, "start_column": 22, "end_line": null, "end_column": 166, "snippet": "  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',\n  248:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  249:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}]}
{"result_index": 13, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 244, "start_column": 22, "end_line": null, "end_column": 160, "snippet": "  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',\n  248:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  249:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 244, "start_column": 150, "end_line": null, "end_column": 159, "snippet": "  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',\n  248:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  249:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}, {"message": "Utils.E ... rtPath)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 244, "start_column": 125, "end_line": null, "end_column": 160, "snippet": "  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',\n  248:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  249:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}, {"message": "'https: ... rtPath)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 244, "start_column": 22, "end_line": null, "end_column": 160, "snippet": "  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',\n  248:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  249:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}]}
{"result_index": 14, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 244, "start_column": 125, "end_line": null, "end_column": 160, "snippet": "  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',\n  248:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  249:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 244, "start_column": 150, "end_line": null, "end_column": 159, "snippet": "  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',\n  248:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  249:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}, {"message": "Utils.E ... rtPath)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 244, "start_column": 125, "end_line": null, "end_column": 160, "snippet": "  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',\n  248:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  249:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}]}
{"result_index": 15, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 269, "start_column": 56, "end_line": null, "end_column": 65, "snippet": "  264:                 catch (err) {\n  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 63, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "startPath + \"/\"", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 69, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "path.jo ...  + \"/\")", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 29, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "inodePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 17, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "inodePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 269, "start_column": 56, "end_line": null, "end_column": 65, "snippet": "  264:                 catch (err) {\n  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);"}}]}
{"result_index": 16, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.\n(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}]}
{"result_index": 17, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 273, "start_column": 48, "end_line": null, "end_column": 57, "snippet": "  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 63, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "startPath + \"/\"", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 69, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "path.jo ...  + \"/\")", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 29, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "inodePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 17, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "inodePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 273, "start_column": 48, "end_line": null, "end_column": 57, "snippet": "  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }"}}]}
{"result_index": 18, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.\n(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 275, "start_column": 26, "end_line": null, "end_column": 31, "snippet": "  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 275, "start_column": 26, "end_line": null, "end_column": 31, "snippet": "  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 275, "start_column": 26, "end_line": null, "end_column": 31, "snippet": "  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);"}}]}
{"result_index": 19, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.\n(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.\n(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}]}
{"result_index": 20, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 54, "end_line": null, "end_column": 63, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "startPath + \"/\"", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 54, "end_line": null, "end_column": 69, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}]}
{"result_index": 21, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 54, "end_line": null, "end_column": 63, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 54, "end_line": null, "end_column": 63, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}]}
{"result_index": 22, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 281, "start_column": 59, "end_line": null, "end_column": 71, "snippet": "  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 281, "start_column": 59, "end_line": null, "end_column": 71, "snippet": "  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);"}}]}
{"result_index": 23, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 282, "start_column": 29, "end_line": null, "end_column": 41, "snippet": "  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 282, "start_column": 29, "end_line": null, "end_column": 41, "snippet": "  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");"}}]}
{"result_index": 24, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 282, "start_column": 55, "end_line": null, "end_column": 67, "snippet": "  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 282, "start_column": 55, "end_line": null, "end_column": 67, "snippet": "  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");"}}]}
{"result_index": 25, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 282, "start_column": 85, "end_line": null, "end_column": 97, "snippet": "  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 282, "start_column": 85, "end_line": null, "end_column": 97, "snippet": "  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");"}}]}
{"result_index": 26, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 44, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 65, "end_line": null, "end_column": 69, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 44, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 63, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "startPath + \"/\"", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 69, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "path.jo ...  + \"/\")", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 29, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "inodePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 17, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "inodePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 54, "end_line": null, "end_column": 63, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 44, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}]}
{"result_index": 27, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 287, "start_column": 41, "end_line": null, "end_column": 107, "snippet": "  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 287, "start_column": 95, "end_line": null, "end_column": 107, "snippet": "  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();"}}, {"message": "\"Beginn ... ivePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 287, "start_column": 41, "end_line": null, "end_column": 107, "snippet": "  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 65, "end_line": null, "end_column": 69, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 44, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "filepath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 33, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "filepath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 287, "start_column": 77, "end_line": null, "end_column": 85, "snippet": "  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();"}}, {"message": "\"Beginn ... ivePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 287, "start_column": 41, "end_line": null, "end_column": 107, "snippet": "  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();"}}]}
{"result_index": 28, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 287, "start_column": 41, "end_line": null, "end_column": 92, "snippet": "  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 65, "end_line": null, "end_column": 69, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 44, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "filepath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 33, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "filepath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 287, "start_column": 77, "end_line": null, "end_column": 85, "snippet": "  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();"}}, {"message": "\"Beginn ...  + \" (\"", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 287, "start_column": 41, "end_line": null, "end_column": 92, "snippet": "  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 63, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "startPath + \"/\"", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 69, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "path.jo ...  + \"/\")", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 29, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "inodePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 17, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "inodePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 54, "end_line": null, "end_column": 63, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 44, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "filepath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 33, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "filepath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 287, "start_column": 77, "end_line": null, "end_column": 85, "snippet": "  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();"}}, {"message": "\"Beginn ...  + \" (\"", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 287, "start_column": 41, "end_line": null, "end_column": 92, "snippet": "  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();"}}]}
{"result_index": 29, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 287, "start_column": 41, "end_line": null, "end_column": 85, "snippet": "  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 65, "end_line": null, "end_column": 69, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 44, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "filepath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 33, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "filepath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 287, "start_column": 77, "end_line": null, "end_column": 85, "snippet": "  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();"}}, {"message": "\"Beginn ... ilepath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 287, "start_column": 41, "end_line": null, "end_column": 85, "snippet": "  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 63, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "startPath + \"/\"", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 69, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "path.jo ...  + \"/\")", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 29, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "inodePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 17, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "inodePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 54, "end_line": null, "end_column": 63, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 44, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "filepath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 33, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "filepath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 287, "start_column": 77, "end_line": null, "end_column": 85, "snippet": "  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();"}}, {"message": "\"Beginn ... ilepath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 287, "start_column": 41, "end_line": null, "end_column": 85, "snippet": "  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();"}}]}
{"result_index": 30, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 287, "start_column": 77, "end_line": null, "end_column": 85, "snippet": "  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 65, "end_line": null, "end_column": 69, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 44, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "filepath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 33, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "filepath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 287, "start_column": 77, "end_line": null, "end_column": 85, "snippet": "  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 63, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "startPath + \"/\"", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 69, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "path.jo ...  + \"/\")", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 29, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "inodePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 17, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "inodePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 54, "end_line": null, "end_column": 63, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 44, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "filepath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 33, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "filepath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 287, "start_column": 77, "end_line": null, "end_column": 85, "snippet": "  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();"}}]}
{"result_index": 31, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 287, "start_column": 95, "end_line": null, "end_column": 107, "snippet": "  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 287, "start_column": 95, "end_line": null, "end_column": 107, "snippet": "  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();"}}]}
{"result_index": 32, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 290, "start_column": 90, "end_line": null, "end_column": 102, "snippet": "  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 290, "start_column": 90, "end_line": null, "end_column": 102, "snippet": "  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });"}}]}
{"result_index": 33, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}]}
{"result_index": 34, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 302, "start_column": 64, "end_line": null, "end_column": 76, "snippet": "  297:                                 else if (fstat.isFile()) {\n  298:                                     let ftime = null;\n  299:                                     let lftime = new Date(fstat['mtime']).getTime();\n  300:                                     console.log(\"Checking remote stats now\");\n  301:                                     remoteStats.forEach(remoteStat => {\n  302:                                         if (remoteStat.name == relativePath) {\n  303:                                             ftime = remoteStat.mtime;\n  304:                                         }\n  305:                                     });\n  306:                                     console.log(\"ftime: \" + ftime);\n  307:                                     if (ftime == null) {"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 302, "start_column": 64, "end_line": null, "end_column": 76, "snippet": "  297:                                 else if (fstat.isFile()) {\n  298:                                     let ftime = null;\n  299:                                     let lftime = new Date(fstat['mtime']).getTime();\n  300:                                     console.log(\"Checking remote stats now\");\n  301:                                     remoteStats.forEach(remoteStat => {\n  302:                                         if (remoteStat.name == relativePath) {\n  303:                                             ftime = remoteStat.mtime;\n  304:                                         }\n  305:                                     });\n  306:                                     console.log(\"ftime: \" + ftime);\n  307:                                     if (ftime == null) {"}}]}
{"result_index": 35, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 309, "start_column": 63, "end_line": null, "end_column": 75, "snippet": "  304:                                         }\n  305:                                     });\n  306:                                     console.log(\"ftime: \" + ftime);\n  307:                                     if (ftime == null) {\n  308:                                         console.log(\"Uploading new file\");\n  309:                                         this.uploadRemoteFile(relativePath, fs.readFileSync(filepath));\n  310:                                     }\n  311:                                     else if (lftime > ftime + SYNC_TIME_VARIANCE) {\n  312:                                         console.log(\"Updating existing file\");\n  313:                                         this.uploadExistingFile(relativePath, fs.readFileSync(filepath));\n  314:                                     }"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 309, "start_column": 63, "end_line": null, "end_column": 75, "snippet": "  304:                                         }\n  305:                                     });\n  306:                                     console.log(\"ftime: \" + ftime);\n  307:                                     if (ftime == null) {\n  308:                                         console.log(\"Uploading new file\");\n  309:                                         this.uploadRemoteFile(relativePath, fs.readFileSync(filepath));\n  310:                                     }\n  311:                                     else if (lftime > ftime + SYNC_TIME_VARIANCE) {\n  312:                                         console.log(\"Updating existing file\");\n  313:                                         this.uploadExistingFile(relativePath, fs.readFileSync(filepath));\n  314:                                     }"}}]}
{"result_index": 36, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 313, "start_column": 65, "end_line": null, "end_column": 77, "snippet": "  308:                                         console.log(\"Uploading new file\");\n  309:                                         this.uploadRemoteFile(relativePath, fs.readFileSync(filepath));\n  310:                                     }\n  311:                                     else if (lftime > ftime + SYNC_TIME_VARIANCE) {\n  312:                                         console.log(\"Updating existing file\");\n  313:                                         this.uploadExistingFile(relativePath, fs.readFileSync(filepath));\n  314:                                     }\n  315:                                     resolve();\n  316:                                 }\n  317:                                 else {\n  318:                                     console.log(\"Unknown file type\");"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 313, "start_column": 65, "end_line": null, "end_column": 77, "snippet": "  308:                                         console.log(\"Uploading new file\");\n  309:                                         this.uploadRemoteFile(relativePath, fs.readFileSync(filepath));\n  310:                                     }\n  311:                                     else if (lftime > ftime + SYNC_TIME_VARIANCE) {\n  312:                                         console.log(\"Updating existing file\");\n  313:                                         this.uploadExistingFile(relativePath, fs.readFileSync(filepath));\n  314:                                     }\n  315:                                     resolve();\n  316:                                 }\n  317:                                 else {\n  318:                                     console.log(\"Unknown file type\");"}}]}
{"result_index": 37, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.\n(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 156, "start_column": 29, "end_line": null, "end_column": 32, "snippet": "  151:         }\n  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 244, "start_column": 150, "end_line": null, "end_column": 159, "snippet": "  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',\n  248:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  249:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 156, "start_column": 29, "end_line": null, "end_column": 32, "snippet": "  151:         }\n  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 244, "start_column": 150, "end_line": null, "end_column": 159, "snippet": "  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',\n  248:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  249:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 156, "start_column": 29, "end_line": null, "end_column": 32, "snippet": "  151:         }\n  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 156, "start_column": 29, "end_line": null, "end_column": 32, "snippet": "  151:         }\n  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;"}}]}
{"result_index": 38, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 157, "start_column": 9, "end_line": null, "end_column": 15, "snippet": "  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;\n  162: function GetRegion() {"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 244, "start_column": 150, "end_line": null, "end_column": 159, "snippet": "  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',\n  248:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  249:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 156, "start_column": 29, "end_line": null, "end_column": 32, "snippet": "  151:         }\n  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 157, "start_column": 9, "end_line": null, "end_column": 12, "snippet": "  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;\n  162: function GetRegion() {"}}, {"message": "str[0]", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 157, "start_column": 9, "end_line": null, "end_column": 15, "snippet": "  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;\n  162: function GetRegion() {"}}]}
{"result_index": 39, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 157, "start_column": 9, "end_line": null, "end_column": 12, "snippet": "  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;\n  162: function GetRegion() {"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 244, "start_column": 150, "end_line": null, "end_column": 159, "snippet": "  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',\n  248:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  249:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 156, "start_column": 29, "end_line": null, "end_column": 32, "snippet": "  151:         }\n  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 157, "start_column": 9, "end_line": null, "end_column": 12, "snippet": "  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;\n  162: function GetRegion() {"}}]}
{"result_index": 40, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 157, "start_column": 26, "end_line": null, "end_column": 32, "snippet": "  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;\n  162: function GetRegion() {"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 244, "start_column": 150, "end_line": null, "end_column": 159, "snippet": "  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',\n  248:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  249:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 156, "start_column": 29, "end_line": null, "end_column": 32, "snippet": "  151:         }\n  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 157, "start_column": 26, "end_line": null, "end_column": 29, "snippet": "  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;\n  162: function GetRegion() {"}}, {"message": "str[0]", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 157, "start_column": 26, "end_line": null, "end_column": 32, "snippet": "  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;\n  162: function GetRegion() {"}}]}
{"result_index": 41, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 157, "start_column": 26, "end_line": null, "end_column": 29, "snippet": "  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;\n  162: function GetRegion() {"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 244, "start_column": 150, "end_line": null, "end_column": 159, "snippet": "  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',\n  248:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  249:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 156, "start_column": 29, "end_line": null, "end_column": 32, "snippet": "  151:         }\n  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 157, "start_column": 26, "end_line": null, "end_column": 29, "snippet": "  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;\n  162: function GetRegion() {"}}]}
{"result_index": 42, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 158, "start_column": 16, "end_line": null, "end_column": 19, "snippet": "  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;\n  162: function GetRegion() {\n  163:     let extensionConfig = vscode.workspace.getConfiguration('cloud9sync');"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 244, "start_column": 150, "end_line": null, "end_column": 159, "snippet": "  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',\n  248:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  249:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 156, "start_column": 29, "end_line": null, "end_column": 32, "snippet": "  151:         }\n  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 158, "start_column": 16, "end_line": null, "end_column": 19, "snippet": "  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;\n  162: function GetRegion() {\n  163:     let extensionConfig = vscode.workspace.getConfiguration('cloud9sync');"}}]}
{"result_index": 43, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 159, "start_column": 12, "end_line": null, "end_column": 21, "snippet": "  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;\n  162: function GetRegion() {\n  163:     let extensionConfig = vscode.workspace.getConfiguration('cloud9sync');\n  164:     return extensionConfig.get('region');"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 244, "start_column": 150, "end_line": null, "end_column": 159, "snippet": "  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',\n  248:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  249:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 156, "start_column": 29, "end_line": null, "end_column": 32, "snippet": "  151:         }\n  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 159, "start_column": 18, "end_line": null, "end_column": 21, "snippet": "  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;\n  162: function GetRegion() {\n  163:     let extensionConfig = vscode.workspace.getConfiguration('cloud9sync');\n  164:     return extensionConfig.get('region');"}}, {"message": "\"/\" + str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 159, "start_column": 12, "end_line": null, "end_column": 21, "snippet": "  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;\n  162: function GetRegion() {\n  163:     let extensionConfig = vscode.workspace.getConfiguration('cloud9sync');\n  164:     return extensionConfig.get('region');"}}]}
{"result_index": 44, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 159, "start_column": 18, "end_line": null, "end_column": 21, "snippet": "  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;\n  162: function GetRegion() {\n  163:     let extensionConfig = vscode.workspace.getConfiguration('cloud9sync');\n  164:     return extensionConfig.get('region');"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 244, "start_column": 150, "end_line": null, "end_column": 159, "snippet": "  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',\n  248:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  249:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 156, "start_column": 29, "end_line": null, "end_column": 32, "snippet": "  151:         }\n  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 159, "start_column": 18, "end_line": null, "end_column": 21, "snippet": "  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;\n  162: function GetRegion() {\n  163:     let extensionConfig = vscode.workspace.getConfiguration('cloud9sync');\n  164:     return extensionConfig.get('region');"}}]}
{"result_index": 45, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.\n(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 175, "start_column": 25, "end_line": null, "end_column": 30, "snippet": "  170:     if (proxy == \"\")\n  171:         return null;\n  172:     return proxy;\n  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "array", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 175, "start_column": 25, "end_line": null, "end_column": 30, "snippet": "  170:     if (proxy == \"\")\n  171:         return null;\n  172:     return proxy;\n  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "array", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 175, "start_column": 25, "end_line": null, "end_column": 30, "snippet": "  170:     if (proxy == \"\")\n  171:         return null;\n  172:     return proxy;\n  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);"}}, {"message": "array", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 175, "start_column": 25, "end_line": null, "end_column": 30, "snippet": "  170:     if (proxy == \"\")\n  171:         return null;\n  172:     return proxy;\n  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);"}}]}
{"result_index": 46, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 177, "start_column": 12, "end_line": null, "end_column": 24, "snippet": "  172:     return proxy;\n  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);\n  181:                 return results;\n  182:             }).catch((y) => {"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "array", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 175, "start_column": 25, "end_line": null, "end_column": 30, "snippet": "  170:     if (proxy == \"\")\n  171:         return null;\n  172:     return proxy;\n  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);"}}, {"message": "array", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 177, "start_column": 12, "end_line": null, "end_column": 17, "snippet": "  172:     return proxy;\n  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);\n  181:                 return results;\n  182:             }).catch((y) => {"}}, {"message": "array.reduce", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 177, "start_column": 12, "end_line": null, "end_column": 24, "snippet": "  172:     return proxy;\n  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);\n  181:                 return results;\n  182:             }).catch((y) => {"}}]}
{"result_index": 47, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 177, "start_column": 12, "end_line": null, "end_column": 17, "snippet": "  172:     return proxy;\n  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);\n  181:                 return results;\n  182:             }).catch((y) => {"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "array", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 175, "start_column": 25, "end_line": null, "end_column": 30, "snippet": "  170:     if (proxy == \"\")\n  171:         return null;\n  172:     return proxy;\n  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);"}}, {"message": "array", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 177, "start_column": 12, "end_line": null, "end_column": 17, "snippet": "  172:     return proxy;\n  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);\n  181:                 return results;\n  182:             }).catch((y) => {"}}]}
{"result_index": 48, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.\n(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.\n(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 177, "start_column": 38, "end_line": null, "end_column": 42, "snippet": "  172:     return proxy;\n  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);\n  181:                 return results;\n  182:             }).catch((y) => {"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "array", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 175, "start_column": 25, "end_line": null, "end_column": 30, "snippet": "  170:     if (proxy == \"\")\n  171:         return null;\n  172:     return proxy;\n  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);"}}, {"message": "array", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 177, "start_column": 12, "end_line": null, "end_column": 17, "snippet": "  172:     return proxy;\n  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);\n  181:                 return results;\n  182:             }).catch((y) => {"}}, {"message": "item", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 177, "start_column": 38, "end_line": null, "end_column": 42, "snippet": "  172:     return proxy;\n  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);\n  181:                 return results;\n  182:             }).catch((y) => {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "array", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 175, "start_column": 25, "end_line": null, "end_column": 30, "snippet": "  170:     if (proxy == \"\")\n  171:         return null;\n  172:     return proxy;\n  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);"}}, {"message": "array", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 177, "start_column": 12, "end_line": null, "end_column": 17, "snippet": "  172:     return proxy;\n  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);\n  181:                 return results;\n  182:             }).catch((y) => {"}}, {"message": "item", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 177, "start_column": 38, "end_line": null, "end_column": 42, "snippet": "  172:     return proxy;\n  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);\n  181:                 return results;\n  182:             }).catch((y) => {"}}, {"message": "item", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 177, "start_column": 38, "end_line": null, "end_column": 42, "snippet": "  172:     return proxy;\n  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);\n  181:                 return results;\n  182:             }).catch((y) => {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "array", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 175, "start_column": 25, "end_line": null, "end_column": 30, "snippet": "  170:     if (proxy == \"\")\n  171:         return null;\n  172:     return proxy;\n  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);"}}, {"message": "array", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 177, "start_column": 12, "end_line": null, "end_column": 17, "snippet": "  172:     return proxy;\n  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);\n  181:                 return results;\n  182:             }).catch((y) => {"}}, {"message": "item", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 177, "start_column": 38, "end_line": null, "end_column": 42, "snippet": "  172:     return proxy;\n  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);\n  181:                 return results;\n  182:             }).catch((y) => {"}}, {"message": "item", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 177, "start_column": 38, "end_line": null, "end_column": 42, "snippet": "  172:     return proxy;\n  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);\n  181:                 return results;\n  182:             }).catch((y) => {"}}]}
{"result_index": 49, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 179, "start_column": 23, "end_line": null, "end_column": 27, "snippet": "  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);\n  181:                 return results;\n  182:             }).catch((y) => {\n  183:                 console.error(y);\n  184:             });"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "array", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 175, "start_column": 25, "end_line": null, "end_column": 30, "snippet": "  170:     if (proxy == \"\")\n  171:         return null;\n  172:     return proxy;\n  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);"}}, {"message": "array", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 177, "start_column": 12, "end_line": null, "end_column": 17, "snippet": "  172:     return proxy;\n  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);\n  181:                 return results;\n  182:             }).catch((y) => {"}}, {"message": "item", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 177, "start_column": 38, "end_line": null, "end_column": 42, "snippet": "  172:     return proxy;\n  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);\n  181:                 return results;\n  182:             }).catch((y) => {"}}, {"message": "item", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 179, "start_column": 23, "end_line": null, "end_column": 27, "snippet": "  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);\n  181:                 return results;\n  182:             }).catch((y) => {\n  183:                 console.error(y);\n  184:             });"}}]}
{"result_index": 50, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.\n(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/websocketProvider.js", "start_line": 150, "start_column": 22, "end_line": null, "end_column": 26, "snippet": "  145:         this.send_ch4_message([\"call\", \"ping\", \"ping\", [\"serverTime\", { \"$\": this.next_event_id() }]]);\n  146:         this.send_ch4_message([\"extend\", \"collab\", { \"file\": \"c9.ide.collab/server/collab-server.js\" }, { \"$\": this.next_event_id() }]);\n  147:         this.eventEmitter.emit('websocket_init_complete');\n  148:         this.sessionState = \"CONNECTED\";\n  149:     }\n  150:     send_ch4_message(data) {\n  151:         let seq = this.my_seq;\n  152:         this.my_seq += 1;\n  153:         let msg = {\n  154:             'ack': this.last_seq,\n  155:             'seq': seq,"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 290, "start_column": 90, "end_line": null, "end_column": 102, "snippet": "  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });"}}, {"message": "[\"mkdir ... id() }]", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 290, "start_column": 80, "end_line": null, "end_column": 156, "snippet": "  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });"}}, {"message": "data", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/extension.js", "start_line": 407, "start_column": 42, "end_line": null, "end_column": 46, "snippet": "  402: }\n  403: \n  404: /////\n  405: \n  406: function setEventEmitterEvents() {\n  407:     eventEmitter.on('send_ch4_message', (data) => {\n  408:         websocketProvider.send_ch4_message(data);\n  409:     });\n  410: \n  411:     eventEmitter.on('request_connect', (environment) => {\n  412:         refreshEnvironmentsInSidebar().then(() => {"}}, {"message": "data", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/extension.js", "start_line": 408, "start_column": 44, "end_line": null, "end_column": 48, "snippet": "  403: \n  404: /////\n  405: \n  406: function setEventEmitterEvents() {\n  407:     eventEmitter.on('send_ch4_message', (data) => {\n  408:         websocketProvider.send_ch4_message(data);\n  409:     });\n  410: \n  411:     eventEmitter.on('request_connect', (environment) => {\n  412:         refreshEnvironmentsInSidebar().then(() => {\n  413:             commandConnect(environment);"}}, {"message": "data", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/websocketProvider.js", "start_line": 150, "start_column": 22, "end_line": null, "end_column": 26, "snippet": "  145:         this.send_ch4_message([\"call\", \"ping\", \"ping\", [\"serverTime\", { \"$\": this.next_event_id() }]]);\n  146:         this.send_ch4_message([\"extend\", \"collab\", { \"file\": \"c9.ide.collab/server/collab-server.js\" }, { \"$\": this.next_event_id() }]);\n  147:         this.eventEmitter.emit('websocket_init_complete');\n  148:         this.sessionState = \"CONNECTED\";\n  149:     }\n  150:     send_ch4_message(data) {\n  151:         let seq = this.my_seq;\n  152:         this.my_seq += 1;\n  153:         let msg = {\n  154:             'ack': this.last_seq,\n  155:             'seq': seq,"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 290, "start_column": 90, "end_line": null, "end_column": 102, "snippet": "  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });"}}, {"message": "[\"mkdir ... id() }]", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 290, "start_column": 80, "end_line": null, "end_column": 156, "snippet": "  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });"}}, {"message": "data", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/extension.js", "start_line": 407, "start_column": 42, "end_line": null, "end_column": 46, "snippet": "  402: }\n  403: \n  404: /////\n  405: \n  406: function setEventEmitterEvents() {\n  407:     eventEmitter.on('send_ch4_message', (data) => {\n  408:         websocketProvider.send_ch4_message(data);\n  409:     });\n  410: \n  411:     eventEmitter.on('request_connect', (environment) => {\n  412:         refreshEnvironmentsInSidebar().then(() => {"}}, {"message": "data", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/extension.js", "start_line": 408, "start_column": 44, "end_line": null, "end_column": 48, "snippet": "  403: \n  404: /////\n  405: \n  406: function setEventEmitterEvents() {\n  407:     eventEmitter.on('send_ch4_message', (data) => {\n  408:         websocketProvider.send_ch4_message(data);\n  409:     });\n  410: \n  411:     eventEmitter.on('request_connect', (environment) => {\n  412:         refreshEnvironmentsInSidebar().then(() => {\n  413:             commandConnect(environment);"}}, {"message": "data", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/websocketProvider.js", "start_line": 150, "start_column": 22, "end_line": null, "end_column": 26, "snippet": "  145:         this.send_ch4_message([\"call\", \"ping\", \"ping\", [\"serverTime\", { \"$\": this.next_event_id() }]]);\n  146:         this.send_ch4_message([\"extend\", \"collab\", { \"file\": \"c9.ide.collab/server/collab-server.js\" }, { \"$\": this.next_event_id() }]);\n  147:         this.eventEmitter.emit('websocket_init_complete');\n  148:         this.sessionState = \"CONNECTED\";\n  149:     }\n  150:     send_ch4_message(data) {\n  151:         let seq = this.my_seq;\n  152:         this.my_seq += 1;\n  153:         let msg = {\n  154:             'ack': this.last_seq,\n  155:             'seq': seq,"}}, {"message": "data", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/websocketProvider.js", "start_line": 150, "start_column": 22, "end_line": null, "end_column": 26, "snippet": "  145:         this.send_ch4_message([\"call\", \"ping\", \"ping\", [\"serverTime\", { \"$\": this.next_event_id() }]]);\n  146:         this.send_ch4_message([\"extend\", \"collab\", { \"file\": \"c9.ide.collab/server/collab-server.js\" }, { \"$\": this.next_event_id() }]);\n  147:         this.eventEmitter.emit('websocket_init_complete');\n  148:         this.sessionState = \"CONNECTED\";\n  149:     }\n  150:     send_ch4_message(data) {\n  151:         let seq = this.my_seq;\n  152:         this.my_seq += 1;\n  153:         let msg = {\n  154:             'ack': this.last_seq,\n  155:             'seq': seq,"}}]}
{"result_index": 51, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/websocketProvider.js", "start_line": 156, "start_column": 18, "end_line": null, "end_column": 22, "snippet": "  151:         let seq = this.my_seq;\n  152:         this.my_seq += 1;\n  153:         let msg = {\n  154:             'ack': this.last_seq,\n  155:             'seq': seq,\n  156:             'd': data\n  157:         };\n  158:         console.log(\"Sending:\");\n  159:         console.log('4' + JSON.stringify(msg));\n  160:         this.ws.send('4' + JSON.stringify(msg));\n  161:         return seq;"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 290, "start_column": 90, "end_line": null, "end_column": 102, "snippet": "  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });"}}, {"message": "[\"mkdir ... id() }]", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 290, "start_column": 80, "end_line": null, "end_column": 156, "snippet": "  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });"}}, {"message": "data", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/extension.js", "start_line": 407, "start_column": 42, "end_line": null, "end_column": 46, "snippet": "  402: }\n  403: \n  404: /////\n  405: \n  406: function setEventEmitterEvents() {\n  407:     eventEmitter.on('send_ch4_message', (data) => {\n  408:         websocketProvider.send_ch4_message(data);\n  409:     });\n  410: \n  411:     eventEmitter.on('request_connect', (environment) => {\n  412:         refreshEnvironmentsInSidebar().then(() => {"}}, {"message": "data", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/extension.js", "start_line": 408, "start_column": 44, "end_line": null, "end_column": 48, "snippet": "  403: \n  404: /////\n  405: \n  406: function setEventEmitterEvents() {\n  407:     eventEmitter.on('send_ch4_message', (data) => {\n  408:         websocketProvider.send_ch4_message(data);\n  409:     });\n  410: \n  411:     eventEmitter.on('request_connect', (environment) => {\n  412:         refreshEnvironmentsInSidebar().then(() => {\n  413:             commandConnect(environment);"}}, {"message": "data", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/websocketProvider.js", "start_line": 150, "start_column": 22, "end_line": null, "end_column": 26, "snippet": "  145:         this.send_ch4_message([\"call\", \"ping\", \"ping\", [\"serverTime\", { \"$\": this.next_event_id() }]]);\n  146:         this.send_ch4_message([\"extend\", \"collab\", { \"file\": \"c9.ide.collab/server/collab-server.js\" }, { \"$\": this.next_event_id() }]);\n  147:         this.eventEmitter.emit('websocket_init_complete');\n  148:         this.sessionState = \"CONNECTED\";\n  149:     }\n  150:     send_ch4_message(data) {\n  151:         let seq = this.my_seq;\n  152:         this.my_seq += 1;\n  153:         let msg = {\n  154:             'ack': this.last_seq,\n  155:             'seq': seq,"}}, {"message": "data", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/websocketProvider.js", "start_line": 156, "start_column": 18, "end_line": null, "end_column": 22, "snippet": "  151:         let seq = this.my_seq;\n  152:         this.my_seq += 1;\n  153:         let msg = {\n  154:             'ack': this.last_seq,\n  155:             'seq': seq,\n  156:             'd': data\n  157:         };\n  158:         console.log(\"Sending:\");\n  159:         console.log('4' + JSON.stringify(msg));\n  160:         this.ws.send('4' + JSON.stringify(msg));\n  161:         return seq;"}}]}
{"result_index": 52, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/websocketProvider.js", "start_line": 159, "start_column": 27, "end_line": null, "end_column": 46, "snippet": "  154:             'ack': this.last_seq,\n  155:             'seq': seq,\n  156:             'd': data\n  157:         };\n  158:         console.log(\"Sending:\");\n  159:         console.log('4' + JSON.stringify(msg));\n  160:         this.ws.send('4' + JSON.stringify(msg));\n  161:         return seq;\n  162:     }\n  163: }\n  164: exports.WebsocketProvider = WebsocketProvider;"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 290, "start_column": 90, "end_line": null, "end_column": 102, "snippet": "  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });"}}, {"message": "[\"mkdir ... id() }]", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 290, "start_column": 80, "end_line": null, "end_column": 156, "snippet": "  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });"}}, {"message": "data", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/extension.js", "start_line": 407, "start_column": 42, "end_line": null, "end_column": 46, "snippet": "  402: }\n  403: \n  404: /////\n  405: \n  406: function setEventEmitterEvents() {\n  407:     eventEmitter.on('send_ch4_message', (data) => {\n  408:         websocketProvider.send_ch4_message(data);\n  409:     });\n  410: \n  411:     eventEmitter.on('request_connect', (environment) => {\n  412:         refreshEnvironmentsInSidebar().then(() => {"}}, {"message": "data", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/extension.js", "start_line": 408, "start_column": 44, "end_line": null, "end_column": 48, "snippet": "  403: \n  404: /////\n  405: \n  406: function setEventEmitterEvents() {\n  407:     eventEmitter.on('send_ch4_message', (data) => {\n  408:         websocketProvider.send_ch4_message(data);\n  409:     });\n  410: \n  411:     eventEmitter.on('request_connect', (environment) => {\n  412:         refreshEnvironmentsInSidebar().then(() => {\n  413:             commandConnect(environment);"}}, {"message": "data", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/websocketProvider.js", "start_line": 150, "start_column": 22, "end_line": null, "end_column": 26, "snippet": "  145:         this.send_ch4_message([\"call\", \"ping\", \"ping\", [\"serverTime\", { \"$\": this.next_event_id() }]]);\n  146:         this.send_ch4_message([\"extend\", \"collab\", { \"file\": \"c9.ide.collab/server/collab-server.js\" }, { \"$\": this.next_event_id() }]);\n  147:         this.eventEmitter.emit('websocket_init_complete');\n  148:         this.sessionState = \"CONNECTED\";\n  149:     }\n  150:     send_ch4_message(data) {\n  151:         let seq = this.my_seq;\n  152:         this.my_seq += 1;\n  153:         let msg = {\n  154:             'ack': this.last_seq,\n  155:             'seq': seq,"}}, {"message": "data", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/websocketProvider.js", "start_line": 156, "start_column": 18, "end_line": null, "end_column": 22, "snippet": "  151:         let seq = this.my_seq;\n  152:         this.my_seq += 1;\n  153:         let msg = {\n  154:             'ack': this.last_seq,\n  155:             'seq': seq,\n  156:             'd': data\n  157:         };\n  158:         console.log(\"Sending:\");\n  159:         console.log('4' + JSON.stringify(msg));\n  160:         this.ws.send('4' + JSON.stringify(msg));\n  161:         return seq;"}}, {"message": "JSON.stringify(msg)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/websocketProvider.js", "start_line": 159, "start_column": 27, "end_line": null, "end_column": 46, "snippet": "  154:             'ack': this.last_seq,\n  155:             'seq': seq,\n  156:             'd': data\n  157:         };\n  158:         console.log(\"Sending:\");\n  159:         console.log('4' + JSON.stringify(msg));\n  160:         this.ws.send('4' + JSON.stringify(msg));\n  161:         return seq;\n  162:     }\n  163: }\n  164: exports.WebsocketProvider = WebsocketProvider;"}}]}
{"result_index": 53, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/websocketProvider.js", "start_line": 160, "start_column": 22, "end_line": null, "end_column": 47, "snippet": "  155:             'seq': seq,\n  156:             'd': data\n  157:         };\n  158:         console.log(\"Sending:\");\n  159:         console.log('4' + JSON.stringify(msg));\n  160:         this.ws.send('4' + JSON.stringify(msg));\n  161:         return seq;\n  162:     }\n  163: }\n  164: exports.WebsocketProvider = WebsocketProvider;"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 290, "start_column": 90, "end_line": null, "end_column": 102, "snippet": "  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });"}}, {"message": "[\"mkdir ... id() }]", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 290, "start_column": 80, "end_line": null, "end_column": 156, "snippet": "  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });"}}, {"message": "data", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/extension.js", "start_line": 407, "start_column": 42, "end_line": null, "end_column": 46, "snippet": "  402: }\n  403: \n  404: /////\n  405: \n  406: function setEventEmitterEvents() {\n  407:     eventEmitter.on('send_ch4_message', (data) => {\n  408:         websocketProvider.send_ch4_message(data);\n  409:     });\n  410: \n  411:     eventEmitter.on('request_connect', (environment) => {\n  412:         refreshEnvironmentsInSidebar().then(() => {"}}, {"message": "data", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/extension.js", "start_line": 408, "start_column": 44, "end_line": null, "end_column": 48, "snippet": "  403: \n  404: /////\n  405: \n  406: function setEventEmitterEvents() {\n  407:     eventEmitter.on('send_ch4_message', (data) => {\n  408:         websocketProvider.send_ch4_message(data);\n  409:     });\n  410: \n  411:     eventEmitter.on('request_connect', (environment) => {\n  412:         refreshEnvironmentsInSidebar().then(() => {\n  413:             commandConnect(environment);"}}, {"message": "data", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/websocketProvider.js", "start_line": 150, "start_column": 22, "end_line": null, "end_column": 26, "snippet": "  145:         this.send_ch4_message([\"call\", \"ping\", \"ping\", [\"serverTime\", { \"$\": this.next_event_id() }]]);\n  146:         this.send_ch4_message([\"extend\", \"collab\", { \"file\": \"c9.ide.collab/server/collab-server.js\" }, { \"$\": this.next_event_id() }]);\n  147:         this.eventEmitter.emit('websocket_init_complete');\n  148:         this.sessionState = \"CONNECTED\";\n  149:     }\n  150:     send_ch4_message(data) {\n  151:         let seq = this.my_seq;\n  152:         this.my_seq += 1;\n  153:         let msg = {\n  154:             'ack': this.last_seq,\n  155:             'seq': seq,"}}, {"message": "data", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/websocketProvider.js", "start_line": 156, "start_column": 18, "end_line": null, "end_column": 22, "snippet": "  151:         let seq = this.my_seq;\n  152:         this.my_seq += 1;\n  153:         let msg = {\n  154:             'ack': this.last_seq,\n  155:             'seq': seq,\n  156:             'd': data\n  157:         };\n  158:         console.log(\"Sending:\");\n  159:         console.log('4' + JSON.stringify(msg));\n  160:         this.ws.send('4' + JSON.stringify(msg));\n  161:         return seq;"}}, {"message": "JSON.stringify(msg)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/websocketProvider.js", "start_line": 160, "start_column": 28, "end_line": null, "end_column": 47, "snippet": "  155:             'seq': seq,\n  156:             'd': data\n  157:         };\n  158:         console.log(\"Sending:\");\n  159:         console.log('4' + JSON.stringify(msg));\n  160:         this.ws.send('4' + JSON.stringify(msg));\n  161:         return seq;\n  162:     }\n  163: }\n  164: exports.WebsocketProvider = WebsocketProvider;"}}, {"message": "'4' + J ... fy(msg)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/websocketProvider.js", "start_line": 160, "start_column": 22, "end_line": null, "end_column": 47, "snippet": "  155:             'seq': seq,\n  156:             'd': data\n  157:         };\n  158:         console.log(\"Sending:\");\n  159:         console.log('4' + JSON.stringify(msg));\n  160:         this.ws.send('4' + JSON.stringify(msg));\n  161:         return seq;\n  162:     }\n  163: }\n  164: exports.WebsocketProvider = WebsocketProvider;"}}]}
{"result_index": 54, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/websocketProvider.js", "start_line": 160, "start_column": 28, "end_line": null, "end_column": 47, "snippet": "  155:             'seq': seq,\n  156:             'd': data\n  157:         };\n  158:         console.log(\"Sending:\");\n  159:         console.log('4' + JSON.stringify(msg));\n  160:         this.ws.send('4' + JSON.stringify(msg));\n  161:         return seq;\n  162:     }\n  163: }\n  164: exports.WebsocketProvider = WebsocketProvider;"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 290, "start_column": 90, "end_line": null, "end_column": 102, "snippet": "  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });"}}, {"message": "[\"mkdir ... id() }]", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 290, "start_column": 80, "end_line": null, "end_column": 156, "snippet": "  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });"}}, {"message": "data", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/extension.js", "start_line": 407, "start_column": 42, "end_line": null, "end_column": 46, "snippet": "  402: }\n  403: \n  404: /////\n  405: \n  406: function setEventEmitterEvents() {\n  407:     eventEmitter.on('send_ch4_message', (data) => {\n  408:         websocketProvider.send_ch4_message(data);\n  409:     });\n  410: \n  411:     eventEmitter.on('request_connect', (environment) => {\n  412:         refreshEnvironmentsInSidebar().then(() => {"}}, {"message": "data", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/extension.js", "start_line": 408, "start_column": 44, "end_line": null, "end_column": 48, "snippet": "  403: \n  404: /////\n  405: \n  406: function setEventEmitterEvents() {\n  407:     eventEmitter.on('send_ch4_message', (data) => {\n  408:         websocketProvider.send_ch4_message(data);\n  409:     });\n  410: \n  411:     eventEmitter.on('request_connect', (environment) => {\n  412:         refreshEnvironmentsInSidebar().then(() => {\n  413:             commandConnect(environment);"}}, {"message": "data", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/websocketProvider.js", "start_line": 150, "start_column": 22, "end_line": null, "end_column": 26, "snippet": "  145:         this.send_ch4_message([\"call\", \"ping\", \"ping\", [\"serverTime\", { \"$\": this.next_event_id() }]]);\n  146:         this.send_ch4_message([\"extend\", \"collab\", { \"file\": \"c9.ide.collab/server/collab-server.js\" }, { \"$\": this.next_event_id() }]);\n  147:         this.eventEmitter.emit('websocket_init_complete');\n  148:         this.sessionState = \"CONNECTED\";\n  149:     }\n  150:     send_ch4_message(data) {\n  151:         let seq = this.my_seq;\n  152:         this.my_seq += 1;\n  153:         let msg = {\n  154:             'ack': this.last_seq,\n  155:             'seq': seq,"}}, {"message": "data", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/websocketProvider.js", "start_line": 156, "start_column": 18, "end_line": null, "end_column": 22, "snippet": "  151:         let seq = this.my_seq;\n  152:         this.my_seq += 1;\n  153:         let msg = {\n  154:             'ack': this.last_seq,\n  155:             'seq': seq,\n  156:             'd': data\n  157:         };\n  158:         console.log(\"Sending:\");\n  159:         console.log('4' + JSON.stringify(msg));\n  160:         this.ws.send('4' + JSON.stringify(msg));\n  161:         return seq;"}}, {"message": "JSON.stringify(msg)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/websocketProvider.js", "start_line": 160, "start_column": 28, "end_line": null, "end_column": 47, "snippet": "  155:             'seq': seq,\n  156:             'd': data\n  157:         };\n  158:         console.log(\"Sending:\");\n  159:         console.log('4' + JSON.stringify(msg));\n  160:         this.ws.send('4' + JSON.stringify(msg));\n  161:         return seq;\n  162:     }\n  163: }\n  164: exports.WebsocketProvider = WebsocketProvider;"}}]}
{"result_index": 55, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 156, "start_column": null, "end_line": 160, "end_column": 2, "snippet": "  151:         }\n  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 244, "start_column": 150, "end_line": null, "end_column": 159, "snippet": "  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',\n  248:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  249:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 156, "start_column": 29, "end_line": null, "end_column": 32, "snippet": "  151:         }\n  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 158, "start_column": 16, "end_line": null, "end_column": 19, "snippet": "  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;\n  162: function GetRegion() {\n  163:     let extensionConfig = vscode.workspace.getConfiguration('cloud9sync');"}}, {"message": "return of function EnsureLeadingSlash", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 156, "start_column": null, "end_line": 160, "end_column": 2, "snippet": "  151:         }\n  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 244, "start_column": 150, "end_line": null, "end_column": 159, "snippet": "  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',\n  248:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  249:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 156, "start_column": 29, "end_line": null, "end_column": 32, "snippet": "  151:         }\n  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 159, "start_column": 18, "end_line": null, "end_column": 21, "snippet": "  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;\n  162: function GetRegion() {\n  163:     let extensionConfig = vscode.workspace.getConfiguration('cloud9sync');\n  164:     return extensionConfig.get('region');"}}, {"message": "\"/\" + str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 159, "start_column": 12, "end_line": null, "end_column": 21, "snippet": "  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;\n  162: function GetRegion() {\n  163:     let extensionConfig = vscode.workspace.getConfiguration('cloud9sync');\n  164:     return extensionConfig.get('region');"}}, {"message": "return of function EnsureLeadingSlash", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 156, "start_column": null, "end_line": 160, "end_column": 2, "snippet": "  151:         }\n  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;"}}]}
{"result_index": 56, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 17, "end_line": null, "end_column": 26, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 63, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "startPath + \"/\"", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 69, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "path.jo ...  + \"/\")", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 29, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "inodePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 17, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "inodePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 17, "end_line": null, "end_column": 26, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}]}
{"result_index": 57, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 41, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 41, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}]}
{"result_index": 58, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 33, "end_line": null, "end_column": 41, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 65, "end_line": null, "end_column": 69, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 44, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "filepath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 33, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "filepath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 33, "end_line": null, "end_column": 41, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 63, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "startPath + \"/\"", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 69, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "path.jo ...  + \"/\")", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 29, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "inodePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 17, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "inodePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 54, "end_line": null, "end_column": 63, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 44, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "filepath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 33, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "filepath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 33, "end_line": null, "end_column": 41, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}]}
{"result_index": 59, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 282, "start_column": 29, "end_line": null, "end_column": 51, "snippet": "  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 282, "start_column": 29, "end_line": null, "end_column": 51, "snippet": "  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");"}}]}
{"result_index": 60, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 282, "start_column": 55, "end_line": null, "end_column": 81, "snippet": "  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 282, "start_column": 55, "end_line": null, "end_column": 81, "snippet": "  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");"}}]}
{"result_index": 61, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.\n(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 157, "start_column": 9, "end_line": null, "end_column": 22, "snippet": "  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;\n  162: function GetRegion() {"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 244, "start_column": 150, "end_line": null, "end_column": 159, "snippet": "  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',\n  248:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  249:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 156, "start_column": 29, "end_line": null, "end_column": 32, "snippet": "  151:         }\n  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 157, "start_column": 9, "end_line": null, "end_column": 22, "snippet": "  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;\n  162: function GetRegion() {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 244, "start_column": 150, "end_line": null, "end_column": 159, "snippet": "  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',\n  248:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  249:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 156, "start_column": 29, "end_line": null, "end_column": 32, "snippet": "  151:         }\n  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 157, "start_column": 9, "end_line": null, "end_column": 22, "snippet": "  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;\n  162: function GetRegion() {"}}]}
{"result_index": 62, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.\n(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 157, "start_column": 26, "end_line": null, "end_column": 40, "snippet": "  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;\n  162: function GetRegion() {"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 244, "start_column": 150, "end_line": null, "end_column": 159, "snippet": "  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',\n  248:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  249:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 156, "start_column": 29, "end_line": null, "end_column": 32, "snippet": "  151:         }\n  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 157, "start_column": 26, "end_line": null, "end_column": 40, "snippet": "  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;\n  162: function GetRegion() {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 244, "start_column": 150, "end_line": null, "end_column": 159, "snippet": "  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',\n  248:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  249:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 156, "start_column": 29, "end_line": null, "end_column": 32, "snippet": "  151:         }\n  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 157, "start_column": 26, "end_line": null, "end_column": 40, "snippet": "  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;\n  162: function GetRegion() {"}}]}
{"result_index": 63, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 235, "start_column": 28, "end_line": null, "end_column": 28, "snippet": "  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 235, "start_column": 28, "end_line": null, "end_column": 28, "snippet": "  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;"}}]}
{"result_index": 64, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 253, "start_column": 16, "end_line": null, "end_column": 16, "snippet": "  248:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  249:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,\n  250:                     'x-authorization': this.xauth\n  251:                 },\n  252:                 proxy: Utils.GetProxy()\n  253:             }, (err, httpResponse, body) => {\n  254:                 console.log(\"REMOTE STAT FOR UPLOAD\");\n  255:                 console.log(err);\n  256:                 console.log(body);\n  257:                 let remoteStats = [];\n  258:                 try {"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 63, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "startPath + \"/\"", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 69, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "path.jo ...  + \"/\")", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 29, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "inodePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 17, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "inodePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 253, "start_column": 16, "end_line": null, "end_column": 16, "snippet": "  248:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  249:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,\n  250:                     'x-authorization': this.xauth\n  251:                 },\n  252:                 proxy: Utils.GetProxy()\n  253:             }, (err, httpResponse, body) => {\n  254:                 console.log(\"REMOTE STAT FOR UPLOAD\");\n  255:                 console.log(err);\n  256:                 console.log(body);\n  257:                 let remoteStats = [];\n  258:                 try {"}}]}
{"result_index": 65, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 39, "end_line": null, "end_column": 39, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 63, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "startPath + \"/\"", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 69, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "path.jo ...  + \"/\")", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 29, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "inodePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 17, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "inodePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 39, "end_line": null, "end_column": 39, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}]}
{"result_index": 66, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 49, "end_line": null, "end_column": 49, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 49, "end_line": null, "end_column": 49, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}]}
{"result_index": 67, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.\n(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.\n(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 285, "start_column": 44, "end_line": null, "end_column": 44, "snippet": "  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 63, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "startPath + \"/\"", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 69, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "path.jo ...  + \"/\")", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 29, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "inodePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 17, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "inodePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 285, "start_column": 44, "end_line": null, "end_column": 44, "snippet": "  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 285, "start_column": 44, "end_line": null, "end_column": 44, "snippet": "  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 285, "start_column": 44, "end_line": null, "end_column": 44, "snippet": "  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);"}}]}
{"result_index": 68, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.\n(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 288, "start_column": 47, "end_line": null, "end_column": 47, "snippet": "  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 288, "start_column": 47, "end_line": null, "end_column": 47, "snippet": "  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 65, "end_line": null, "end_column": 69, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 44, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "filepath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 33, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "filepath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 288, "start_column": 47, "end_line": null, "end_column": 47, "snippet": "  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 63, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "startPath + \"/\"", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 69, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "path.jo ...  + \"/\")", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 29, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "inodePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 17, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "inodePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 54, "end_line": null, "end_column": 63, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 44, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "filepath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 33, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "filepath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 288, "start_column": 47, "end_line": null, "end_column": 47, "snippet": "  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {"}}]}
{"result_index": 69, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 301, "start_column": 57, "end_line": null, "end_column": 57, "snippet": "  296:                                 }\n  297:                                 else if (fstat.isFile()) {\n  298:                                     let ftime = null;\n  299:                                     let lftime = new Date(fstat['mtime']).getTime();\n  300:                                     console.log(\"Checking remote stats now\");\n  301:                                     remoteStats.forEach(remoteStat => {\n  302:                                         if (remoteStat.name == relativePath) {\n  303:                                             ftime = remoteStat.mtime;\n  304:                                         }\n  305:                                     });\n  306:                                     console.log(\"ftime: \" + ftime);"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 301, "start_column": 57, "end_line": null, "end_column": 57, "snippet": "  296:                                 }\n  297:                                 else if (fstat.isFile()) {\n  298:                                     let ftime = null;\n  299:                                     let lftime = new Date(fstat['mtime']).getTime();\n  300:                                     console.log(\"Checking remote stats now\");\n  301:                                     remoteStats.forEach(remoteStat => {\n  302:                                         if (remoteStat.name == relativePath) {\n  303:                                             ftime = remoteStat.mtime;\n  304:                                         }\n  305:                                     });\n  306:                                     console.log(\"ftime: \" + ftime);"}}]}
{"result_index": 70, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 181, "start_column": 28, "end_line": null, "end_column": 28, "snippet": "  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,\n  184:                 jar: this.cookieJar,\n  185:                 headers: {\n  186:                     'Content-Type': 'text/plain',"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 309, "start_column": 63, "end_line": null, "end_column": 75, "snippet": "  304:                                         }\n  305:                                     });\n  306:                                     console.log(\"ftime: \" + ftime);\n  307:                                     if (ftime == null) {\n  308:                                         console.log(\"Uploading new file\");\n  309:                                         this.uploadRemoteFile(relativePath, fs.readFileSync(filepath));\n  310:                                     }\n  311:                                     else if (lftime > ftime + SYNC_TIME_VARIANCE) {\n  312:                                         console.log(\"Updating existing file\");\n  313:                                         this.uploadExistingFile(relativePath, fs.readFileSync(filepath));\n  314:                                     }"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 180, "start_column": 22, "end_line": null, "end_column": 30, "snippet": "  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,\n  184:                 jar: this.cookieJar,\n  185:                 headers: {"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 181, "start_column": 28, "end_line": null, "end_column": 28, "snippet": "  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,\n  184:                 jar: this.cookieJar,\n  185:                 headers: {\n  186:                     'Content-Type': 'text/plain',"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 313, "start_column": 65, "end_line": null, "end_column": 77, "snippet": "  308:                                         console.log(\"Uploading new file\");\n  309:                                         this.uploadRemoteFile(relativePath, fs.readFileSync(filepath));\n  310:                                     }\n  311:                                     else if (lftime > ftime + SYNC_TIME_VARIANCE) {\n  312:                                         console.log(\"Updating existing file\");\n  313:                                         this.uploadExistingFile(relativePath, fs.readFileSync(filepath));\n  314:                                     }\n  315:                                     resolve();\n  316:                                 }\n  317:                                 else {\n  318:                                     console.log(\"Unknown file type\");"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 177, "start_column": 24, "end_line": null, "end_column": 32, "snippet": "  172:         });\n  173:     }\n  174:     uploadNewFile(filename) {\n  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 178, "start_column": 38, "end_line": null, "end_column": 46, "snippet": "  173:     }\n  174:     uploadNewFile(filename) {\n  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 180, "start_column": 22, "end_line": null, "end_column": 30, "snippet": "  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,\n  184:                 jar: this.cookieJar,\n  185:                 headers: {"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 181, "start_column": 28, "end_line": null, "end_column": 28, "snippet": "  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,\n  184:                 jar: this.cookieJar,\n  185:                 headers: {\n  186:                     'Content-Type': 'text/plain',"}}]}
{"result_index": 71, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 199, "start_column": 32, "end_line": null, "end_column": 32, "snippet": "  194:                 console.log(httpResponse);\n  195:                 console.log(body);\n  196:                 let response = httpResponse; //JSON.parse(httpResponse);\n  197:                 if (response && response.statusCode == 429) { // retry with backoff\n  198:                     console.warn(\"retrying with backoff\");\n  199:                     setTimeout(() => {\n  200:                         this.uploadRemoteFile(filename, content).then(() => {\n  201:                             resolve();\n  202:                         }).catch(err => {\n  203:                             reject(err);\n  204:                         });"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 309, "start_column": 63, "end_line": null, "end_column": 75, "snippet": "  304:                                         }\n  305:                                     });\n  306:                                     console.log(\"ftime: \" + ftime);\n  307:                                     if (ftime == null) {\n  308:                                         console.log(\"Uploading new file\");\n  309:                                         this.uploadRemoteFile(relativePath, fs.readFileSync(filepath));\n  310:                                     }\n  311:                                     else if (lftime > ftime + SYNC_TIME_VARIANCE) {\n  312:                                         console.log(\"Updating existing file\");\n  313:                                         this.uploadExistingFile(relativePath, fs.readFileSync(filepath));\n  314:                                     }"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 180, "start_column": 22, "end_line": null, "end_column": 30, "snippet": "  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,\n  184:                 jar: this.cookieJar,\n  185:                 headers: {"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 199, "start_column": 32, "end_line": null, "end_column": 32, "snippet": "  194:                 console.log(httpResponse);\n  195:                 console.log(body);\n  196:                 let response = httpResponse; //JSON.parse(httpResponse);\n  197:                 if (response && response.statusCode == 429) { // retry with backoff\n  198:                     console.warn(\"retrying with backoff\");\n  199:                     setTimeout(() => {\n  200:                         this.uploadRemoteFile(filename, content).then(() => {\n  201:                             resolve();\n  202:                         }).catch(err => {\n  203:                             reject(err);\n  204:                         });"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 313, "start_column": 65, "end_line": null, "end_column": 77, "snippet": "  308:                                         console.log(\"Uploading new file\");\n  309:                                         this.uploadRemoteFile(relativePath, fs.readFileSync(filepath));\n  310:                                     }\n  311:                                     else if (lftime > ftime + SYNC_TIME_VARIANCE) {\n  312:                                         console.log(\"Updating existing file\");\n  313:                                         this.uploadExistingFile(relativePath, fs.readFileSync(filepath));\n  314:                                     }\n  315:                                     resolve();\n  316:                                 }\n  317:                                 else {\n  318:                                     console.log(\"Unknown file type\");"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 177, "start_column": 24, "end_line": null, "end_column": 32, "snippet": "  172:         });\n  173:     }\n  174:     uploadNewFile(filename) {\n  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 178, "start_column": 38, "end_line": null, "end_column": 46, "snippet": "  173:     }\n  174:     uploadNewFile(filename) {\n  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 180, "start_column": 22, "end_line": null, "end_column": 30, "snippet": "  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,\n  184:                 jar: this.cookieJar,\n  185:                 headers: {"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 199, "start_column": 32, "end_line": null, "end_column": 32, "snippet": "  194:                 console.log(httpResponse);\n  195:                 console.log(body);\n  196:                 let response = httpResponse; //JSON.parse(httpResponse);\n  197:                 if (response && response.statusCode == 429) { // retry with backoff\n  198:                     console.warn(\"retrying with backoff\");\n  199:                     setTimeout(() => {\n  200:                         this.uploadRemoteFile(filename, content).then(() => {\n  201:                             resolve();\n  202:                         }).catch(err => {\n  203:                             reject(err);\n  204:                         });"}}]}
{"result_index": 72, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 178, "start_column": 23, "end_line": null, "end_column": 23, "snippet": "  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);\n  181:                 return results;\n  182:             }).catch((y) => {\n  183:                 console.error(y);"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "array", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 175, "start_column": 25, "end_line": null, "end_column": 30, "snippet": "  170:     if (proxy == \"\")\n  171:         return null;\n  172:     return proxy;\n  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);"}}, {"message": "array", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 177, "start_column": 12, "end_line": null, "end_column": 17, "snippet": "  172:     return proxy;\n  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);\n  181:                 return results;\n  182:             }).catch((y) => {"}}, {"message": "item", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 177, "start_column": 38, "end_line": null, "end_column": 42, "snippet": "  172:     return proxy;\n  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);\n  181:                 return results;\n  182:             }).catch((y) => {"}}, {"message": "item", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 178, "start_column": 23, "end_line": null, "end_column": 23, "snippet": "  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);\n  181:                 return results;\n  182:             }).catch((y) => {\n  183:                 console.error(y);"}}]}
{"result_index": 73, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}]}
{"result_index": 74, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 33, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 65, "end_line": null, "end_column": 69, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 44, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "filepath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 33, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 63, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "startPath + \"/\"", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 69, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "path.jo ...  + \"/\")", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 29, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "inodePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 17, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "inodePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 54, "end_line": null, "end_column": 63, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 44, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "filepath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 33, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}]}
{"result_index": 75, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 17, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 63, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "startPath + \"/\"", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 69, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "path.jo ...  + \"/\")", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 29, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "inodePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 17, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}]}
{"result_index": 76, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 21, "end_line": null, "end_column": 22, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 21, "end_line": null, "end_column": 22, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}]}
{"result_index": 77, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 158, "start_column": 16, "end_line": null, "end_column": 17, "snippet": "  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;\n  162: function GetRegion() {\n  163:     let extensionConfig = vscode.workspace.getConfiguration('cloud9sync');"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 244, "start_column": 150, "end_line": null, "end_column": 159, "snippet": "  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',\n  248:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  249:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 156, "start_column": 29, "end_line": null, "end_column": 32, "snippet": "  151:         }\n  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 158, "start_column": 16, "end_line": null, "end_column": 17, "snippet": "  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;\n  162: function GetRegion() {\n  163:     let extensionConfig = vscode.workspace.getConfiguration('cloud9sync');"}}]}
{"result_index": 0, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/fredericbonnet.cmake-test-adapter-0.16.3/extension/out/cmake-runner.js", "start_line": 24, "start_column": 36, "end_line": null, "end_column": 39, "snippet": "   19:         super(m);\n   20:         Object.setPrototypeOf(this, CacheNotFoundError.prototype);\n   21:     }\n   22: }\n   23: exports.CacheNotFoundError = CacheNotFoundError;\n   24: function loadCmakeTests(ctestPath, cwd, buildConfig, extraArgs = '') {\n   25:     return new Promise((resolve, reject) => {\n   26:         try {\n   27:             if (!fs.statSync(cwd).isDirectory()) {\n   28:                 throw new Error(`Directory '${cwd}' does not exist`);\n   29:             }"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/fredericbonnet.cmake-test-adapter-0.16.3/extension/out/cmake-adapter.js", "start_line": 145, "start_column": 29, "end_line": null, "end_column": 84, "snippet": "  140:                     'extraCtestLoadArgs',\n  141:                     'suiteDelimiter',\n  142:                     'testFileVar',\n  143:                     'testLineVar',\n  144:                 ]);\n  145:                 const dir = path.resolve(this.workspaceFolder.uri.fsPath, buildDir);\n  146:                 this.ctestPath = cmake_runner_1.getCtestPath(dir);\n  147:                 this.cmakeTests = yield cmake_runner_1.loadCmakeTests(this.ctestPath, dir, buildConfig, extraCtestLoadArgs);\n  148:                 const rootSuite = {\n  149:                     type: 'suite',\n  150:                     id: ROOT_SUITE_ID,"}, "path": [{"message": "path.re ... ildDir)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/fredericbonnet.cmake-test-adapter-0.16.3/extension/out/cmake-adapter.js", "start_line": 145, "start_column": 29, "end_line": null, "end_column": 84, "snippet": "  140:                     'extraCtestLoadArgs',\n  141:                     'suiteDelimiter',\n  142:                     'testFileVar',\n  143:                     'testLineVar',\n  144:                 ]);\n  145:                 const dir = path.resolve(this.workspaceFolder.uri.fsPath, buildDir);\n  146:                 this.ctestPath = cmake_runner_1.getCtestPath(dir);\n  147:                 this.cmakeTests = yield cmake_runner_1.loadCmakeTests(this.ctestPath, dir, buildConfig, extraCtestLoadArgs);\n  148:                 const rootSuite = {\n  149:                     type: 'suite',\n  150:                     id: ROOT_SUITE_ID,"}}, {"message": "dir", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/fredericbonnet.cmake-test-adapter-0.16.3/extension/out/cmake-adapter.js", "start_line": 145, "start_column": 23, "end_line": null, "end_column": 84, "snippet": "  140:                     'extraCtestLoadArgs',\n  141:                     'suiteDelimiter',\n  142:                     'testFileVar',\n  143:                     'testLineVar',\n  144:                 ]);\n  145:                 const dir = path.resolve(this.workspaceFolder.uri.fsPath, buildDir);\n  146:                 this.ctestPath = cmake_runner_1.getCtestPath(dir);\n  147:                 this.cmakeTests = yield cmake_runner_1.loadCmakeTests(this.ctestPath, dir, buildConfig, extraCtestLoadArgs);\n  148:                 const rootSuite = {\n  149:                     type: 'suite',\n  150:                     id: ROOT_SUITE_ID,"}}, {"message": "dir", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/fredericbonnet.cmake-test-adapter-0.16.3/extension/out/cmake-adapter.js", "start_line": 147, "start_column": 87, "end_line": null, "end_column": 90, "snippet": "  142:                     'testFileVar',\n  143:                     'testLineVar',\n  144:                 ]);\n  145:                 const dir = path.resolve(this.workspaceFolder.uri.fsPath, buildDir);\n  146:                 this.ctestPath = cmake_runner_1.getCtestPath(dir);\n  147:                 this.cmakeTests = yield cmake_runner_1.loadCmakeTests(this.ctestPath, dir, buildConfig, extraCtestLoadArgs);\n  148:                 const rootSuite = {\n  149:                     type: 'suite',\n  150:                     id: ROOT_SUITE_ID,\n  151:                     label: 'CMake',\n  152:                     children: [],"}}, {"message": "cwd", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/fredericbonnet.cmake-test-adapter-0.16.3/extension/out/cmake-runner.js", "start_line": 24, "start_column": 36, "end_line": null, "end_column": 39, "snippet": "   19:         super(m);\n   20:         Object.setPrototypeOf(this, CacheNotFoundError.prototype);\n   21:     }\n   22: }\n   23: exports.CacheNotFoundError = CacheNotFoundError;\n   24: function loadCmakeTests(ctestPath, cwd, buildConfig, extraArgs = '') {\n   25:     return new Promise((resolve, reject) => {\n   26:         try {\n   27:             if (!fs.statSync(cwd).isDirectory()) {\n   28:                 throw new Error(`Directory '${cwd}' does not exist`);\n   29:             }"}}, {"message": "cwd", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/fredericbonnet.cmake-test-adapter-0.16.3/extension/out/cmake-runner.js", "start_line": 24, "start_column": 36, "end_line": null, "end_column": 39, "snippet": "   19:         super(m);\n   20:         Object.setPrototypeOf(this, CacheNotFoundError.prototype);\n   21:     }\n   22: }\n   23: exports.CacheNotFoundError = CacheNotFoundError;\n   24: function loadCmakeTests(ctestPath, cwd, buildConfig, extraArgs = '') {\n   25:     return new Promise((resolve, reject) => {\n   26:         try {\n   27:             if (!fs.statSync(cwd).isDirectory()) {\n   28:                 throw new Error(`Directory '${cwd}' does not exist`);\n   29:             }"}}]}
{"result_index": 0, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/life-cycle/startup.js", "start_line": 82, "start_column": 15, "end_line": null, "end_column": 19, "snippet": "   77:     ]);\n   78: }\n   79: function getNonce() {\n   80:     return new Promise((resolve, reject) => {\n   81:         const dir = utils_1.getDataDirectory();\n   82:         const file = path.join(dir, 'lock.json');\n   83:         fs.mkdir(dir, (err) => {\n   84:             if (err) {\n   85:                 if (err.code === 'EEXIST') {\n   86:                     fs.readFile(file, (err, data) => {\n   87:                         if (err) {"}, "source": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/life-cycle/utils.js", "start_line": 28, "start_column": 22, "end_line": null, "end_column": 31, "snippet": "   23: function generateNonce() {\n   24:     return crypto.randomBytes(32).toString('base64');\n   25: }\n   26: exports.generateNonce = generateNonce;\n   27: function getDataDirectory() {\n   28:     return path.join(__dirname, 'data');\n   29: }\n   30: exports.getDataDirectory = getDataDirectory;\n   31: function getLifeCycleFilePathInDirectory(directory) {\n   32:     return path.join(directory, 'life-cycle.json');\n   33: }"}, "path": [{"message": "__dirname", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/life-cycle/utils.js", "start_line": 28, "start_column": 22, "end_line": null, "end_column": 31, "snippet": "   23: function generateNonce() {\n   24:     return crypto.randomBytes(32).toString('base64');\n   25: }\n   26: exports.generateNonce = generateNonce;\n   27: function getDataDirectory() {\n   28:     return path.join(__dirname, 'data');\n   29: }\n   30: exports.getDataDirectory = getDataDirectory;\n   31: function getLifeCycleFilePathInDirectory(directory) {\n   32:     return path.join(directory, 'life-cycle.json');\n   33: }"}}, {"message": "path.jo ... 'data')", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/life-cycle/utils.js", "start_line": 28, "start_column": 12, "end_line": null, "end_column": 40, "snippet": "   23: function generateNonce() {\n   24:     return crypto.randomBytes(32).toString('base64');\n   25: }\n   26: exports.generateNonce = generateNonce;\n   27: function getDataDirectory() {\n   28:     return path.join(__dirname, 'data');\n   29: }\n   30: exports.getDataDirectory = getDataDirectory;\n   31: function getLifeCycleFilePathInDirectory(directory) {\n   32:     return path.join(directory, 'life-cycle.json');\n   33: }"}}, {"message": "utils_1 ... ctory()", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/life-cycle/startup.js", "start_line": 81, "start_column": 21, "end_line": null, "end_column": 47, "snippet": "   76:         utils_1.saveLifeCycleStateInDirectory(utils_1.getDataDirectory(), state)\n   77:     ]);\n   78: }\n   79: function getNonce() {\n   80:     return new Promise((resolve, reject) => {\n   81:         const dir = utils_1.getDataDirectory();\n   82:         const file = path.join(dir, 'lock.json');\n   83:         fs.mkdir(dir, (err) => {\n   84:             if (err) {\n   85:                 if (err.code === 'EEXIST') {\n   86:                     fs.readFile(file, (err, data) => {"}}, {"message": "dir", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/life-cycle/startup.js", "start_line": 81, "start_column": 15, "end_line": null, "end_column": 47, "snippet": "   76:         utils_1.saveLifeCycleStateInDirectory(utils_1.getDataDirectory(), state)\n   77:     ]);\n   78: }\n   79: function getNonce() {\n   80:     return new Promise((resolve, reject) => {\n   81:         const dir = utils_1.getDataDirectory();\n   82:         const file = path.join(dir, 'lock.json');\n   83:         fs.mkdir(dir, (err) => {\n   84:             if (err) {\n   85:                 if (err.code === 'EEXIST') {\n   86:                     fs.readFile(file, (err, data) => {"}}, {"message": "dir", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/life-cycle/startup.js", "start_line": 82, "start_column": 32, "end_line": null, "end_column": 35, "snippet": "   77:     ]);\n   78: }\n   79: function getNonce() {\n   80:     return new Promise((resolve, reject) => {\n   81:         const dir = utils_1.getDataDirectory();\n   82:         const file = path.join(dir, 'lock.json');\n   83:         fs.mkdir(dir, (err) => {\n   84:             if (err) {\n   85:                 if (err.code === 'EEXIST') {\n   86:                     fs.readFile(file, (err, data) => {\n   87:                         if (err) {"}}, {"message": "path.jo ... .json')", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/life-cycle/startup.js", "start_line": 82, "start_column": 22, "end_line": null, "end_column": 49, "snippet": "   77:     ]);\n   78: }\n   79: function getNonce() {\n   80:     return new Promise((resolve, reject) => {\n   81:         const dir = utils_1.getDataDirectory();\n   82:         const file = path.join(dir, 'lock.json');\n   83:         fs.mkdir(dir, (err) => {\n   84:             if (err) {\n   85:                 if (err.code === 'EEXIST') {\n   86:                     fs.readFile(file, (err, data) => {\n   87:                         if (err) {"}}, {"message": "file", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/life-cycle/startup.js", "start_line": 82, "start_column": 15, "end_line": null, "end_column": 49, "snippet": "   77:     ]);\n   78: }\n   79: function getNonce() {\n   80:     return new Promise((resolve, reject) => {\n   81:         const dir = utils_1.getDataDirectory();\n   82:         const file = path.join(dir, 'lock.json');\n   83:         fs.mkdir(dir, (err) => {\n   84:             if (err) {\n   85:                 if (err.code === 'EEXIST') {\n   86:                     fs.readFile(file, (err, data) => {\n   87:                         if (err) {"}}, {"message": "file", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/life-cycle/startup.js", "start_line": 82, "start_column": 15, "end_line": null, "end_column": 19, "snippet": "   77:     ]);\n   78: }\n   79: function getNonce() {\n   80:     return new Promise((resolve, reject) => {\n   81:         const dir = utils_1.getDataDirectory();\n   82:         const file = path.join(dir, 'lock.json');\n   83:         fs.mkdir(dir, (err) => {\n   84:             if (err) {\n   85:                 if (err.code === 'EEXIST') {\n   86:                     fs.readFile(file, (err, data) => {\n   87:                         if (err) {"}}]}
{"result_index": 1, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/life-cycle/utils.js", "start_line": 34, "start_column": 39, "end_line": null, "end_column": 48, "snippet": "   29: }\n   30: exports.getDataDirectory = getDataDirectory;\n   31: function getLifeCycleFilePathInDirectory(directory) {\n   32:     return path.join(directory, 'life-cycle.json');\n   33: }\n   34: function getLifeCycleStateInDirectory(directory) {\n   35:     return new Promise((resolve) => {\n   36:         fs.readFile(getLifeCycleFilePathInDirectory(directory), (err, data) => {\n   37:             if (err) {\n   38:                 resolve(null);\n   39:             }"}, "source": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/life-cycle/utils.js", "start_line": 28, "start_column": 22, "end_line": null, "end_column": 31, "snippet": "   23: function generateNonce() {\n   24:     return crypto.randomBytes(32).toString('base64');\n   25: }\n   26: exports.generateNonce = generateNonce;\n   27: function getDataDirectory() {\n   28:     return path.join(__dirname, 'data');\n   29: }\n   30: exports.getDataDirectory = getDataDirectory;\n   31: function getLifeCycleFilePathInDirectory(directory) {\n   32:     return path.join(directory, 'life-cycle.json');\n   33: }"}, "path": [{"message": "__dirname", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/life-cycle/utils.js", "start_line": 28, "start_column": 22, "end_line": null, "end_column": 31, "snippet": "   23: function generateNonce() {\n   24:     return crypto.randomBytes(32).toString('base64');\n   25: }\n   26: exports.generateNonce = generateNonce;\n   27: function getDataDirectory() {\n   28:     return path.join(__dirname, 'data');\n   29: }\n   30: exports.getDataDirectory = getDataDirectory;\n   31: function getLifeCycleFilePathInDirectory(directory) {\n   32:     return path.join(directory, 'life-cycle.json');\n   33: }"}}, {"message": "path.jo ... 'data')", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/life-cycle/utils.js", "start_line": 28, "start_column": 12, "end_line": null, "end_column": 40, "snippet": "   23: function generateNonce() {\n   24:     return crypto.randomBytes(32).toString('base64');\n   25: }\n   26: exports.generateNonce = generateNonce;\n   27: function getDataDirectory() {\n   28:     return path.join(__dirname, 'data');\n   29: }\n   30: exports.getDataDirectory = getDataDirectory;\n   31: function getLifeCycleFilePathInDirectory(directory) {\n   32:     return path.join(directory, 'life-cycle.json');\n   33: }"}}, {"message": "utils_1 ... ctory()", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/life-cycle/uninstall.js", "start_line": 16, "start_column": 70, "end_line": null, "end_column": 96, "snippet": "   11: Object.defineProperty(exports, \"__esModule\", { value: true });\n   12: const utils_1 = require(\"./utils\");\n   13: (function () {\n   14:     return __awaiter(this, void 0, void 0, function* () {\n   15:         try {\n   16:             const state = yield utils_1.getLifeCycleStateInDirectory(utils_1.getDataDirectory());\n   17:             if (state !== null) {\n   18:                 if (state.apiAvailable) {\n   19:                     state.queue.push({\n   20:                         stage: utils_1.LifeCycleStage.Uninstall,\n   21:                         extension: state.current.extension,"}}, {"message": "directory", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/life-cycle/utils.js", "start_line": 34, "start_column": 39, "end_line": null, "end_column": 48, "snippet": "   29: }\n   30: exports.getDataDirectory = getDataDirectory;\n   31: function getLifeCycleFilePathInDirectory(directory) {\n   32:     return path.join(directory, 'life-cycle.json');\n   33: }\n   34: function getLifeCycleStateInDirectory(directory) {\n   35:     return new Promise((resolve) => {\n   36:         fs.readFile(getLifeCycleFilePathInDirectory(directory), (err, data) => {\n   37:             if (err) {\n   38:                 resolve(null);\n   39:             }"}}, {"message": "directory", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/life-cycle/utils.js", "start_line": 34, "start_column": 39, "end_line": null, "end_column": 48, "snippet": "   29: }\n   30: exports.getDataDirectory = getDataDirectory;\n   31: function getLifeCycleFilePathInDirectory(directory) {\n   32:     return path.join(directory, 'life-cycle.json');\n   33: }\n   34: function getLifeCycleStateInDirectory(directory) {\n   35:     return new Promise((resolve) => {\n   36:         fs.readFile(getLifeCycleFilePathInDirectory(directory), (err, data) => {\n   37:             if (err) {\n   38:                 resolve(null);\n   39:             }"}}]}
{"result_index": 2, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/life-cycle/utils.js", "start_line": 52, "start_column": 40, "end_line": null, "end_column": 49, "snippet": "   47:             }\n   48:         });\n   49:     });\n   50: }\n   51: exports.getLifeCycleStateInDirectory = getLifeCycleStateInDirectory;\n   52: function saveLifeCycleStateInDirectory(directory, state) {\n   53:     return new Promise((resolve, reject) => {\n   54:         fs.mkdir(directory, (err) => {\n   55:             if (!err || err.code === 'EEXIST') {\n   56:                 fs.writeFile(getLifeCycleFilePathInDirectory(directory), JSON.stringify(state), (err) => {\n   57:                     if (err) {"}, "source": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/life-cycle/utils.js", "start_line": 28, "start_column": 22, "end_line": null, "end_column": 31, "snippet": "   23: function generateNonce() {\n   24:     return crypto.randomBytes(32).toString('base64');\n   25: }\n   26: exports.generateNonce = generateNonce;\n   27: function getDataDirectory() {\n   28:     return path.join(__dirname, 'data');\n   29: }\n   30: exports.getDataDirectory = getDataDirectory;\n   31: function getLifeCycleFilePathInDirectory(directory) {\n   32:     return path.join(directory, 'life-cycle.json');\n   33: }"}, "path": [{"message": "__dirname", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/life-cycle/utils.js", "start_line": 28, "start_column": 22, "end_line": null, "end_column": 31, "snippet": "   23: function generateNonce() {\n   24:     return crypto.randomBytes(32).toString('base64');\n   25: }\n   26: exports.generateNonce = generateNonce;\n   27: function getDataDirectory() {\n   28:     return path.join(__dirname, 'data');\n   29: }\n   30: exports.getDataDirectory = getDataDirectory;\n   31: function getLifeCycleFilePathInDirectory(directory) {\n   32:     return path.join(directory, 'life-cycle.json');\n   33: }"}}, {"message": "path.jo ... 'data')", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/life-cycle/utils.js", "start_line": 28, "start_column": 12, "end_line": null, "end_column": 40, "snippet": "   23: function generateNonce() {\n   24:     return crypto.randomBytes(32).toString('base64');\n   25: }\n   26: exports.generateNonce = generateNonce;\n   27: function getDataDirectory() {\n   28:     return path.join(__dirname, 'data');\n   29: }\n   30: exports.getDataDirectory = getDataDirectory;\n   31: function getLifeCycleFilePathInDirectory(directory) {\n   32:     return path.join(directory, 'life-cycle.json');\n   33: }"}}, {"message": "utils_1 ... ctory()", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/life-cycle/startup.js", "start_line": 76, "start_column": 47, "end_line": null, "end_column": 73, "snippet": "   71: }\n   72: exports.onStartUp = onStartUp;\n   73: function saveLifeCycleState(extensionContext, state) {\n   74:     return Promise.all([\n   75:         utils_1.saveLifeCycleStateInDirectory(extensionContext.globalStoragePath, state),\n   76:         utils_1.saveLifeCycleStateInDirectory(utils_1.getDataDirectory(), state)\n   77:     ]);\n   78: }\n   79: function getNonce() {\n   80:     return new Promise((resolve, reject) => {\n   81:         const dir = utils_1.getDataDirectory();"}}, {"message": "directory", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/life-cycle/utils.js", "start_line": 52, "start_column": 40, "end_line": null, "end_column": 49, "snippet": "   47:             }\n   48:         });\n   49:     });\n   50: }\n   51: exports.getLifeCycleStateInDirectory = getLifeCycleStateInDirectory;\n   52: function saveLifeCycleStateInDirectory(directory, state) {\n   53:     return new Promise((resolve, reject) => {\n   54:         fs.mkdir(directory, (err) => {\n   55:             if (!err || err.code === 'EEXIST') {\n   56:                 fs.writeFile(getLifeCycleFilePathInDirectory(directory), JSON.stringify(state), (err) => {\n   57:                     if (err) {"}}, {"message": "directory", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/life-cycle/utils.js", "start_line": 52, "start_column": 40, "end_line": null, "end_column": 49, "snippet": "   47:             }\n   48:         });\n   49:     });\n   50: }\n   51: exports.getLifeCycleStateInDirectory = getLifeCycleStateInDirectory;\n   52: function saveLifeCycleStateInDirectory(directory, state) {\n   53:     return new Promise((resolve, reject) => {\n   54:         fs.mkdir(directory, (err) => {\n   55:             if (!err || err.code === 'EEXIST') {\n   56:                 fs.writeFile(getLifeCycleFilePathInDirectory(directory), JSON.stringify(state), (err) => {\n   57:                     if (err) {"}}]}
{"result_index": 3, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 515, "start_column": 23, "end_line": null, "end_column": 27, "snippet": "  510:             }\n  511:         }\n  512:         return Promise.reject();\n  513:     });\n  514: }\n  515: function isExecutable(path) {\n  516:     return new Promise(resolve => {\n  517:         fs.stat(path, (err, stat) => {\n  518:             resolve(!err && (stat.isFile() || stat.isSymbolicLink()));\n  519:         });\n  520:     });"}, "source": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 502, "start_column": 22, "end_line": null, "end_column": 35, "snippet": "  497:         : Promise.reject();\n  498: }\n  499: function findGitWin32InPath() {\n  500:     return __awaiter(this, void 0, void 0, function* () {\n  501:         let dirs = (process.env['PATH'] || '').split(';');\n  502:         dirs.unshift(process.cwd());\n  503:         for (let i = 0; i < dirs.length; i++) {\n  504:             let file = path.join(dirs[i], 'git.exe');\n  505:             if (yield isExecutable(file)) {\n  506:                 try {\n  507:                     return yield getGitExecutable(file);"}, "path": [{"message": "process.cwd()", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 502, "start_column": 22, "end_line": null, "end_column": 35, "snippet": "  497:         : Promise.reject();\n  498: }\n  499: function findGitWin32InPath() {\n  500:     return __awaiter(this, void 0, void 0, function* () {\n  501:         let dirs = (process.env['PATH'] || '').split(';');\n  502:         dirs.unshift(process.cwd());\n  503:         for (let i = 0; i < dirs.length; i++) {\n  504:             let file = path.join(dirs[i], 'git.exe');\n  505:             if (yield isExecutable(file)) {\n  506:                 try {\n  507:                     return yield getGitExecutable(file);"}}, {"message": "dirs[i]", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 504, "start_column": 34, "end_line": null, "end_column": 41, "snippet": "  499: function findGitWin32InPath() {\n  500:     return __awaiter(this, void 0, void 0, function* () {\n  501:         let dirs = (process.env['PATH'] || '').split(';');\n  502:         dirs.unshift(process.cwd());\n  503:         for (let i = 0; i < dirs.length; i++) {\n  504:             let file = path.join(dirs[i], 'git.exe');\n  505:             if (yield isExecutable(file)) {\n  506:                 try {\n  507:                     return yield getGitExecutable(file);\n  508:                 }\n  509:                 catch (_) { }"}}, {"message": "path.jo ... t.exe')", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 504, "start_column": 24, "end_line": null, "end_column": 53, "snippet": "  499: function findGitWin32InPath() {\n  500:     return __awaiter(this, void 0, void 0, function* () {\n  501:         let dirs = (process.env['PATH'] || '').split(';');\n  502:         dirs.unshift(process.cwd());\n  503:         for (let i = 0; i < dirs.length; i++) {\n  504:             let file = path.join(dirs[i], 'git.exe');\n  505:             if (yield isExecutable(file)) {\n  506:                 try {\n  507:                     return yield getGitExecutable(file);\n  508:                 }\n  509:                 catch (_) { }"}}, {"message": "file", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 504, "start_column": 17, "end_line": null, "end_column": 53, "snippet": "  499: function findGitWin32InPath() {\n  500:     return __awaiter(this, void 0, void 0, function* () {\n  501:         let dirs = (process.env['PATH'] || '').split(';');\n  502:         dirs.unshift(process.cwd());\n  503:         for (let i = 0; i < dirs.length; i++) {\n  504:             let file = path.join(dirs[i], 'git.exe');\n  505:             if (yield isExecutable(file)) {\n  506:                 try {\n  507:                     return yield getGitExecutable(file);\n  508:                 }\n  509:                 catch (_) { }"}}, {"message": "file", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 505, "start_column": 36, "end_line": null, "end_column": 40, "snippet": "  500:     return __awaiter(this, void 0, void 0, function* () {\n  501:         let dirs = (process.env['PATH'] || '').split(';');\n  502:         dirs.unshift(process.cwd());\n  503:         for (let i = 0; i < dirs.length; i++) {\n  504:             let file = path.join(dirs[i], 'git.exe');\n  505:             if (yield isExecutable(file)) {\n  506:                 try {\n  507:                     return yield getGitExecutable(file);\n  508:                 }\n  509:                 catch (_) { }\n  510:             }"}}, {"message": "path", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 515, "start_column": 23, "end_line": null, "end_column": 27, "snippet": "  510:             }\n  511:         }\n  512:         return Promise.reject();\n  513:     });\n  514: }\n  515: function isExecutable(path) {\n  516:     return new Promise(resolve => {\n  517:         fs.stat(path, (err, stat) => {\n  518:             resolve(!err && (stat.isFile() || stat.isSymbolicLink()));\n  519:         });\n  520:     });"}}, {"message": "path", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 515, "start_column": 23, "end_line": null, "end_column": 27, "snippet": "  510:             }\n  511:         }\n  512:         return Promise.reject();\n  513:     });\n  514: }\n  515: function isExecutable(path) {\n  516:     return new Promise(resolve => {\n  517:         fs.stat(path, (err, stat) => {\n  518:             resolve(!err && (stat.isFile() || stat.isSymbolicLink()));\n  519:         });\n  520:     });"}}, {"message": "process.cwd()", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 502, "start_column": 22, "end_line": null, "end_column": 35, "snippet": "  497:         : Promise.reject();\n  498: }\n  499: function findGitWin32InPath() {\n  500:     return __awaiter(this, void 0, void 0, function* () {\n  501:         let dirs = (process.env['PATH'] || '').split(';');\n  502:         dirs.unshift(process.cwd());\n  503:         for (let i = 0; i < dirs.length; i++) {\n  504:             let file = path.join(dirs[i], 'git.exe');\n  505:             if (yield isExecutable(file)) {\n  506:                 try {\n  507:                     return yield getGitExecutable(file);"}}, {"message": "(proces ... it(';')", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 501, "start_column": 20, "end_line": null, "end_column": 58, "snippet": "  496:         ? getGitExecutable(path.join(pathBase, 'Git', 'cmd', 'git.exe'))\n  497:         : Promise.reject();\n  498: }\n  499: function findGitWin32InPath() {\n  500:     return __awaiter(this, void 0, void 0, function* () {\n  501:         let dirs = (process.env['PATH'] || '').split(';');\n  502:         dirs.unshift(process.cwd());\n  503:         for (let i = 0; i < dirs.length; i++) {\n  504:             let file = path.join(dirs[i], 'git.exe');\n  505:             if (yield isExecutable(file)) {\n  506:                 try {"}}, {"message": "dirs", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 501, "start_column": 13, "end_line": null, "end_column": 58, "snippet": "  496:         ? getGitExecutable(path.join(pathBase, 'Git', 'cmd', 'git.exe'))\n  497:         : Promise.reject();\n  498: }\n  499: function findGitWin32InPath() {\n  500:     return __awaiter(this, void 0, void 0, function* () {\n  501:         let dirs = (process.env['PATH'] || '').split(';');\n  502:         dirs.unshift(process.cwd());\n  503:         for (let i = 0; i < dirs.length; i++) {\n  504:             let file = path.join(dirs[i], 'git.exe');\n  505:             if (yield isExecutable(file)) {\n  506:                 try {"}}, {"message": "dirs", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 504, "start_column": 34, "end_line": null, "end_column": 38, "snippet": "  499: function findGitWin32InPath() {\n  500:     return __awaiter(this, void 0, void 0, function* () {\n  501:         let dirs = (process.env['PATH'] || '').split(';');\n  502:         dirs.unshift(process.cwd());\n  503:         for (let i = 0; i < dirs.length; i++) {\n  504:             let file = path.join(dirs[i], 'git.exe');\n  505:             if (yield isExecutable(file)) {\n  506:                 try {\n  507:                     return yield getGitExecutable(file);\n  508:                 }\n  509:                 catch (_) { }"}}, {"message": "dirs[i]", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 504, "start_column": 34, "end_line": null, "end_column": 41, "snippet": "  499: function findGitWin32InPath() {\n  500:     return __awaiter(this, void 0, void 0, function* () {\n  501:         let dirs = (process.env['PATH'] || '').split(';');\n  502:         dirs.unshift(process.cwd());\n  503:         for (let i = 0; i < dirs.length; i++) {\n  504:             let file = path.join(dirs[i], 'git.exe');\n  505:             if (yield isExecutable(file)) {\n  506:                 try {\n  507:                     return yield getGitExecutable(file);\n  508:                 }\n  509:                 catch (_) { }"}}, {"message": "path.jo ... t.exe')", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 504, "start_column": 24, "end_line": null, "end_column": 53, "snippet": "  499: function findGitWin32InPath() {\n  500:     return __awaiter(this, void 0, void 0, function* () {\n  501:         let dirs = (process.env['PATH'] || '').split(';');\n  502:         dirs.unshift(process.cwd());\n  503:         for (let i = 0; i < dirs.length; i++) {\n  504:             let file = path.join(dirs[i], 'git.exe');\n  505:             if (yield isExecutable(file)) {\n  506:                 try {\n  507:                     return yield getGitExecutable(file);\n  508:                 }\n  509:                 catch (_) { }"}}, {"message": "file", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 504, "start_column": 17, "end_line": null, "end_column": 53, "snippet": "  499: function findGitWin32InPath() {\n  500:     return __awaiter(this, void 0, void 0, function* () {\n  501:         let dirs = (process.env['PATH'] || '').split(';');\n  502:         dirs.unshift(process.cwd());\n  503:         for (let i = 0; i < dirs.length; i++) {\n  504:             let file = path.join(dirs[i], 'git.exe');\n  505:             if (yield isExecutable(file)) {\n  506:                 try {\n  507:                     return yield getGitExecutable(file);\n  508:                 }\n  509:                 catch (_) { }"}}, {"message": "file", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 505, "start_column": 36, "end_line": null, "end_column": 40, "snippet": "  500:     return __awaiter(this, void 0, void 0, function* () {\n  501:         let dirs = (process.env['PATH'] || '').split(';');\n  502:         dirs.unshift(process.cwd());\n  503:         for (let i = 0; i < dirs.length; i++) {\n  504:             let file = path.join(dirs[i], 'git.exe');\n  505:             if (yield isExecutable(file)) {\n  506:                 try {\n  507:                     return yield getGitExecutable(file);\n  508:                 }\n  509:                 catch (_) { }\n  510:             }"}}, {"message": "path", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 515, "start_column": 23, "end_line": null, "end_column": 27, "snippet": "  510:             }\n  511:         }\n  512:         return Promise.reject();\n  513:     });\n  514: }\n  515: function isExecutable(path) {\n  516:     return new Promise(resolve => {\n  517:         fs.stat(path, (err, stat) => {\n  518:             resolve(!err && (stat.isFile() || stat.isSymbolicLink()));\n  519:         });\n  520:     });"}}, {"message": "path", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 515, "start_column": 23, "end_line": null, "end_column": 27, "snippet": "  510:             }\n  511:         }\n  512:         return Promise.reject();\n  513:     });\n  514: }\n  515: function isExecutable(path) {\n  516:     return new Promise(resolve => {\n  517:         fs.stat(path, (err, stat) => {\n  518:             resolve(!err && (stat.isFile() || stat.isSymbolicLink()));\n  519:         });\n  520:     });"}}]}
{"result_index": 4, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 522, "start_column": 27, "end_line": null, "end_column": 31, "snippet": "  517:         fs.stat(path, (err, stat) => {\n  518:             resolve(!err && (stat.isFile() || stat.isSymbolicLink()));\n  519:         });\n  520:     });\n  521: }\n  522: function getGitExecutable(path) {\n  523:     return new Promise((resolve, reject) => {\n  524:         resolveSpawnOutput(cp.spawn(path, ['--version'])).then((values) => {\n  525:             if (values[0].code === 0) {\n  526:                 resolve({ path: path, version: values[1].toString().trim().replace(/^git version /, '') });\n  527:             }"}, "source": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 502, "start_column": 22, "end_line": null, "end_column": 35, "snippet": "  497:         : Promise.reject();\n  498: }\n  499: function findGitWin32InPath() {\n  500:     return __awaiter(this, void 0, void 0, function* () {\n  501:         let dirs = (process.env['PATH'] || '').split(';');\n  502:         dirs.unshift(process.cwd());\n  503:         for (let i = 0; i < dirs.length; i++) {\n  504:             let file = path.join(dirs[i], 'git.exe');\n  505:             if (yield isExecutable(file)) {\n  506:                 try {\n  507:                     return yield getGitExecutable(file);"}, "path": [{"message": "process.cwd()", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 502, "start_column": 22, "end_line": null, "end_column": 35, "snippet": "  497:         : Promise.reject();\n  498: }\n  499: function findGitWin32InPath() {\n  500:     return __awaiter(this, void 0, void 0, function* () {\n  501:         let dirs = (process.env['PATH'] || '').split(';');\n  502:         dirs.unshift(process.cwd());\n  503:         for (let i = 0; i < dirs.length; i++) {\n  504:             let file = path.join(dirs[i], 'git.exe');\n  505:             if (yield isExecutable(file)) {\n  506:                 try {\n  507:                     return yield getGitExecutable(file);"}}, {"message": "dirs[i]", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 504, "start_column": 34, "end_line": null, "end_column": 41, "snippet": "  499: function findGitWin32InPath() {\n  500:     return __awaiter(this, void 0, void 0, function* () {\n  501:         let dirs = (process.env['PATH'] || '').split(';');\n  502:         dirs.unshift(process.cwd());\n  503:         for (let i = 0; i < dirs.length; i++) {\n  504:             let file = path.join(dirs[i], 'git.exe');\n  505:             if (yield isExecutable(file)) {\n  506:                 try {\n  507:                     return yield getGitExecutable(file);\n  508:                 }\n  509:                 catch (_) { }"}}, {"message": "path.jo ... t.exe')", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 504, "start_column": 24, "end_line": null, "end_column": 53, "snippet": "  499: function findGitWin32InPath() {\n  500:     return __awaiter(this, void 0, void 0, function* () {\n  501:         let dirs = (process.env['PATH'] || '').split(';');\n  502:         dirs.unshift(process.cwd());\n  503:         for (let i = 0; i < dirs.length; i++) {\n  504:             let file = path.join(dirs[i], 'git.exe');\n  505:             if (yield isExecutable(file)) {\n  506:                 try {\n  507:                     return yield getGitExecutable(file);\n  508:                 }\n  509:                 catch (_) { }"}}, {"message": "file", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 504, "start_column": 17, "end_line": null, "end_column": 53, "snippet": "  499: function findGitWin32InPath() {\n  500:     return __awaiter(this, void 0, void 0, function* () {\n  501:         let dirs = (process.env['PATH'] || '').split(';');\n  502:         dirs.unshift(process.cwd());\n  503:         for (let i = 0; i < dirs.length; i++) {\n  504:             let file = path.join(dirs[i], 'git.exe');\n  505:             if (yield isExecutable(file)) {\n  506:                 try {\n  507:                     return yield getGitExecutable(file);\n  508:                 }\n  509:                 catch (_) { }"}}, {"message": "file", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 507, "start_column": 51, "end_line": null, "end_column": 55, "snippet": "  502:         dirs.unshift(process.cwd());\n  503:         for (let i = 0; i < dirs.length; i++) {\n  504:             let file = path.join(dirs[i], 'git.exe');\n  505:             if (yield isExecutable(file)) {\n  506:                 try {\n  507:                     return yield getGitExecutable(file);\n  508:                 }\n  509:                 catch (_) { }\n  510:             }\n  511:         }\n  512:         return Promise.reject();"}}, {"message": "path", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 522, "start_column": 27, "end_line": null, "end_column": 31, "snippet": "  517:         fs.stat(path, (err, stat) => {\n  518:             resolve(!err && (stat.isFile() || stat.isSymbolicLink()));\n  519:         });\n  520:     });\n  521: }\n  522: function getGitExecutable(path) {\n  523:     return new Promise((resolve, reject) => {\n  524:         resolveSpawnOutput(cp.spawn(path, ['--version'])).then((values) => {\n  525:             if (values[0].code === 0) {\n  526:                 resolve({ path: path, version: values[1].toString().trim().replace(/^git version /, '') });\n  527:             }"}}, {"message": "path", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 522, "start_column": 27, "end_line": null, "end_column": 31, "snippet": "  517:         fs.stat(path, (err, stat) => {\n  518:             resolve(!err && (stat.isFile() || stat.isSymbolicLink()));\n  519:         });\n  520:     });\n  521: }\n  522: function getGitExecutable(path) {\n  523:     return new Promise((resolve, reject) => {\n  524:         resolveSpawnOutput(cp.spawn(path, ['--version'])).then((values) => {\n  525:             if (values[0].code === 0) {\n  526:                 resolve({ path: path, version: values[1].toString().trim().replace(/^git version /, '') });\n  527:             }"}}, {"message": "process.cwd()", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 502, "start_column": 22, "end_line": null, "end_column": 35, "snippet": "  497:         : Promise.reject();\n  498: }\n  499: function findGitWin32InPath() {\n  500:     return __awaiter(this, void 0, void 0, function* () {\n  501:         let dirs = (process.env['PATH'] || '').split(';');\n  502:         dirs.unshift(process.cwd());\n  503:         for (let i = 0; i < dirs.length; i++) {\n  504:             let file = path.join(dirs[i], 'git.exe');\n  505:             if (yield isExecutable(file)) {\n  506:                 try {\n  507:                     return yield getGitExecutable(file);"}}, {"message": "(proces ... it(';')", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 501, "start_column": 20, "end_line": null, "end_column": 58, "snippet": "  496:         ? getGitExecutable(path.join(pathBase, 'Git', 'cmd', 'git.exe'))\n  497:         : Promise.reject();\n  498: }\n  499: function findGitWin32InPath() {\n  500:     return __awaiter(this, void 0, void 0, function* () {\n  501:         let dirs = (process.env['PATH'] || '').split(';');\n  502:         dirs.unshift(process.cwd());\n  503:         for (let i = 0; i < dirs.length; i++) {\n  504:             let file = path.join(dirs[i], 'git.exe');\n  505:             if (yield isExecutable(file)) {\n  506:                 try {"}}, {"message": "dirs", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 501, "start_column": 13, "end_line": null, "end_column": 58, "snippet": "  496:         ? getGitExecutable(path.join(pathBase, 'Git', 'cmd', 'git.exe'))\n  497:         : Promise.reject();\n  498: }\n  499: function findGitWin32InPath() {\n  500:     return __awaiter(this, void 0, void 0, function* () {\n  501:         let dirs = (process.env['PATH'] || '').split(';');\n  502:         dirs.unshift(process.cwd());\n  503:         for (let i = 0; i < dirs.length; i++) {\n  504:             let file = path.join(dirs[i], 'git.exe');\n  505:             if (yield isExecutable(file)) {\n  506:                 try {"}}, {"message": "dirs", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 504, "start_column": 34, "end_line": null, "end_column": 38, "snippet": "  499: function findGitWin32InPath() {\n  500:     return __awaiter(this, void 0, void 0, function* () {\n  501:         let dirs = (process.env['PATH'] || '').split(';');\n  502:         dirs.unshift(process.cwd());\n  503:         for (let i = 0; i < dirs.length; i++) {\n  504:             let file = path.join(dirs[i], 'git.exe');\n  505:             if (yield isExecutable(file)) {\n  506:                 try {\n  507:                     return yield getGitExecutable(file);\n  508:                 }\n  509:                 catch (_) { }"}}, {"message": "dirs[i]", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 504, "start_column": 34, "end_line": null, "end_column": 41, "snippet": "  499: function findGitWin32InPath() {\n  500:     return __awaiter(this, void 0, void 0, function* () {\n  501:         let dirs = (process.env['PATH'] || '').split(';');\n  502:         dirs.unshift(process.cwd());\n  503:         for (let i = 0; i < dirs.length; i++) {\n  504:             let file = path.join(dirs[i], 'git.exe');\n  505:             if (yield isExecutable(file)) {\n  506:                 try {\n  507:                     return yield getGitExecutable(file);\n  508:                 }\n  509:                 catch (_) { }"}}, {"message": "path.jo ... t.exe')", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 504, "start_column": 24, "end_line": null, "end_column": 53, "snippet": "  499: function findGitWin32InPath() {\n  500:     return __awaiter(this, void 0, void 0, function* () {\n  501:         let dirs = (process.env['PATH'] || '').split(';');\n  502:         dirs.unshift(process.cwd());\n  503:         for (let i = 0; i < dirs.length; i++) {\n  504:             let file = path.join(dirs[i], 'git.exe');\n  505:             if (yield isExecutable(file)) {\n  506:                 try {\n  507:                     return yield getGitExecutable(file);\n  508:                 }\n  509:                 catch (_) { }"}}, {"message": "file", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 504, "start_column": 17, "end_line": null, "end_column": 53, "snippet": "  499: function findGitWin32InPath() {\n  500:     return __awaiter(this, void 0, void 0, function* () {\n  501:         let dirs = (process.env['PATH'] || '').split(';');\n  502:         dirs.unshift(process.cwd());\n  503:         for (let i = 0; i < dirs.length; i++) {\n  504:             let file = path.join(dirs[i], 'git.exe');\n  505:             if (yield isExecutable(file)) {\n  506:                 try {\n  507:                     return yield getGitExecutable(file);\n  508:                 }\n  509:                 catch (_) { }"}}, {"message": "file", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 507, "start_column": 51, "end_line": null, "end_column": 55, "snippet": "  502:         dirs.unshift(process.cwd());\n  503:         for (let i = 0; i < dirs.length; i++) {\n  504:             let file = path.join(dirs[i], 'git.exe');\n  505:             if (yield isExecutable(file)) {\n  506:                 try {\n  507:                     return yield getGitExecutable(file);\n  508:                 }\n  509:                 catch (_) { }\n  510:             }\n  511:         }\n  512:         return Promise.reject();"}}, {"message": "path", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 522, "start_column": 27, "end_line": null, "end_column": 31, "snippet": "  517:         fs.stat(path, (err, stat) => {\n  518:             resolve(!err && (stat.isFile() || stat.isSymbolicLink()));\n  519:         });\n  520:     });\n  521: }\n  522: function getGitExecutable(path) {\n  523:     return new Promise((resolve, reject) => {\n  524:         resolveSpawnOutput(cp.spawn(path, ['--version'])).then((values) => {\n  525:             if (values[0].code === 0) {\n  526:                 resolve({ path: path, version: values[1].toString().trim().replace(/^git version /, '') });\n  527:             }"}}, {"message": "path", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 522, "start_column": 27, "end_line": null, "end_column": 31, "snippet": "  517:         fs.stat(path, (err, stat) => {\n  518:             resolve(!err && (stat.isFile() || stat.isSymbolicLink()));\n  519:         });\n  520:     });\n  521: }\n  522: function getGitExecutable(path) {\n  523:     return new Promise((resolve, reject) => {\n  524:         resolveSpawnOutput(cp.spawn(path, ['--version'])).then((values) => {\n  525:             if (values[0].code === 0) {\n  526:                 resolve({ path: path, version: values[1].toString().trim().replace(/^git version /, '') });\n  527:             }"}}]}
{"result_index": 0, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.\n(Experimental) This shell command depends on [an uncontrolled value](2). Identified using machine learning.\n(Experimental) This shell command depends on [an uncontrolled value](3). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/download.js", "start_line": 63, "start_column": 41, "end_line": null, "end_column": 57, "snippet": "   58:             }\n   59:             return resolve(res);\n   60:         });\n   61:     });\n   62: }\n   63: function go(flavor, platform, fileName, installDirectory, fileManager, log, proxy, strictSSL) {\n   64:     return new Promise((resolve, reject) => {\n   65:         // log = log || ((_ )=> { });\n   66:         let logger = logger_1.Logger.getLogger('ADL (Storage)');\n   67:         installDirectory = installDirectory || extension_1.getInstallDirectory(flavor);\n   68:         fileManager = fileManager;"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 1910, "start_column": 32, "end_line": null, "end_column": 41, "snippet": " 1905:     shutdownLanguageService();\n 1906:     shutdownDataLakeService();\n 1907: }\n 1908: exports.deactivate = deactivate;\n 1909: function getInstallDirectory(flavor) {\n 1910:     const basePath = path.join(__dirname, '..', '..', 'scopecompiler');\n 1911:     console.log(basePath);\n 1912:     switch (flavor) {\n 1913:         case platform_1.Flavor.CoreCLR:\n 1914:             return basePath + '-coreclr';\n 1915:         case platform_1.Flavor.Desktop:"}, "path": [{"message": "__dirname", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 1910, "start_column": 32, "end_line": null, "end_column": 41, "snippet": " 1905:     shutdownLanguageService();\n 1906:     shutdownDataLakeService();\n 1907: }\n 1908: exports.deactivate = deactivate;\n 1909: function getInstallDirectory(flavor) {\n 1910:     const basePath = path.join(__dirname, '..', '..', 'scopecompiler');\n 1911:     console.log(basePath);\n 1912:     switch (flavor) {\n 1913:         case platform_1.Flavor.CoreCLR:\n 1914:             return basePath + '-coreclr';\n 1915:         case platform_1.Flavor.Desktop:"}}, {"message": "path.jo ... piler')", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 1910, "start_column": 22, "end_line": null, "end_column": 71, "snippet": " 1905:     shutdownLanguageService();\n 1906:     shutdownDataLakeService();\n 1907: }\n 1908: exports.deactivate = deactivate;\n 1909: function getInstallDirectory(flavor) {\n 1910:     const basePath = path.join(__dirname, '..', '..', 'scopecompiler');\n 1911:     console.log(basePath);\n 1912:     switch (flavor) {\n 1913:         case platform_1.Flavor.CoreCLR:\n 1914:             return basePath + '-coreclr';\n 1915:         case platform_1.Flavor.Desktop:"}}, {"message": "basePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 1910, "start_column": 11, "end_line": null, "end_column": 71, "snippet": " 1905:     shutdownLanguageService();\n 1906:     shutdownDataLakeService();\n 1907: }\n 1908: exports.deactivate = deactivate;\n 1909: function getInstallDirectory(flavor) {\n 1910:     const basePath = path.join(__dirname, '..', '..', 'scopecompiler');\n 1911:     console.log(basePath);\n 1912:     switch (flavor) {\n 1913:         case platform_1.Flavor.CoreCLR:\n 1914:             return basePath + '-coreclr';\n 1915:         case platform_1.Flavor.Desktop:"}}, {"message": "basePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 1914, "start_column": 20, "end_line": null, "end_column": 28, "snippet": " 1909: function getInstallDirectory(flavor) {\n 1910:     const basePath = path.join(__dirname, '..', '..', 'scopecompiler');\n 1911:     console.log(basePath);\n 1912:     switch (flavor) {\n 1913:         case platform_1.Flavor.CoreCLR:\n 1914:             return basePath + '-coreclr';\n 1915:         case platform_1.Flavor.Desktop:\n 1916:             return basePath + '-desktop';\n 1917:         case platform_1.Flavor.Mono:\n 1918:             return basePath + '-mono';\n 1919:         default:"}}, {"message": "basePat ... oreclr'", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 1914, "start_column": 20, "end_line": null, "end_column": 41, "snippet": " 1909: function getInstallDirectory(flavor) {\n 1910:     const basePath = path.join(__dirname, '..', '..', 'scopecompiler');\n 1911:     console.log(basePath);\n 1912:     switch (flavor) {\n 1913:         case platform_1.Flavor.CoreCLR:\n 1914:             return basePath + '-coreclr';\n 1915:         case platform_1.Flavor.Desktop:\n 1916:             return basePath + '-desktop';\n 1917:         case platform_1.Flavor.Mono:\n 1918:             return basePath + '-mono';\n 1919:         default:"}}, {"message": "extensi ... flavor)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/download.js", "start_line": 67, "start_column": 48, "end_line": null, "end_column": 87, "snippet": "   62: }\n   63: function go(flavor, platform, fileName, installDirectory, fileManager, log, proxy, strictSSL) {\n   64:     return new Promise((resolve, reject) => {\n   65:         // log = log || ((_ )=> { });\n   66:         let logger = logger_1.Logger.getLogger('ADL (Storage)');\n   67:         installDirectory = installDirectory || extension_1.getInstallDirectory(flavor);\n   68:         fileManager = fileManager;\n   69:         console.log(`Flavor: ${flavor}, Platform: ${platform}`);\n   70:         console.log(`[INFO] Installing ${fileName} to ${installDirectory}`);\n   71:         logger.log(`Installing ${fileName} to ${installDirectory}`);\n   72:         const urlString = fileManager.getDownloadUrl(fileName);"}}, {"message": "install ... flavor)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/download.js", "start_line": 67, "start_column": 28, "end_line": null, "end_column": 87, "snippet": "   62: }\n   63: function go(flavor, platform, fileName, installDirectory, fileManager, log, proxy, strictSSL) {\n   64:     return new Promise((resolve, reject) => {\n   65:         // log = log || ((_ )=> { });\n   66:         let logger = logger_1.Logger.getLogger('ADL (Storage)');\n   67:         installDirectory = installDirectory || extension_1.getInstallDirectory(flavor);\n   68:         fileManager = fileManager;\n   69:         console.log(`Flavor: ${flavor}, Platform: ${platform}`);\n   70:         console.log(`[INFO] Installing ${fileName} to ${installDirectory}`);\n   71:         logger.log(`Installing ${fileName} to ${installDirectory}`);\n   72:         const urlString = fileManager.getDownloadUrl(fileName);"}}, {"message": "installDirectory", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/download.js", "start_line": 67, "start_column": 9, "end_line": null, "end_column": 87, "snippet": "   62: }\n   63: function go(flavor, platform, fileName, installDirectory, fileManager, log, proxy, strictSSL) {\n   64:     return new Promise((resolve, reject) => {\n   65:         // log = log || ((_ )=> { });\n   66:         let logger = logger_1.Logger.getLogger('ADL (Storage)');\n   67:         installDirectory = installDirectory || extension_1.getInstallDirectory(flavor);\n   68:         fileManager = fileManager;\n   69:         console.log(`Flavor: ${flavor}, Platform: ${platform}`);\n   70:         console.log(`[INFO] Installing ${fileName} to ${installDirectory}`);\n   71:         logger.log(`Installing ${fileName} to ${installDirectory}`);\n   72:         const urlString = fileManager.getDownloadUrl(fileName);"}}, {"message": "installDirectory", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/download.js", "start_line": 63, "start_column": 41, "end_line": null, "end_column": 57, "snippet": "   58:             }\n   59:             return resolve(res);\n   60:         });\n   61:     });\n   62: }\n   63: function go(flavor, platform, fileName, installDirectory, fileManager, log, proxy, strictSSL) {\n   64:     return new Promise((resolve, reject) => {\n   65:         // log = log || ((_ )=> { });\n   66:         let logger = logger_1.Logger.getLogger('ADL (Storage)');\n   67:         installDirectory = installDirectory || extension_1.getInstallDirectory(flavor);\n   68:         fileManager = fileManager;"}}, {"message": "__dirname", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 1910, "start_column": 32, "end_line": null, "end_column": 41, "snippet": " 1905:     shutdownLanguageService();\n 1906:     shutdownDataLakeService();\n 1907: }\n 1908: exports.deactivate = deactivate;\n 1909: function getInstallDirectory(flavor) {\n 1910:     const basePath = path.join(__dirname, '..', '..', 'scopecompiler');\n 1911:     console.log(basePath);\n 1912:     switch (flavor) {\n 1913:         case platform_1.Flavor.CoreCLR:\n 1914:             return basePath + '-coreclr';\n 1915:         case platform_1.Flavor.Desktop:"}}, {"message": "path.jo ... piler')", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 1910, "start_column": 22, "end_line": null, "end_column": 71, "snippet": " 1905:     shutdownLanguageService();\n 1906:     shutdownDataLakeService();\n 1907: }\n 1908: exports.deactivate = deactivate;\n 1909: function getInstallDirectory(flavor) {\n 1910:     const basePath = path.join(__dirname, '..', '..', 'scopecompiler');\n 1911:     console.log(basePath);\n 1912:     switch (flavor) {\n 1913:         case platform_1.Flavor.CoreCLR:\n 1914:             return basePath + '-coreclr';\n 1915:         case platform_1.Flavor.Desktop:"}}, {"message": "basePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 1910, "start_column": 11, "end_line": null, "end_column": 71, "snippet": " 1905:     shutdownLanguageService();\n 1906:     shutdownDataLakeService();\n 1907: }\n 1908: exports.deactivate = deactivate;\n 1909: function getInstallDirectory(flavor) {\n 1910:     const basePath = path.join(__dirname, '..', '..', 'scopecompiler');\n 1911:     console.log(basePath);\n 1912:     switch (flavor) {\n 1913:         case platform_1.Flavor.CoreCLR:\n 1914:             return basePath + '-coreclr';\n 1915:         case platform_1.Flavor.Desktop:"}}, {"message": "basePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 1916, "start_column": 20, "end_line": null, "end_column": 28, "snippet": " 1911:     console.log(basePath);\n 1912:     switch (flavor) {\n 1913:         case platform_1.Flavor.CoreCLR:\n 1914:             return basePath + '-coreclr';\n 1915:         case platform_1.Flavor.Desktop:\n 1916:             return basePath + '-desktop';\n 1917:         case platform_1.Flavor.Mono:\n 1918:             return basePath + '-mono';\n 1919:         default:\n 1920:             throw new Error(`Unexpected flavor specified: ${flavor}`);\n 1921:     }"}}, {"message": "basePat ... esktop'", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 1916, "start_column": 20, "end_line": null, "end_column": 41, "snippet": " 1911:     console.log(basePath);\n 1912:     switch (flavor) {\n 1913:         case platform_1.Flavor.CoreCLR:\n 1914:             return basePath + '-coreclr';\n 1915:         case platform_1.Flavor.Desktop:\n 1916:             return basePath + '-desktop';\n 1917:         case platform_1.Flavor.Mono:\n 1918:             return basePath + '-mono';\n 1919:         default:\n 1920:             throw new Error(`Unexpected flavor specified: ${flavor}`);\n 1921:     }"}}, {"message": "extensi ... flavor)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/download.js", "start_line": 67, "start_column": 48, "end_line": null, "end_column": 87, "snippet": "   62: }\n   63: function go(flavor, platform, fileName, installDirectory, fileManager, log, proxy, strictSSL) {\n   64:     return new Promise((resolve, reject) => {\n   65:         // log = log || ((_ )=> { });\n   66:         let logger = logger_1.Logger.getLogger('ADL (Storage)');\n   67:         installDirectory = installDirectory || extension_1.getInstallDirectory(flavor);\n   68:         fileManager = fileManager;\n   69:         console.log(`Flavor: ${flavor}, Platform: ${platform}`);\n   70:         console.log(`[INFO] Installing ${fileName} to ${installDirectory}`);\n   71:         logger.log(`Installing ${fileName} to ${installDirectory}`);\n   72:         const urlString = fileManager.getDownloadUrl(fileName);"}}, {"message": "install ... flavor)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/download.js", "start_line": 67, "start_column": 28, "end_line": null, "end_column": 87, "snippet": "   62: }\n   63: function go(flavor, platform, fileName, installDirectory, fileManager, log, proxy, strictSSL) {\n   64:     return new Promise((resolve, reject) => {\n   65:         // log = log || ((_ )=> { });\n   66:         let logger = logger_1.Logger.getLogger('ADL (Storage)');\n   67:         installDirectory = installDirectory || extension_1.getInstallDirectory(flavor);\n   68:         fileManager = fileManager;\n   69:         console.log(`Flavor: ${flavor}, Platform: ${platform}`);\n   70:         console.log(`[INFO] Installing ${fileName} to ${installDirectory}`);\n   71:         logger.log(`Installing ${fileName} to ${installDirectory}`);\n   72:         const urlString = fileManager.getDownloadUrl(fileName);"}}, {"message": "installDirectory", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/download.js", "start_line": 67, "start_column": 9, "end_line": null, "end_column": 87, "snippet": "   62: }\n   63: function go(flavor, platform, fileName, installDirectory, fileManager, log, proxy, strictSSL) {\n   64:     return new Promise((resolve, reject) => {\n   65:         // log = log || ((_ )=> { });\n   66:         let logger = logger_1.Logger.getLogger('ADL (Storage)');\n   67:         installDirectory = installDirectory || extension_1.getInstallDirectory(flavor);\n   68:         fileManager = fileManager;\n   69:         console.log(`Flavor: ${flavor}, Platform: ${platform}`);\n   70:         console.log(`[INFO] Installing ${fileName} to ${installDirectory}`);\n   71:         logger.log(`Installing ${fileName} to ${installDirectory}`);\n   72:         const urlString = fileManager.getDownloadUrl(fileName);"}}, {"message": "installDirectory", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/download.js", "start_line": 63, "start_column": 41, "end_line": null, "end_column": 57, "snippet": "   58:             }\n   59:             return resolve(res);\n   60:         });\n   61:     });\n   62: }\n   63: function go(flavor, platform, fileName, installDirectory, fileManager, log, proxy, strictSSL) {\n   64:     return new Promise((resolve, reject) => {\n   65:         // log = log || ((_ )=> { });\n   66:         let logger = logger_1.Logger.getLogger('ADL (Storage)');\n   67:         installDirectory = installDirectory || extension_1.getInstallDirectory(flavor);\n   68:         fileManager = fileManager;"}}, {"message": "__dirname", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/fileManager.js", "start_line": 71, "start_column": 30, "end_line": null, "end_column": 39, "snippet": "   66:     getInstallDirectory(fileId) {\n   67:         var fileItem = this.fileList.find(t => t.FileId == fileId);\n   68:         if (fileItem.Runtime != \"\") {\n   69:             // Append runtime to installation directory\n   70:             var directory = fileItem.FileId + (platform.getFlavoredVersion() == platform.Flavor.Mono ? \"-mono\" : \"-desktop\");\n   71:             return path.join(__dirname, '..', '..', directory);\n   72:         }\n   73:         else {\n   74:             return path.join(__dirname, '..', '..', fileItem.FileId);\n   75:         }\n   76:     }"}}, {"message": "path.jo ... ectory)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/fileManager.js", "start_line": 71, "start_column": 20, "end_line": null, "end_column": 63, "snippet": "   66:     getInstallDirectory(fileId) {\n   67:         var fileItem = this.fileList.find(t => t.FileId == fileId);\n   68:         if (fileItem.Runtime != \"\") {\n   69:             // Append runtime to installation directory\n   70:             var directory = fileItem.FileId + (platform.getFlavoredVersion() == platform.Flavor.Mono ? \"-mono\" : \"-desktop\");\n   71:             return path.join(__dirname, '..', '..', directory);\n   72:         }\n   73:         else {\n   74:             return path.join(__dirname, '..', '..', fileItem.FileId);\n   75:         }\n   76:     }"}}, {"message": "_fileMa ... FileId)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 1931, "start_column": 153, "end_line": null, "end_column": 202, "snippet": " 1926:         if (fs.existsSync(path.join(_fileManager.getInstallDirectory(_dataLakeFileId), _dataLakeExecutableName))) {\n 1927:             _fileManager.completeCheckDependency(_fileManager.getFileNamebyId(_dataLakeFileId));\n 1928:             return (resolve());\n 1929:         }\n 1930:         else {\n 1931:             return resolve(download.go(platform_1.getFlavoredVersion(), platform_1.getCurrentPlatform(), _fileManager.getFileNamebyId(_dataLakeFileId), _fileManager.getInstallDirectory(_dataLakeFileId), _fileManager, null, _proxySetting));\n 1932:         }\n 1933:     });\n 1934: }\n 1935: function resolveLanguageServicePackages() {\n 1936:     return new Promise((resolve, reject) => {"}}, {"message": "installDirectory", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/download.js", "start_line": 63, "start_column": 41, "end_line": null, "end_column": 57, "snippet": "   58:             }\n   59:             return resolve(res);\n   60:         });\n   61:     });\n   62: }\n   63: function go(flavor, platform, fileName, installDirectory, fileManager, log, proxy, strictSSL) {\n   64:     return new Promise((resolve, reject) => {\n   65:         // log = log || ((_ )=> { });\n   66:         let logger = logger_1.Logger.getLogger('ADL (Storage)');\n   67:         installDirectory = installDirectory || extension_1.getInstallDirectory(flavor);\n   68:         fileManager = fileManager;"}}, {"message": "installDirectory", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/download.js", "start_line": 63, "start_column": 41, "end_line": null, "end_column": 57, "snippet": "   58:             }\n   59:             return resolve(res);\n   60:         });\n   61:     });\n   62: }\n   63: function go(flavor, platform, fileName, installDirectory, fileManager, log, proxy, strictSSL) {\n   64:     return new Promise((resolve, reject) => {\n   65:         // log = log || ((_ )=> { });\n   66:         let logger = logger_1.Logger.getLogger('ADL (Storage)');\n   67:         installDirectory = installDirectory || extension_1.getInstallDirectory(flavor);\n   68:         fileManager = fileManager;"}}, {"message": "__dirname", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/fileManager.js", "start_line": 74, "start_column": 30, "end_line": null, "end_column": 39, "snippet": "   69:             // Append runtime to installation directory\n   70:             var directory = fileItem.FileId + (platform.getFlavoredVersion() == platform.Flavor.Mono ? \"-mono\" : \"-desktop\");\n   71:             return path.join(__dirname, '..', '..', directory);\n   72:         }\n   73:         else {\n   74:             return path.join(__dirname, '..', '..', fileItem.FileId);\n   75:         }\n   76:     }\n   77:     isAllDependencyFulfilled() {\n   78:         this.fileList.forEach(element => {\n   79:             var fileName = path.join(this.getInstallDirectory(element.FileId), element.ExecutableFileName);"}}, {"message": "path.jo ... FileId)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/fileManager.js", "start_line": 74, "start_column": 20, "end_line": null, "end_column": 69, "snippet": "   69:             // Append runtime to installation directory\n   70:             var directory = fileItem.FileId + (platform.getFlavoredVersion() == platform.Flavor.Mono ? \"-mono\" : \"-desktop\");\n   71:             return path.join(__dirname, '..', '..', directory);\n   72:         }\n   73:         else {\n   74:             return path.join(__dirname, '..', '..', fileItem.FileId);\n   75:         }\n   76:     }\n   77:     isAllDependencyFulfilled() {\n   78:         this.fileList.forEach(element => {\n   79:             var fileName = path.join(this.getInstallDirectory(element.FileId), element.ExecutableFileName);"}}, {"message": "_fileMa ... FileId)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 1931, "start_column": 153, "end_line": null, "end_column": 202, "snippet": " 1926:         if (fs.existsSync(path.join(_fileManager.getInstallDirectory(_dataLakeFileId), _dataLakeExecutableName))) {\n 1927:             _fileManager.completeCheckDependency(_fileManager.getFileNamebyId(_dataLakeFileId));\n 1928:             return (resolve());\n 1929:         }\n 1930:         else {\n 1931:             return resolve(download.go(platform_1.getFlavoredVersion(), platform_1.getCurrentPlatform(), _fileManager.getFileNamebyId(_dataLakeFileId), _fileManager.getInstallDirectory(_dataLakeFileId), _fileManager, null, _proxySetting));\n 1932:         }\n 1933:     });\n 1934: }\n 1935: function resolveLanguageServicePackages() {\n 1936:     return new Promise((resolve, reject) => {"}}, {"message": "installDirectory", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/download.js", "start_line": 63, "start_column": 41, "end_line": null, "end_column": 57, "snippet": "   58:             }\n   59:             return resolve(res);\n   60:         });\n   61:     });\n   62: }\n   63: function go(flavor, platform, fileName, installDirectory, fileManager, log, proxy, strictSSL) {\n   64:     return new Promise((resolve, reject) => {\n   65:         // log = log || ((_ )=> { });\n   66:         let logger = logger_1.Logger.getLogger('ADL (Storage)');\n   67:         installDirectory = installDirectory || extension_1.getInstallDirectory(flavor);\n   68:         fileManager = fileManager;"}}, {"message": "installDirectory", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/download.js", "start_line": 63, "start_column": 41, "end_line": null, "end_column": 57, "snippet": "   58:             }\n   59:             return resolve(res);\n   60:         });\n   61:     });\n   62: }\n   63: function go(flavor, platform, fileName, installDirectory, fileManager, log, proxy, strictSSL) {\n   64:     return new Promise((resolve, reject) => {\n   65:         // log = log || ((_ )=> { });\n   66:         let logger = logger_1.Logger.getLogger('ADL (Storage)');\n   67:         installDirectory = installDirectory || extension_1.getInstallDirectory(flavor);\n   68:         fileManager = fileManager;"}}]}
{"result_index": 1, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.\n(Experimental) This shell command depends on [an uncontrolled value](2). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 250, "start_column": 11, "end_line": null, "end_column": 17, "snippet": "  245:         charset: 'alphabetic',\n  246:         length: 12,\n  247:     });\n  248:     _dataLakeRuntimeFolder = path.join(tempFolder, folder);\n  249:     fs.mkdirSync(_dataLakeRuntimeFolder);\n  250:     const source = _fileManager.getInstallDirectory(_dataLakeFileId);\n  251:     const copyFileList = fs.readdirSync(source);\n  252:     const promises = copyFileList.map((file) => {\n  253:         return fspromise.writeFileAsync(path.join(_dataLakeRuntimeFolder, file), fspromise.readFileSync(path.join(source, file)));\n  254:     });\n  255:     // fs.readdirSync(source).forEach(file => {"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/fileManager.js", "start_line": 71, "start_column": 30, "end_line": null, "end_column": 39, "snippet": "   66:     getInstallDirectory(fileId) {\n   67:         var fileItem = this.fileList.find(t => t.FileId == fileId);\n   68:         if (fileItem.Runtime != \"\") {\n   69:             // Append runtime to installation directory\n   70:             var directory = fileItem.FileId + (platform.getFlavoredVersion() == platform.Flavor.Mono ? \"-mono\" : \"-desktop\");\n   71:             return path.join(__dirname, '..', '..', directory);\n   72:         }\n   73:         else {\n   74:             return path.join(__dirname, '..', '..', fileItem.FileId);\n   75:         }\n   76:     }"}, "path": [{"message": "__dirname", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/fileManager.js", "start_line": 71, "start_column": 30, "end_line": null, "end_column": 39, "snippet": "   66:     getInstallDirectory(fileId) {\n   67:         var fileItem = this.fileList.find(t => t.FileId == fileId);\n   68:         if (fileItem.Runtime != \"\") {\n   69:             // Append runtime to installation directory\n   70:             var directory = fileItem.FileId + (platform.getFlavoredVersion() == platform.Flavor.Mono ? \"-mono\" : \"-desktop\");\n   71:             return path.join(__dirname, '..', '..', directory);\n   72:         }\n   73:         else {\n   74:             return path.join(__dirname, '..', '..', fileItem.FileId);\n   75:         }\n   76:     }"}}, {"message": "path.jo ... ectory)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/fileManager.js", "start_line": 71, "start_column": 20, "end_line": null, "end_column": 63, "snippet": "   66:     getInstallDirectory(fileId) {\n   67:         var fileItem = this.fileList.find(t => t.FileId == fileId);\n   68:         if (fileItem.Runtime != \"\") {\n   69:             // Append runtime to installation directory\n   70:             var directory = fileItem.FileId + (platform.getFlavoredVersion() == platform.Flavor.Mono ? \"-mono\" : \"-desktop\");\n   71:             return path.join(__dirname, '..', '..', directory);\n   72:         }\n   73:         else {\n   74:             return path.join(__dirname, '..', '..', fileItem.FileId);\n   75:         }\n   76:     }"}}, {"message": "_fileMa ... FileId)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 250, "start_column": 20, "end_line": null, "end_column": 69, "snippet": "  245:         charset: 'alphabetic',\n  246:         length: 12,\n  247:     });\n  248:     _dataLakeRuntimeFolder = path.join(tempFolder, folder);\n  249:     fs.mkdirSync(_dataLakeRuntimeFolder);\n  250:     const source = _fileManager.getInstallDirectory(_dataLakeFileId);\n  251:     const copyFileList = fs.readdirSync(source);\n  252:     const promises = copyFileList.map((file) => {\n  253:         return fspromise.writeFileAsync(path.join(_dataLakeRuntimeFolder, file), fspromise.readFileSync(path.join(source, file)));\n  254:     });\n  255:     // fs.readdirSync(source).forEach(file => {"}}, {"message": "source", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 250, "start_column": 11, "end_line": null, "end_column": 69, "snippet": "  245:         charset: 'alphabetic',\n  246:         length: 12,\n  247:     });\n  248:     _dataLakeRuntimeFolder = path.join(tempFolder, folder);\n  249:     fs.mkdirSync(_dataLakeRuntimeFolder);\n  250:     const source = _fileManager.getInstallDirectory(_dataLakeFileId);\n  251:     const copyFileList = fs.readdirSync(source);\n  252:     const promises = copyFileList.map((file) => {\n  253:         return fspromise.writeFileAsync(path.join(_dataLakeRuntimeFolder, file), fspromise.readFileSync(path.join(source, file)));\n  254:     });\n  255:     // fs.readdirSync(source).forEach(file => {"}}, {"message": "source", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 250, "start_column": 11, "end_line": null, "end_column": 17, "snippet": "  245:         charset: 'alphabetic',\n  246:         length: 12,\n  247:     });\n  248:     _dataLakeRuntimeFolder = path.join(tempFolder, folder);\n  249:     fs.mkdirSync(_dataLakeRuntimeFolder);\n  250:     const source = _fileManager.getInstallDirectory(_dataLakeFileId);\n  251:     const copyFileList = fs.readdirSync(source);\n  252:     const promises = copyFileList.map((file) => {\n  253:         return fspromise.writeFileAsync(path.join(_dataLakeRuntimeFolder, file), fspromise.readFileSync(path.join(source, file)));\n  254:     });\n  255:     // fs.readdirSync(source).forEach(file => {"}}, {"message": "__dirname", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/fileManager.js", "start_line": 74, "start_column": 30, "end_line": null, "end_column": 39, "snippet": "   69:             // Append runtime to installation directory\n   70:             var directory = fileItem.FileId + (platform.getFlavoredVersion() == platform.Flavor.Mono ? \"-mono\" : \"-desktop\");\n   71:             return path.join(__dirname, '..', '..', directory);\n   72:         }\n   73:         else {\n   74:             return path.join(__dirname, '..', '..', fileItem.FileId);\n   75:         }\n   76:     }\n   77:     isAllDependencyFulfilled() {\n   78:         this.fileList.forEach(element => {\n   79:             var fileName = path.join(this.getInstallDirectory(element.FileId), element.ExecutableFileName);"}}, {"message": "path.jo ... FileId)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/fileManager.js", "start_line": 74, "start_column": 20, "end_line": null, "end_column": 69, "snippet": "   69:             // Append runtime to installation directory\n   70:             var directory = fileItem.FileId + (platform.getFlavoredVersion() == platform.Flavor.Mono ? \"-mono\" : \"-desktop\");\n   71:             return path.join(__dirname, '..', '..', directory);\n   72:         }\n   73:         else {\n   74:             return path.join(__dirname, '..', '..', fileItem.FileId);\n   75:         }\n   76:     }\n   77:     isAllDependencyFulfilled() {\n   78:         this.fileList.forEach(element => {\n   79:             var fileName = path.join(this.getInstallDirectory(element.FileId), element.ExecutableFileName);"}}, {"message": "_fileMa ... FileId)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 250, "start_column": 20, "end_line": null, "end_column": 69, "snippet": "  245:         charset: 'alphabetic',\n  246:         length: 12,\n  247:     });\n  248:     _dataLakeRuntimeFolder = path.join(tempFolder, folder);\n  249:     fs.mkdirSync(_dataLakeRuntimeFolder);\n  250:     const source = _fileManager.getInstallDirectory(_dataLakeFileId);\n  251:     const copyFileList = fs.readdirSync(source);\n  252:     const promises = copyFileList.map((file) => {\n  253:         return fspromise.writeFileAsync(path.join(_dataLakeRuntimeFolder, file), fspromise.readFileSync(path.join(source, file)));\n  254:     });\n  255:     // fs.readdirSync(source).forEach(file => {"}}, {"message": "source", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 250, "start_column": 11, "end_line": null, "end_column": 69, "snippet": "  245:         charset: 'alphabetic',\n  246:         length: 12,\n  247:     });\n  248:     _dataLakeRuntimeFolder = path.join(tempFolder, folder);\n  249:     fs.mkdirSync(_dataLakeRuntimeFolder);\n  250:     const source = _fileManager.getInstallDirectory(_dataLakeFileId);\n  251:     const copyFileList = fs.readdirSync(source);\n  252:     const promises = copyFileList.map((file) => {\n  253:         return fspromise.writeFileAsync(path.join(_dataLakeRuntimeFolder, file), fspromise.readFileSync(path.join(source, file)));\n  254:     });\n  255:     // fs.readdirSync(source).forEach(file => {"}}, {"message": "source", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 250, "start_column": 11, "end_line": null, "end_column": 17, "snippet": "  245:         charset: 'alphabetic',\n  246:         length: 12,\n  247:     });\n  248:     _dataLakeRuntimeFolder = path.join(tempFolder, folder);\n  249:     fs.mkdirSync(_dataLakeRuntimeFolder);\n  250:     const source = _fileManager.getInstallDirectory(_dataLakeFileId);\n  251:     const copyFileList = fs.readdirSync(source);\n  252:     const promises = copyFileList.map((file) => {\n  253:         return fspromise.writeFileAsync(path.join(_dataLakeRuntimeFolder, file), fspromise.readFileSync(path.join(source, file)));\n  254:     });\n  255:     // fs.readdirSync(source).forEach(file => {"}}]}
{"result_index": 2, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.\n(Experimental) This shell command depends on [an uncontrolled value](2). Identified using machine learning.\n(Experimental) This shell command depends on [an uncontrolled value](3). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 274, "start_column": 21, "end_line": null, "end_column": 33, "snippet": "  269:     fs.mkdirSync(_languageServiceRuntimeFolder);\n  270:     const sourceFolder = _fileManager.getInstallDirectory(_scopecompilerFileId);\n  271:     const promises = copyFolder(sourceFolder, _languageServiceRuntimeFolder);\n  272:     return Promise.all(promises);\n  273: }\n  274: function copyFolder(sourceFolder, destFolder) {\n  275:     if (!fs.existsSync(destFolder)) {\n  276:         fs.mkdirSync(destFolder);\n  277:     }\n  278:     const copyFileList = fs.readdirSync(sourceFolder);\n  279:     const promises = copyFileList.map((file) => {"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 278, "start_column": 26, "end_line": null, "end_column": 54, "snippet": "  273: }\n  274: function copyFolder(sourceFolder, destFolder) {\n  275:     if (!fs.existsSync(destFolder)) {\n  276:         fs.mkdirSync(destFolder);\n  277:     }\n  278:     const copyFileList = fs.readdirSync(sourceFolder);\n  279:     const promises = copyFileList.map((file) => {\n  280:         if (fs.statSync(path.join(sourceFolder, file)).isDirectory()) {\n  281:             return copyFolder(path.join(sourceFolder, file), path.join(destFolder, file));\n  282:         }\n  283:         else {"}, "path": [{"message": "fs.read ... Folder)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 278, "start_column": 26, "end_line": null, "end_column": 54, "snippet": "  273: }\n  274: function copyFolder(sourceFolder, destFolder) {\n  275:     if (!fs.existsSync(destFolder)) {\n  276:         fs.mkdirSync(destFolder);\n  277:     }\n  278:     const copyFileList = fs.readdirSync(sourceFolder);\n  279:     const promises = copyFileList.map((file) => {\n  280:         if (fs.statSync(path.join(sourceFolder, file)).isDirectory()) {\n  281:             return copyFolder(path.join(sourceFolder, file), path.join(destFolder, file));\n  282:         }\n  283:         else {"}}, {"message": "copyFileList", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 278, "start_column": 11, "end_line": null, "end_column": 54, "snippet": "  273: }\n  274: function copyFolder(sourceFolder, destFolder) {\n  275:     if (!fs.existsSync(destFolder)) {\n  276:         fs.mkdirSync(destFolder);\n  277:     }\n  278:     const copyFileList = fs.readdirSync(sourceFolder);\n  279:     const promises = copyFileList.map((file) => {\n  280:         if (fs.statSync(path.join(sourceFolder, file)).isDirectory()) {\n  281:             return copyFolder(path.join(sourceFolder, file), path.join(destFolder, file));\n  282:         }\n  283:         else {"}}, {"message": "copyFileList", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 279, "start_column": 22, "end_line": null, "end_column": 34, "snippet": "  274: function copyFolder(sourceFolder, destFolder) {\n  275:     if (!fs.existsSync(destFolder)) {\n  276:         fs.mkdirSync(destFolder);\n  277:     }\n  278:     const copyFileList = fs.readdirSync(sourceFolder);\n  279:     const promises = copyFileList.map((file) => {\n  280:         if (fs.statSync(path.join(sourceFolder, file)).isDirectory()) {\n  281:             return copyFolder(path.join(sourceFolder, file), path.join(destFolder, file));\n  282:         }\n  283:         else {\n  284:             return fspromise.writeFileAsync(path.join(destFolder, file), fspromise.readFileSync(path.join(sourceFolder, file)));"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 279, "start_column": 40, "end_line": null, "end_column": 44, "snippet": "  274: function copyFolder(sourceFolder, destFolder) {\n  275:     if (!fs.existsSync(destFolder)) {\n  276:         fs.mkdirSync(destFolder);\n  277:     }\n  278:     const copyFileList = fs.readdirSync(sourceFolder);\n  279:     const promises = copyFileList.map((file) => {\n  280:         if (fs.statSync(path.join(sourceFolder, file)).isDirectory()) {\n  281:             return copyFolder(path.join(sourceFolder, file), path.join(destFolder, file));\n  282:         }\n  283:         else {\n  284:             return fspromise.writeFileAsync(path.join(destFolder, file), fspromise.readFileSync(path.join(sourceFolder, file)));"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 281, "start_column": 55, "end_line": null, "end_column": 59, "snippet": "  276:         fs.mkdirSync(destFolder);\n  277:     }\n  278:     const copyFileList = fs.readdirSync(sourceFolder);\n  279:     const promises = copyFileList.map((file) => {\n  280:         if (fs.statSync(path.join(sourceFolder, file)).isDirectory()) {\n  281:             return copyFolder(path.join(sourceFolder, file), path.join(destFolder, file));\n  282:         }\n  283:         else {\n  284:             return fspromise.writeFileAsync(path.join(destFolder, file), fspromise.readFileSync(path.join(sourceFolder, file)));\n  285:         }\n  286:     });"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 281, "start_column": 31, "end_line": null, "end_column": 60, "snippet": "  276:         fs.mkdirSync(destFolder);\n  277:     }\n  278:     const copyFileList = fs.readdirSync(sourceFolder);\n  279:     const promises = copyFileList.map((file) => {\n  280:         if (fs.statSync(path.join(sourceFolder, file)).isDirectory()) {\n  281:             return copyFolder(path.join(sourceFolder, file), path.join(destFolder, file));\n  282:         }\n  283:         else {\n  284:             return fspromise.writeFileAsync(path.join(destFolder, file), fspromise.readFileSync(path.join(sourceFolder, file)));\n  285:         }\n  286:     });"}}, {"message": "sourceFolder", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 274, "start_column": 21, "end_line": null, "end_column": 33, "snippet": "  269:     fs.mkdirSync(_languageServiceRuntimeFolder);\n  270:     const sourceFolder = _fileManager.getInstallDirectory(_scopecompilerFileId);\n  271:     const promises = copyFolder(sourceFolder, _languageServiceRuntimeFolder);\n  272:     return Promise.all(promises);\n  273: }\n  274: function copyFolder(sourceFolder, destFolder) {\n  275:     if (!fs.existsSync(destFolder)) {\n  276:         fs.mkdirSync(destFolder);\n  277:     }\n  278:     const copyFileList = fs.readdirSync(sourceFolder);\n  279:     const promises = copyFileList.map((file) => {"}}, {"message": "sourceFolder", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 274, "start_column": 21, "end_line": null, "end_column": 33, "snippet": "  269:     fs.mkdirSync(_languageServiceRuntimeFolder);\n  270:     const sourceFolder = _fileManager.getInstallDirectory(_scopecompilerFileId);\n  271:     const promises = copyFolder(sourceFolder, _languageServiceRuntimeFolder);\n  272:     return Promise.all(promises);\n  273: }\n  274: function copyFolder(sourceFolder, destFolder) {\n  275:     if (!fs.existsSync(destFolder)) {\n  276:         fs.mkdirSync(destFolder);\n  277:     }\n  278:     const copyFileList = fs.readdirSync(sourceFolder);\n  279:     const promises = copyFileList.map((file) => {"}}, {"message": "__dirname", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/fileManager.js", "start_line": 71, "start_column": 30, "end_line": null, "end_column": 39, "snippet": "   66:     getInstallDirectory(fileId) {\n   67:         var fileItem = this.fileList.find(t => t.FileId == fileId);\n   68:         if (fileItem.Runtime != \"\") {\n   69:             // Append runtime to installation directory\n   70:             var directory = fileItem.FileId + (platform.getFlavoredVersion() == platform.Flavor.Mono ? \"-mono\" : \"-desktop\");\n   71:             return path.join(__dirname, '..', '..', directory);\n   72:         }\n   73:         else {\n   74:             return path.join(__dirname, '..', '..', fileItem.FileId);\n   75:         }\n   76:     }"}}, {"message": "path.jo ... ectory)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/fileManager.js", "start_line": 71, "start_column": 20, "end_line": null, "end_column": 63, "snippet": "   66:     getInstallDirectory(fileId) {\n   67:         var fileItem = this.fileList.find(t => t.FileId == fileId);\n   68:         if (fileItem.Runtime != \"\") {\n   69:             // Append runtime to installation directory\n   70:             var directory = fileItem.FileId + (platform.getFlavoredVersion() == platform.Flavor.Mono ? \"-mono\" : \"-desktop\");\n   71:             return path.join(__dirname, '..', '..', directory);\n   72:         }\n   73:         else {\n   74:             return path.join(__dirname, '..', '..', fileItem.FileId);\n   75:         }\n   76:     }"}}, {"message": "_fileMa ... FileId)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 270, "start_column": 26, "end_line": null, "end_column": 80, "snippet": "  265:         charset: 'alphabetic',\n  266:         length: 12,\n  267:     });\n  268:     _languageServiceRuntimeFolder = path.join(tempFolder, folder);\n  269:     fs.mkdirSync(_languageServiceRuntimeFolder);\n  270:     const sourceFolder = _fileManager.getInstallDirectory(_scopecompilerFileId);\n  271:     const promises = copyFolder(sourceFolder, _languageServiceRuntimeFolder);\n  272:     return Promise.all(promises);\n  273: }\n  274: function copyFolder(sourceFolder, destFolder) {\n  275:     if (!fs.existsSync(destFolder)) {"}}, {"message": "sourceFolder", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 270, "start_column": 11, "end_line": null, "end_column": 80, "snippet": "  265:         charset: 'alphabetic',\n  266:         length: 12,\n  267:     });\n  268:     _languageServiceRuntimeFolder = path.join(tempFolder, folder);\n  269:     fs.mkdirSync(_languageServiceRuntimeFolder);\n  270:     const sourceFolder = _fileManager.getInstallDirectory(_scopecompilerFileId);\n  271:     const promises = copyFolder(sourceFolder, _languageServiceRuntimeFolder);\n  272:     return Promise.all(promises);\n  273: }\n  274: function copyFolder(sourceFolder, destFolder) {\n  275:     if (!fs.existsSync(destFolder)) {"}}, {"message": "sourceFolder", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 271, "start_column": 33, "end_line": null, "end_column": 45, "snippet": "  266:         length: 12,\n  267:     });\n  268:     _languageServiceRuntimeFolder = path.join(tempFolder, folder);\n  269:     fs.mkdirSync(_languageServiceRuntimeFolder);\n  270:     const sourceFolder = _fileManager.getInstallDirectory(_scopecompilerFileId);\n  271:     const promises = copyFolder(sourceFolder, _languageServiceRuntimeFolder);\n  272:     return Promise.all(promises);\n  273: }\n  274: function copyFolder(sourceFolder, destFolder) {\n  275:     if (!fs.existsSync(destFolder)) {\n  276:         fs.mkdirSync(destFolder);"}}, {"message": "sourceFolder", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 274, "start_column": 21, "end_line": null, "end_column": 33, "snippet": "  269:     fs.mkdirSync(_languageServiceRuntimeFolder);\n  270:     const sourceFolder = _fileManager.getInstallDirectory(_scopecompilerFileId);\n  271:     const promises = copyFolder(sourceFolder, _languageServiceRuntimeFolder);\n  272:     return Promise.all(promises);\n  273: }\n  274: function copyFolder(sourceFolder, destFolder) {\n  275:     if (!fs.existsSync(destFolder)) {\n  276:         fs.mkdirSync(destFolder);\n  277:     }\n  278:     const copyFileList = fs.readdirSync(sourceFolder);\n  279:     const promises = copyFileList.map((file) => {"}}, {"message": "sourceFolder", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 274, "start_column": 21, "end_line": null, "end_column": 33, "snippet": "  269:     fs.mkdirSync(_languageServiceRuntimeFolder);\n  270:     const sourceFolder = _fileManager.getInstallDirectory(_scopecompilerFileId);\n  271:     const promises = copyFolder(sourceFolder, _languageServiceRuntimeFolder);\n  272:     return Promise.all(promises);\n  273: }\n  274: function copyFolder(sourceFolder, destFolder) {\n  275:     if (!fs.existsSync(destFolder)) {\n  276:         fs.mkdirSync(destFolder);\n  277:     }\n  278:     const copyFileList = fs.readdirSync(sourceFolder);\n  279:     const promises = copyFileList.map((file) => {"}}, {"message": "__dirname", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/fileManager.js", "start_line": 74, "start_column": 30, "end_line": null, "end_column": 39, "snippet": "   69:             // Append runtime to installation directory\n   70:             var directory = fileItem.FileId + (platform.getFlavoredVersion() == platform.Flavor.Mono ? \"-mono\" : \"-desktop\");\n   71:             return path.join(__dirname, '..', '..', directory);\n   72:         }\n   73:         else {\n   74:             return path.join(__dirname, '..', '..', fileItem.FileId);\n   75:         }\n   76:     }\n   77:     isAllDependencyFulfilled() {\n   78:         this.fileList.forEach(element => {\n   79:             var fileName = path.join(this.getInstallDirectory(element.FileId), element.ExecutableFileName);"}}, {"message": "path.jo ... FileId)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/fileManager.js", "start_line": 74, "start_column": 20, "end_line": null, "end_column": 69, "snippet": "   69:             // Append runtime to installation directory\n   70:             var directory = fileItem.FileId + (platform.getFlavoredVersion() == platform.Flavor.Mono ? \"-mono\" : \"-desktop\");\n   71:             return path.join(__dirname, '..', '..', directory);\n   72:         }\n   73:         else {\n   74:             return path.join(__dirname, '..', '..', fileItem.FileId);\n   75:         }\n   76:     }\n   77:     isAllDependencyFulfilled() {\n   78:         this.fileList.forEach(element => {\n   79:             var fileName = path.join(this.getInstallDirectory(element.FileId), element.ExecutableFileName);"}}, {"message": "_fileMa ... FileId)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 270, "start_column": 26, "end_line": null, "end_column": 80, "snippet": "  265:         charset: 'alphabetic',\n  266:         length: 12,\n  267:     });\n  268:     _languageServiceRuntimeFolder = path.join(tempFolder, folder);\n  269:     fs.mkdirSync(_languageServiceRuntimeFolder);\n  270:     const sourceFolder = _fileManager.getInstallDirectory(_scopecompilerFileId);\n  271:     const promises = copyFolder(sourceFolder, _languageServiceRuntimeFolder);\n  272:     return Promise.all(promises);\n  273: }\n  274: function copyFolder(sourceFolder, destFolder) {\n  275:     if (!fs.existsSync(destFolder)) {"}}, {"message": "sourceFolder", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 270, "start_column": 11, "end_line": null, "end_column": 80, "snippet": "  265:         charset: 'alphabetic',\n  266:         length: 12,\n  267:     });\n  268:     _languageServiceRuntimeFolder = path.join(tempFolder, folder);\n  269:     fs.mkdirSync(_languageServiceRuntimeFolder);\n  270:     const sourceFolder = _fileManager.getInstallDirectory(_scopecompilerFileId);\n  271:     const promises = copyFolder(sourceFolder, _languageServiceRuntimeFolder);\n  272:     return Promise.all(promises);\n  273: }\n  274: function copyFolder(sourceFolder, destFolder) {\n  275:     if (!fs.existsSync(destFolder)) {"}}, {"message": "sourceFolder", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 271, "start_column": 33, "end_line": null, "end_column": 45, "snippet": "  266:         length: 12,\n  267:     });\n  268:     _languageServiceRuntimeFolder = path.join(tempFolder, folder);\n  269:     fs.mkdirSync(_languageServiceRuntimeFolder);\n  270:     const sourceFolder = _fileManager.getInstallDirectory(_scopecompilerFileId);\n  271:     const promises = copyFolder(sourceFolder, _languageServiceRuntimeFolder);\n  272:     return Promise.all(promises);\n  273: }\n  274: function copyFolder(sourceFolder, destFolder) {\n  275:     if (!fs.existsSync(destFolder)) {\n  276:         fs.mkdirSync(destFolder);"}}, {"message": "sourceFolder", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 274, "start_column": 21, "end_line": null, "end_column": 33, "snippet": "  269:     fs.mkdirSync(_languageServiceRuntimeFolder);\n  270:     const sourceFolder = _fileManager.getInstallDirectory(_scopecompilerFileId);\n  271:     const promises = copyFolder(sourceFolder, _languageServiceRuntimeFolder);\n  272:     return Promise.all(promises);\n  273: }\n  274: function copyFolder(sourceFolder, destFolder) {\n  275:     if (!fs.existsSync(destFolder)) {\n  276:         fs.mkdirSync(destFolder);\n  277:     }\n  278:     const copyFileList = fs.readdirSync(sourceFolder);\n  279:     const promises = copyFileList.map((file) => {"}}, {"message": "sourceFolder", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 274, "start_column": 21, "end_line": null, "end_column": 33, "snippet": "  269:     fs.mkdirSync(_languageServiceRuntimeFolder);\n  270:     const sourceFolder = _fileManager.getInstallDirectory(_scopecompilerFileId);\n  271:     const promises = copyFolder(sourceFolder, _languageServiceRuntimeFolder);\n  272:     return Promise.all(promises);\n  273: }\n  274: function copyFolder(sourceFolder, destFolder) {\n  275:     if (!fs.existsSync(destFolder)) {\n  276:         fs.mkdirSync(destFolder);\n  277:     }\n  278:     const copyFileList = fs.readdirSync(sourceFolder);\n  279:     const promises = copyFileList.map((file) => {"}}]}
{"result_index": 3, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 274, "start_column": 35, "end_line": null, "end_column": 45, "snippet": "  269:     fs.mkdirSync(_languageServiceRuntimeFolder);\n  270:     const sourceFolder = _fileManager.getInstallDirectory(_scopecompilerFileId);\n  271:     const promises = copyFolder(sourceFolder, _languageServiceRuntimeFolder);\n  272:     return Promise.all(promises);\n  273: }\n  274: function copyFolder(sourceFolder, destFolder) {\n  275:     if (!fs.existsSync(destFolder)) {\n  276:         fs.mkdirSync(destFolder);\n  277:     }\n  278:     const copyFileList = fs.readdirSync(sourceFolder);\n  279:     const promises = copyFileList.map((file) => {"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 278, "start_column": 26, "end_line": null, "end_column": 54, "snippet": "  273: }\n  274: function copyFolder(sourceFolder, destFolder) {\n  275:     if (!fs.existsSync(destFolder)) {\n  276:         fs.mkdirSync(destFolder);\n  277:     }\n  278:     const copyFileList = fs.readdirSync(sourceFolder);\n  279:     const promises = copyFileList.map((file) => {\n  280:         if (fs.statSync(path.join(sourceFolder, file)).isDirectory()) {\n  281:             return copyFolder(path.join(sourceFolder, file), path.join(destFolder, file));\n  282:         }\n  283:         else {"}, "path": [{"message": "fs.read ... Folder)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 278, "start_column": 26, "end_line": null, "end_column": 54, "snippet": "  273: }\n  274: function copyFolder(sourceFolder, destFolder) {\n  275:     if (!fs.existsSync(destFolder)) {\n  276:         fs.mkdirSync(destFolder);\n  277:     }\n  278:     const copyFileList = fs.readdirSync(sourceFolder);\n  279:     const promises = copyFileList.map((file) => {\n  280:         if (fs.statSync(path.join(sourceFolder, file)).isDirectory()) {\n  281:             return copyFolder(path.join(sourceFolder, file), path.join(destFolder, file));\n  282:         }\n  283:         else {"}}, {"message": "copyFileList", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 278, "start_column": 11, "end_line": null, "end_column": 54, "snippet": "  273: }\n  274: function copyFolder(sourceFolder, destFolder) {\n  275:     if (!fs.existsSync(destFolder)) {\n  276:         fs.mkdirSync(destFolder);\n  277:     }\n  278:     const copyFileList = fs.readdirSync(sourceFolder);\n  279:     const promises = copyFileList.map((file) => {\n  280:         if (fs.statSync(path.join(sourceFolder, file)).isDirectory()) {\n  281:             return copyFolder(path.join(sourceFolder, file), path.join(destFolder, file));\n  282:         }\n  283:         else {"}}, {"message": "copyFileList", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 279, "start_column": 22, "end_line": null, "end_column": 34, "snippet": "  274: function copyFolder(sourceFolder, destFolder) {\n  275:     if (!fs.existsSync(destFolder)) {\n  276:         fs.mkdirSync(destFolder);\n  277:     }\n  278:     const copyFileList = fs.readdirSync(sourceFolder);\n  279:     const promises = copyFileList.map((file) => {\n  280:         if (fs.statSync(path.join(sourceFolder, file)).isDirectory()) {\n  281:             return copyFolder(path.join(sourceFolder, file), path.join(destFolder, file));\n  282:         }\n  283:         else {\n  284:             return fspromise.writeFileAsync(path.join(destFolder, file), fspromise.readFileSync(path.join(sourceFolder, file)));"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 279, "start_column": 40, "end_line": null, "end_column": 44, "snippet": "  274: function copyFolder(sourceFolder, destFolder) {\n  275:     if (!fs.existsSync(destFolder)) {\n  276:         fs.mkdirSync(destFolder);\n  277:     }\n  278:     const copyFileList = fs.readdirSync(sourceFolder);\n  279:     const promises = copyFileList.map((file) => {\n  280:         if (fs.statSync(path.join(sourceFolder, file)).isDirectory()) {\n  281:             return copyFolder(path.join(sourceFolder, file), path.join(destFolder, file));\n  282:         }\n  283:         else {\n  284:             return fspromise.writeFileAsync(path.join(destFolder, file), fspromise.readFileSync(path.join(sourceFolder, file)));"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 281, "start_column": 84, "end_line": null, "end_column": 88, "snippet": "  276:         fs.mkdirSync(destFolder);\n  277:     }\n  278:     const copyFileList = fs.readdirSync(sourceFolder);\n  279:     const promises = copyFileList.map((file) => {\n  280:         if (fs.statSync(path.join(sourceFolder, file)).isDirectory()) {\n  281:             return copyFolder(path.join(sourceFolder, file), path.join(destFolder, file));\n  282:         }\n  283:         else {\n  284:             return fspromise.writeFileAsync(path.join(destFolder, file), fspromise.readFileSync(path.join(sourceFolder, file)));\n  285:         }\n  286:     });"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 281, "start_column": 62, "end_line": null, "end_column": 89, "snippet": "  276:         fs.mkdirSync(destFolder);\n  277:     }\n  278:     const copyFileList = fs.readdirSync(sourceFolder);\n  279:     const promises = copyFileList.map((file) => {\n  280:         if (fs.statSync(path.join(sourceFolder, file)).isDirectory()) {\n  281:             return copyFolder(path.join(sourceFolder, file), path.join(destFolder, file));\n  282:         }\n  283:         else {\n  284:             return fspromise.writeFileAsync(path.join(destFolder, file), fspromise.readFileSync(path.join(sourceFolder, file)));\n  285:         }\n  286:     });"}}, {"message": "destFolder", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 274, "start_column": 35, "end_line": null, "end_column": 45, "snippet": "  269:     fs.mkdirSync(_languageServiceRuntimeFolder);\n  270:     const sourceFolder = _fileManager.getInstallDirectory(_scopecompilerFileId);\n  271:     const promises = copyFolder(sourceFolder, _languageServiceRuntimeFolder);\n  272:     return Promise.all(promises);\n  273: }\n  274: function copyFolder(sourceFolder, destFolder) {\n  275:     if (!fs.existsSync(destFolder)) {\n  276:         fs.mkdirSync(destFolder);\n  277:     }\n  278:     const copyFileList = fs.readdirSync(sourceFolder);\n  279:     const promises = copyFileList.map((file) => {"}}, {"message": "destFolder", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 274, "start_column": 35, "end_line": null, "end_column": 45, "snippet": "  269:     fs.mkdirSync(_languageServiceRuntimeFolder);\n  270:     const sourceFolder = _fileManager.getInstallDirectory(_scopecompilerFileId);\n  271:     const promises = copyFolder(sourceFolder, _languageServiceRuntimeFolder);\n  272:     return Promise.all(promises);\n  273: }\n  274: function copyFolder(sourceFolder, destFolder) {\n  275:     if (!fs.existsSync(destFolder)) {\n  276:         fs.mkdirSync(destFolder);\n  277:     }\n  278:     const copyFileList = fs.readdirSync(sourceFolder);\n  279:     const promises = copyFileList.map((file) => {"}}]}
{"result_index": 4, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 704, "start_column": 11, "end_line": null, "end_column": 24, "snippet": "  699: }\n  700: function buildCSharpProjDependency() {\n  701:     // this is only used for resolve dependency and can be reused for all the codeBehind, so put under entension folder\n  702:     const projectFilePath = path.join(vscode.workspace.rootPath, 'usqlCodeBehind.csproj');\n  703:     const projectReferencePath = path.join(vscode.workspace.rootPath, 'usqlCodeBehindReference');\n  704:     const referencePath = path.join(__dirname, '..', '..', 'reference');\n  705:     const codeBehindProjectFileContent = `<Project Sdk=\"Microsoft.NET.Sdk\">\n  706: \t<PropertyGroup>\n  707: \t\t<OutputType>Dll</OutputType>\n  708: \t\t<TargetFramework>netcoreapp1.0</TargetFramework>\n  709: \t</PropertyGroup>"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 704, "start_column": 37, "end_line": null, "end_column": 46, "snippet": "  699: }\n  700: function buildCSharpProjDependency() {\n  701:     // this is only used for resolve dependency and can be reused for all the codeBehind, so put under entension folder\n  702:     const projectFilePath = path.join(vscode.workspace.rootPath, 'usqlCodeBehind.csproj');\n  703:     const projectReferencePath = path.join(vscode.workspace.rootPath, 'usqlCodeBehindReference');\n  704:     const referencePath = path.join(__dirname, '..', '..', 'reference');\n  705:     const codeBehindProjectFileContent = `<Project Sdk=\"Microsoft.NET.Sdk\">\n  706: \t<PropertyGroup>\n  707: \t\t<OutputType>Dll</OutputType>\n  708: \t\t<TargetFramework>netcoreapp1.0</TargetFramework>\n  709: \t</PropertyGroup>"}, "path": [{"message": "__dirname", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 704, "start_column": 37, "end_line": null, "end_column": 46, "snippet": "  699: }\n  700: function buildCSharpProjDependency() {\n  701:     // this is only used for resolve dependency and can be reused for all the codeBehind, so put under entension folder\n  702:     const projectFilePath = path.join(vscode.workspace.rootPath, 'usqlCodeBehind.csproj');\n  703:     const projectReferencePath = path.join(vscode.workspace.rootPath, 'usqlCodeBehindReference');\n  704:     const referencePath = path.join(__dirname, '..', '..', 'reference');\n  705:     const codeBehindProjectFileContent = `<Project Sdk=\"Microsoft.NET.Sdk\">\n  706: \t<PropertyGroup>\n  707: \t\t<OutputType>Dll</OutputType>\n  708: \t\t<TargetFramework>netcoreapp1.0</TargetFramework>\n  709: \t</PropertyGroup>"}}, {"message": "path.jo ... rence')", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 704, "start_column": 27, "end_line": null, "end_column": 72, "snippet": "  699: }\n  700: function buildCSharpProjDependency() {\n  701:     // this is only used for resolve dependency and can be reused for all the codeBehind, so put under entension folder\n  702:     const projectFilePath = path.join(vscode.workspace.rootPath, 'usqlCodeBehind.csproj');\n  703:     const projectReferencePath = path.join(vscode.workspace.rootPath, 'usqlCodeBehindReference');\n  704:     const referencePath = path.join(__dirname, '..', '..', 'reference');\n  705:     const codeBehindProjectFileContent = `<Project Sdk=\"Microsoft.NET.Sdk\">\n  706: \t<PropertyGroup>\n  707: \t\t<OutputType>Dll</OutputType>\n  708: \t\t<TargetFramework>netcoreapp1.0</TargetFramework>\n  709: \t</PropertyGroup>"}}, {"message": "referencePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 704, "start_column": 11, "end_line": null, "end_column": 72, "snippet": "  699: }\n  700: function buildCSharpProjDependency() {\n  701:     // this is only used for resolve dependency and can be reused for all the codeBehind, so put under entension folder\n  702:     const projectFilePath = path.join(vscode.workspace.rootPath, 'usqlCodeBehind.csproj');\n  703:     const projectReferencePath = path.join(vscode.workspace.rootPath, 'usqlCodeBehindReference');\n  704:     const referencePath = path.join(__dirname, '..', '..', 'reference');\n  705:     const codeBehindProjectFileContent = `<Project Sdk=\"Microsoft.NET.Sdk\">\n  706: \t<PropertyGroup>\n  707: \t\t<OutputType>Dll</OutputType>\n  708: \t\t<TargetFramework>netcoreapp1.0</TargetFramework>\n  709: \t</PropertyGroup>"}}, {"message": "referencePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 704, "start_column": 11, "end_line": null, "end_column": 24, "snippet": "  699: }\n  700: function buildCSharpProjDependency() {\n  701:     // this is only used for resolve dependency and can be reused for all the codeBehind, so put under entension folder\n  702:     const projectFilePath = path.join(vscode.workspace.rootPath, 'usqlCodeBehind.csproj');\n  703:     const projectReferencePath = path.join(vscode.workspace.rootPath, 'usqlCodeBehindReference');\n  704:     const referencePath = path.join(__dirname, '..', '..', 'reference');\n  705:     const codeBehindProjectFileContent = `<Project Sdk=\"Microsoft.NET.Sdk\">\n  706: \t<PropertyGroup>\n  707: \t\t<OutputType>Dll</OutputType>\n  708: \t\t<TargetFramework>netcoreapp1.0</TargetFramework>\n  709: \t</PropertyGroup>"}}]}
{"result_index": 5, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/datalakeStorageManager.js", "start_line": 467, "start_column": 23, "end_line": null, "end_column": 37, "snippet": "  462:                 return;\n  463:             }\n  464:             let p = flattenedPaths.pop();\n  465:             getStorageAccount.then((storageAccount) => {\n  466:                 const relativePath = p.full.replace(p.base, '');\n  467:                 const targetFullPath = util_1.util.IsFolderPath(targetPath) ? path.join(targetPath, relativePath) : targetPath;\n  468:                 let theStorageAccount = p.storageAccount ? p.storageAccount : storageAccount;\n  469:                 // check if exists here.\n  470:                 let checkFileStatus = () => {\n  471:                     let targetFileExists;\n  472:                     if (doCopyFunc === DatalakeStorageManager.uploadToPath) {"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 347, "start_column": 9, "end_line": null, "end_column": 26, "snippet": "  342:     static getFilesRecursively(base, p, storageAccount) {\n  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {\n  351:                     result.push(f);\n  352:                 });"}, "path": [{"message": "fs.readdirSync(p)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 347, "start_column": 9, "end_line": null, "end_column": 26, "snippet": "  342:     static getFilesRecursively(base, p, storageAccount) {\n  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {\n  351:                     result.push(f);\n  352:                 });"}}, {"message": "item", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 347, "start_column": 36, "end_line": null, "end_column": 40, "snippet": "  342:     static getFilesRecursively(base, p, storageAccount) {\n  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {\n  351:                     result.push(f);\n  352:                 });"}}, {"message": "item", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 348, "start_column": 43, "end_line": null, "end_column": 47, "snippet": "  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {\n  351:                     result.push(f);\n  352:                 });\n  353:             }"}}, {"message": "path.join(p, item)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 348, "start_column": 30, "end_line": null, "end_column": 48, "snippet": "  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {\n  351:                     result.push(f);\n  352:                 });\n  353:             }"}}, {"message": "itemPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 348, "start_column": 19, "end_line": null, "end_column": 48, "snippet": "  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {\n  351:                     result.push(f);\n  352:                 });\n  353:             }"}}, {"message": "itemPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 355, "start_column": 49, "end_line": null, "end_column": 57, "snippet": "  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {\n  351:                     result.push(f);\n  352:                 });\n  353:             }\n  354:             else {\n  355:                 result.push({ base: base, full: itemPath, storageAccount: storageAccount });\n  356:             }\n  357:         });\n  358:         return result;\n  359:     }\n  360:     static previewContentInFile(tempConfigFilePath, content, onSave) {"}}, {"message": "p.full", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/datalakeStorageManager.js", "start_line": 466, "start_column": 38, "end_line": null, "end_column": 44, "snippet": "  461:             if (concurrency > 5) {\n  462:                 return;\n  463:             }\n  464:             let p = flattenedPaths.pop();\n  465:             getStorageAccount.then((storageAccount) => {\n  466:                 const relativePath = p.full.replace(p.base, '');\n  467:                 const targetFullPath = util_1.util.IsFolderPath(targetPath) ? path.join(targetPath, relativePath) : targetPath;\n  468:                 let theStorageAccount = p.storageAccount ? p.storageAccount : storageAccount;\n  469:                 // check if exists here.\n  470:                 let checkFileStatus = () => {\n  471:                     let targetFileExists;"}}, {"message": "p.full. ... se, '')", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/datalakeStorageManager.js", "start_line": 466, "start_column": 38, "end_line": null, "end_column": 64, "snippet": "  461:             if (concurrency > 5) {\n  462:                 return;\n  463:             }\n  464:             let p = flattenedPaths.pop();\n  465:             getStorageAccount.then((storageAccount) => {\n  466:                 const relativePath = p.full.replace(p.base, '');\n  467:                 const targetFullPath = util_1.util.IsFolderPath(targetPath) ? path.join(targetPath, relativePath) : targetPath;\n  468:                 let theStorageAccount = p.storageAccount ? p.storageAccount : storageAccount;\n  469:                 // check if exists here.\n  470:                 let checkFileStatus = () => {\n  471:                     let targetFileExists;"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/datalakeStorageManager.js", "start_line": 466, "start_column": 23, "end_line": null, "end_column": 64, "snippet": "  461:             if (concurrency > 5) {\n  462:                 return;\n  463:             }\n  464:             let p = flattenedPaths.pop();\n  465:             getStorageAccount.then((storageAccount) => {\n  466:                 const relativePath = p.full.replace(p.base, '');\n  467:                 const targetFullPath = util_1.util.IsFolderPath(targetPath) ? path.join(targetPath, relativePath) : targetPath;\n  468:                 let theStorageAccount = p.storageAccount ? p.storageAccount : storageAccount;\n  469:                 // check if exists here.\n  470:                 let checkFileStatus = () => {\n  471:                     let targetFileExists;"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/datalakeStorageManager.js", "start_line": 467, "start_column": 101, "end_line": null, "end_column": 113, "snippet": "  462:                 return;\n  463:             }\n  464:             let p = flattenedPaths.pop();\n  465:             getStorageAccount.then((storageAccount) => {\n  466:                 const relativePath = p.full.replace(p.base, '');\n  467:                 const targetFullPath = util_1.util.IsFolderPath(targetPath) ? path.join(targetPath, relativePath) : targetPath;\n  468:                 let theStorageAccount = p.storageAccount ? p.storageAccount : storageAccount;\n  469:                 // check if exists here.\n  470:                 let checkFileStatus = () => {\n  471:                     let targetFileExists;\n  472:                     if (doCopyFunc === DatalakeStorageManager.uploadToPath) {"}}, {"message": "path.jo ... vePath)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/datalakeStorageManager.js", "start_line": 467, "start_column": 79, "end_line": null, "end_column": 114, "snippet": "  462:                 return;\n  463:             }\n  464:             let p = flattenedPaths.pop();\n  465:             getStorageAccount.then((storageAccount) => {\n  466:                 const relativePath = p.full.replace(p.base, '');\n  467:                 const targetFullPath = util_1.util.IsFolderPath(targetPath) ? path.join(targetPath, relativePath) : targetPath;\n  468:                 let theStorageAccount = p.storageAccount ? p.storageAccount : storageAccount;\n  469:                 // check if exists here.\n  470:                 let checkFileStatus = () => {\n  471:                     let targetFileExists;\n  472:                     if (doCopyFunc === DatalakeStorageManager.uploadToPath) {"}}, {"message": "util_1. ... getPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/datalakeStorageManager.js", "start_line": 467, "start_column": 40, "end_line": null, "end_column": 127, "snippet": "  462:                 return;\n  463:             }\n  464:             let p = flattenedPaths.pop();\n  465:             getStorageAccount.then((storageAccount) => {\n  466:                 const relativePath = p.full.replace(p.base, '');\n  467:                 const targetFullPath = util_1.util.IsFolderPath(targetPath) ? path.join(targetPath, relativePath) : targetPath;\n  468:                 let theStorageAccount = p.storageAccount ? p.storageAccount : storageAccount;\n  469:                 // check if exists here.\n  470:                 let checkFileStatus = () => {\n  471:                     let targetFileExists;\n  472:                     if (doCopyFunc === DatalakeStorageManager.uploadToPath) {"}}, {"message": "targetFullPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/datalakeStorageManager.js", "start_line": 467, "start_column": 23, "end_line": null, "end_column": 127, "snippet": "  462:                 return;\n  463:             }\n  464:             let p = flattenedPaths.pop();\n  465:             getStorageAccount.then((storageAccount) => {\n  466:                 const relativePath = p.full.replace(p.base, '');\n  467:                 const targetFullPath = util_1.util.IsFolderPath(targetPath) ? path.join(targetPath, relativePath) : targetPath;\n  468:                 let theStorageAccount = p.storageAccount ? p.storageAccount : storageAccount;\n  469:                 // check if exists here.\n  470:                 let checkFileStatus = () => {\n  471:                     let targetFileExists;\n  472:                     if (doCopyFunc === DatalakeStorageManager.uploadToPath) {"}}, {"message": "targetFullPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/datalakeStorageManager.js", "start_line": 467, "start_column": 23, "end_line": null, "end_column": 37, "snippet": "  462:                 return;\n  463:             }\n  464:             let p = flattenedPaths.pop();\n  465:             getStorageAccount.then((storageAccount) => {\n  466:                 const relativePath = p.full.replace(p.base, '');\n  467:                 const targetFullPath = util_1.util.IsFolderPath(targetPath) ? path.join(targetPath, relativePath) : targetPath;\n  468:                 let theStorageAccount = p.storageAccount ? p.storageAccount : storageAccount;\n  469:                 // check if exists here.\n  470:                 let checkFileStatus = () => {\n  471:                     let targetFileExists;\n  472:                     if (doCopyFunc === DatalakeStorageManager.uploadToPath) {"}}]}
{"result_index": 6, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.\n(Experimental) This shell command depends on [an uncontrolled value](2). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 119, "start_column": 33, "end_line": null, "end_column": 46, "snippet": "  114:         }\n  115:         else {\n  116:             return filePath;\n  117:         }\n  118:     }\n  119:     static rmdirSyncRecursively(currentFolder) {\n  120:         fs.readdirSync(currentFolder).forEach((f) => {\n  121:             let currentItem = path.join(currentFolder, f);\n  122:             let currentStat = fs.statSync(currentItem);\n  123:             if (currentStat.isDirectory()) {\n  124:                 this.rmdirSyncRecursively(currentItem);"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 291, "start_column": 9, "end_line": null, "end_column": 31, "snippet": "  286:     });\n  287:     return promises;\n  288: }\n  289: function cleanUserFolder(folder, cleanFolderPrefix) {\n  290:     try {\n  291:         fs.readdirSync(folder).forEach((dir) => {\n  292:             if (dir.startsWith(cleanFolderPrefix)) {\n  293:                 const currentFolder = path.join(folder, dir);\n  294:                 util_1.util.rmdirSyncRecursively(currentFolder);\n  295:             }\n  296:         });"}, "path": [{"message": "fs.read ... folder)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 291, "start_column": 9, "end_line": null, "end_column": 31, "snippet": "  286:     });\n  287:     return promises;\n  288: }\n  289: function cleanUserFolder(folder, cleanFolderPrefix) {\n  290:     try {\n  291:         fs.readdirSync(folder).forEach((dir) => {\n  292:             if (dir.startsWith(cleanFolderPrefix)) {\n  293:                 const currentFolder = path.join(folder, dir);\n  294:                 util_1.util.rmdirSyncRecursively(currentFolder);\n  295:             }\n  296:         });"}}, {"message": "dir", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 291, "start_column": 41, "end_line": null, "end_column": 44, "snippet": "  286:     });\n  287:     return promises;\n  288: }\n  289: function cleanUserFolder(folder, cleanFolderPrefix) {\n  290:     try {\n  291:         fs.readdirSync(folder).forEach((dir) => {\n  292:             if (dir.startsWith(cleanFolderPrefix)) {\n  293:                 const currentFolder = path.join(folder, dir);\n  294:                 util_1.util.rmdirSyncRecursively(currentFolder);\n  295:             }\n  296:         });"}}, {"message": "dir", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 293, "start_column": 57, "end_line": null, "end_column": 60, "snippet": "  288: }\n  289: function cleanUserFolder(folder, cleanFolderPrefix) {\n  290:     try {\n  291:         fs.readdirSync(folder).forEach((dir) => {\n  292:             if (dir.startsWith(cleanFolderPrefix)) {\n  293:                 const currentFolder = path.join(folder, dir);\n  294:                 util_1.util.rmdirSyncRecursively(currentFolder);\n  295:             }\n  296:         });\n  297:     }\n  298:     catch (err) {"}}, {"message": "path.jo ... r, dir)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 293, "start_column": 39, "end_line": null, "end_column": 61, "snippet": "  288: }\n  289: function cleanUserFolder(folder, cleanFolderPrefix) {\n  290:     try {\n  291:         fs.readdirSync(folder).forEach((dir) => {\n  292:             if (dir.startsWith(cleanFolderPrefix)) {\n  293:                 const currentFolder = path.join(folder, dir);\n  294:                 util_1.util.rmdirSyncRecursively(currentFolder);\n  295:             }\n  296:         });\n  297:     }\n  298:     catch (err) {"}}, {"message": "currentFolder", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 293, "start_column": 23, "end_line": null, "end_column": 61, "snippet": "  288: }\n  289: function cleanUserFolder(folder, cleanFolderPrefix) {\n  290:     try {\n  291:         fs.readdirSync(folder).forEach((dir) => {\n  292:             if (dir.startsWith(cleanFolderPrefix)) {\n  293:                 const currentFolder = path.join(folder, dir);\n  294:                 util_1.util.rmdirSyncRecursively(currentFolder);\n  295:             }\n  296:         });\n  297:     }\n  298:     catch (err) {"}}, {"message": "currentFolder", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 294, "start_column": 50, "end_line": null, "end_column": 63, "snippet": "  289: function cleanUserFolder(folder, cleanFolderPrefix) {\n  290:     try {\n  291:         fs.readdirSync(folder).forEach((dir) => {\n  292:             if (dir.startsWith(cleanFolderPrefix)) {\n  293:                 const currentFolder = path.join(folder, dir);\n  294:                 util_1.util.rmdirSyncRecursively(currentFolder);\n  295:             }\n  296:         });\n  297:     }\n  298:     catch (err) {\n  299:         // remove temp files. ignore any exceptions."}}, {"message": "currentFolder", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 119, "start_column": 33, "end_line": null, "end_column": 46, "snippet": "  114:         }\n  115:         else {\n  116:             return filePath;\n  117:         }\n  118:     }\n  119:     static rmdirSyncRecursively(currentFolder) {\n  120:         fs.readdirSync(currentFolder).forEach((f) => {\n  121:             let currentItem = path.join(currentFolder, f);\n  122:             let currentStat = fs.statSync(currentItem);\n  123:             if (currentStat.isDirectory()) {\n  124:                 this.rmdirSyncRecursively(currentItem);"}}, {"message": "currentFolder", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 119, "start_column": 33, "end_line": null, "end_column": 46, "snippet": "  114:         }\n  115:         else {\n  116:             return filePath;\n  117:         }\n  118:     }\n  119:     static rmdirSyncRecursively(currentFolder) {\n  120:         fs.readdirSync(currentFolder).forEach((f) => {\n  121:             let currentItem = path.join(currentFolder, f);\n  122:             let currentStat = fs.statSync(currentItem);\n  123:             if (currentStat.isDirectory()) {\n  124:                 this.rmdirSyncRecursively(currentItem);"}}, {"message": "fs.read ... Folder)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 120, "start_column": 9, "end_line": null, "end_column": 38, "snippet": "  115:         else {\n  116:             return filePath;\n  117:         }\n  118:     }\n  119:     static rmdirSyncRecursively(currentFolder) {\n  120:         fs.readdirSync(currentFolder).forEach((f) => {\n  121:             let currentItem = path.join(currentFolder, f);\n  122:             let currentStat = fs.statSync(currentItem);\n  123:             if (currentStat.isDirectory()) {\n  124:                 this.rmdirSyncRecursively(currentItem);\n  125:             }"}}, {"message": "f", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 120, "start_column": 48, "end_line": null, "end_column": 49, "snippet": "  115:         else {\n  116:             return filePath;\n  117:         }\n  118:     }\n  119:     static rmdirSyncRecursively(currentFolder) {\n  120:         fs.readdirSync(currentFolder).forEach((f) => {\n  121:             let currentItem = path.join(currentFolder, f);\n  122:             let currentStat = fs.statSync(currentItem);\n  123:             if (currentStat.isDirectory()) {\n  124:                 this.rmdirSyncRecursively(currentItem);\n  125:             }"}}, {"message": "f", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 121, "start_column": 56, "end_line": null, "end_column": 57, "snippet": "  116:             return filePath;\n  117:         }\n  118:     }\n  119:     static rmdirSyncRecursively(currentFolder) {\n  120:         fs.readdirSync(currentFolder).forEach((f) => {\n  121:             let currentItem = path.join(currentFolder, f);\n  122:             let currentStat = fs.statSync(currentItem);\n  123:             if (currentStat.isDirectory()) {\n  124:                 this.rmdirSyncRecursively(currentItem);\n  125:             }\n  126:             else {"}}, {"message": "path.jo ... der, f)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 121, "start_column": 31, "end_line": null, "end_column": 58, "snippet": "  116:             return filePath;\n  117:         }\n  118:     }\n  119:     static rmdirSyncRecursively(currentFolder) {\n  120:         fs.readdirSync(currentFolder).forEach((f) => {\n  121:             let currentItem = path.join(currentFolder, f);\n  122:             let currentStat = fs.statSync(currentItem);\n  123:             if (currentStat.isDirectory()) {\n  124:                 this.rmdirSyncRecursively(currentItem);\n  125:             }\n  126:             else {"}}, {"message": "currentItem", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 121, "start_column": 17, "end_line": null, "end_column": 58, "snippet": "  116:             return filePath;\n  117:         }\n  118:     }\n  119:     static rmdirSyncRecursively(currentFolder) {\n  120:         fs.readdirSync(currentFolder).forEach((f) => {\n  121:             let currentItem = path.join(currentFolder, f);\n  122:             let currentStat = fs.statSync(currentItem);\n  123:             if (currentStat.isDirectory()) {\n  124:                 this.rmdirSyncRecursively(currentItem);\n  125:             }\n  126:             else {"}}, {"message": "currentItem", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 124, "start_column": 43, "end_line": null, "end_column": 54, "snippet": "  119:     static rmdirSyncRecursively(currentFolder) {\n  120:         fs.readdirSync(currentFolder).forEach((f) => {\n  121:             let currentItem = path.join(currentFolder, f);\n  122:             let currentStat = fs.statSync(currentItem);\n  123:             if (currentStat.isDirectory()) {\n  124:                 this.rmdirSyncRecursively(currentItem);\n  125:             }\n  126:             else {\n  127:                 fs.unlinkSync(path.join(currentFolder, f));\n  128:             }\n  129:         });"}}, {"message": "currentFolder", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 119, "start_column": 33, "end_line": null, "end_column": 46, "snippet": "  114:         }\n  115:         else {\n  116:             return filePath;\n  117:         }\n  118:     }\n  119:     static rmdirSyncRecursively(currentFolder) {\n  120:         fs.readdirSync(currentFolder).forEach((f) => {\n  121:             let currentItem = path.join(currentFolder, f);\n  122:             let currentStat = fs.statSync(currentItem);\n  123:             if (currentStat.isDirectory()) {\n  124:                 this.rmdirSyncRecursively(currentItem);"}}, {"message": "currentFolder", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 119, "start_column": 33, "end_line": null, "end_column": 46, "snippet": "  114:         }\n  115:         else {\n  116:             return filePath;\n  117:         }\n  118:     }\n  119:     static rmdirSyncRecursively(currentFolder) {\n  120:         fs.readdirSync(currentFolder).forEach((f) => {\n  121:             let currentItem = path.join(currentFolder, f);\n  122:             let currentStat = fs.statSync(currentItem);\n  123:             if (currentStat.isDirectory()) {\n  124:                 this.rmdirSyncRecursively(currentItem);"}}]}
{"result_index": 7, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 342, "start_column": 32, "end_line": null, "end_column": 36, "snippet": "  337:     }\n  338:     static toHexString(original) {\n  339:         let buff = new Buffer(original, 'utf8');\n  340:         return buff.toString('hex');\n  341:     }\n  342:     static getFilesRecursively(base, p, storageAccount) {\n  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 347, "start_column": 9, "end_line": null, "end_column": 26, "snippet": "  342:     static getFilesRecursively(base, p, storageAccount) {\n  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {\n  351:                     result.push(f);\n  352:                 });"}, "path": [{"message": "fs.readdirSync(p)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 347, "start_column": 9, "end_line": null, "end_column": 26, "snippet": "  342:     static getFilesRecursively(base, p, storageAccount) {\n  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {\n  351:                     result.push(f);\n  352:                 });"}}, {"message": "item", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 347, "start_column": 36, "end_line": null, "end_column": 40, "snippet": "  342:     static getFilesRecursively(base, p, storageAccount) {\n  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {\n  351:                     result.push(f);\n  352:                 });"}}, {"message": "item", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 348, "start_column": 43, "end_line": null, "end_column": 47, "snippet": "  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {\n  351:                     result.push(f);\n  352:                 });\n  353:             }"}}, {"message": "path.join(p, item)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 348, "start_column": 30, "end_line": null, "end_column": 48, "snippet": "  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {\n  351:                     result.push(f);\n  352:                 });\n  353:             }"}}, {"message": "itemPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 348, "start_column": 19, "end_line": null, "end_column": 48, "snippet": "  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {\n  351:                     result.push(f);\n  352:                 });\n  353:             }"}}, {"message": "itemPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 350, "start_column": 48, "end_line": null, "end_column": 56, "snippet": "  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {\n  351:                     result.push(f);\n  352:                 });\n  353:             }\n  354:             else {\n  355:                 result.push({ base: base, full: itemPath, storageAccount: storageAccount });"}}, {"message": "p", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 342, "start_column": 38, "end_line": null, "end_column": 39, "snippet": "  337:     }\n  338:     static toHexString(original) {\n  339:         let buff = new Buffer(original, 'utf8');\n  340:         return buff.toString('hex');\n  341:     }\n  342:     static getFilesRecursively(base, p, storageAccount) {\n  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {"}}, {"message": "p", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 345, "start_column": 20, "end_line": null, "end_column": 21, "snippet": "  340:         return buff.toString('hex');\n  341:     }\n  342:     static getFilesRecursively(base, p, storageAccount) {\n  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {"}}, {"message": "base", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 345, "start_column": 13, "end_line": null, "end_column": 21, "snippet": "  340:         return buff.toString('hex');\n  341:     }\n  342:     static getFilesRecursively(base, p, storageAccount) {\n  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {"}}, {"message": "base", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 342, "start_column": 32, "end_line": null, "end_column": 36, "snippet": "  337:     }\n  338:     static toHexString(original) {\n  339:         let buff = new Buffer(original, 'utf8');\n  340:         return buff.toString('hex');\n  341:     }\n  342:     static getFilesRecursively(base, p, storageAccount) {\n  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {"}}, {"message": "fs.readdirSync(p)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 347, "start_column": 9, "end_line": null, "end_column": 26, "snippet": "  342:     static getFilesRecursively(base, p, storageAccount) {\n  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {\n  351:                     result.push(f);\n  352:                 });"}}, {"message": "item", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 347, "start_column": 36, "end_line": null, "end_column": 40, "snippet": "  342:     static getFilesRecursively(base, p, storageAccount) {\n  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {\n  351:                     result.push(f);\n  352:                 });"}}, {"message": "item", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 348, "start_column": 43, "end_line": null, "end_column": 47, "snippet": "  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {\n  351:                     result.push(f);\n  352:                 });\n  353:             }"}}, {"message": "path.join(p, item)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 348, "start_column": 30, "end_line": null, "end_column": 48, "snippet": "  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {\n  351:                     result.push(f);\n  352:                 });\n  353:             }"}}, {"message": "itemPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 348, "start_column": 19, "end_line": null, "end_column": 48, "snippet": "  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {\n  351:                     result.push(f);\n  352:                 });\n  353:             }"}}, {"message": "itemPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 350, "start_column": 48, "end_line": null, "end_column": 56, "snippet": "  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {\n  351:                     result.push(f);\n  352:                 });\n  353:             }\n  354:             else {\n  355:                 result.push({ base: base, full: itemPath, storageAccount: storageAccount });"}}, {"message": "p", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 342, "start_column": 38, "end_line": null, "end_column": 39, "snippet": "  337:     }\n  338:     static toHexString(original) {\n  339:         let buff = new Buffer(original, 'utf8');\n  340:         return buff.toString('hex');\n  341:     }\n  342:     static getFilesRecursively(base, p, storageAccount) {\n  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {"}}, {"message": "p", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 345, "start_column": 20, "end_line": null, "end_column": 21, "snippet": "  340:         return buff.toString('hex');\n  341:     }\n  342:     static getFilesRecursively(base, p, storageAccount) {\n  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {"}}, {"message": "base", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 345, "start_column": 13, "end_line": null, "end_column": 21, "snippet": "  340:         return buff.toString('hex');\n  341:     }\n  342:     static getFilesRecursively(base, p, storageAccount) {\n  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {"}}, {"message": "base", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 350, "start_column": 42, "end_line": null, "end_column": 46, "snippet": "  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {\n  351:                     result.push(f);\n  352:                 });\n  353:             }\n  354:             else {\n  355:                 result.push({ base: base, full: itemPath, storageAccount: storageAccount });"}}, {"message": "base", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 342, "start_column": 32, "end_line": null, "end_column": 36, "snippet": "  337:     }\n  338:     static toHexString(original) {\n  339:         let buff = new Buffer(original, 'utf8');\n  340:         return buff.toString('hex');\n  341:     }\n  342:     static getFilesRecursively(base, p, storageAccount) {\n  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {"}}, {"message": "base", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 342, "start_column": 32, "end_line": null, "end_column": 36, "snippet": "  337:     }\n  338:     static toHexString(original) {\n  339:         let buff = new Buffer(original, 'utf8');\n  340:         return buff.toString('hex');\n  341:     }\n  342:     static getFilesRecursively(base, p, storageAccount) {\n  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {"}}]}
{"result_index": 8, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 342, "start_column": 38, "end_line": null, "end_column": 39, "snippet": "  337:     }\n  338:     static toHexString(original) {\n  339:         let buff = new Buffer(original, 'utf8');\n  340:         return buff.toString('hex');\n  341:     }\n  342:     static getFilesRecursively(base, p, storageAccount) {\n  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 347, "start_column": 9, "end_line": null, "end_column": 26, "snippet": "  342:     static getFilesRecursively(base, p, storageAccount) {\n  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {\n  351:                     result.push(f);\n  352:                 });"}, "path": [{"message": "fs.readdirSync(p)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 347, "start_column": 9, "end_line": null, "end_column": 26, "snippet": "  342:     static getFilesRecursively(base, p, storageAccount) {\n  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {\n  351:                     result.push(f);\n  352:                 });"}}, {"message": "item", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 347, "start_column": 36, "end_line": null, "end_column": 40, "snippet": "  342:     static getFilesRecursively(base, p, storageAccount) {\n  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {\n  351:                     result.push(f);\n  352:                 });"}}, {"message": "item", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 348, "start_column": 43, "end_line": null, "end_column": 47, "snippet": "  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {\n  351:                     result.push(f);\n  352:                 });\n  353:             }"}}, {"message": "path.join(p, item)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 348, "start_column": 30, "end_line": null, "end_column": 48, "snippet": "  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {\n  351:                     result.push(f);\n  352:                 });\n  353:             }"}}, {"message": "itemPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 348, "start_column": 19, "end_line": null, "end_column": 48, "snippet": "  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {\n  351:                     result.push(f);\n  352:                 });\n  353:             }"}}, {"message": "itemPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 350, "start_column": 48, "end_line": null, "end_column": 56, "snippet": "  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {\n  351:                     result.push(f);\n  352:                 });\n  353:             }\n  354:             else {\n  355:                 result.push({ base: base, full: itemPath, storageAccount: storageAccount });"}}, {"message": "p", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 342, "start_column": 38, "end_line": null, "end_column": 39, "snippet": "  337:     }\n  338:     static toHexString(original) {\n  339:         let buff = new Buffer(original, 'utf8');\n  340:         return buff.toString('hex');\n  341:     }\n  342:     static getFilesRecursively(base, p, storageAccount) {\n  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {"}}, {"message": "p", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 342, "start_column": 38, "end_line": null, "end_column": 39, "snippet": "  337:     }\n  338:     static toHexString(original) {\n  339:         let buff = new Buffer(original, 'utf8');\n  340:         return buff.toString('hex');\n  341:     }\n  342:     static getFilesRecursively(base, p, storageAccount) {\n  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {"}}]}
