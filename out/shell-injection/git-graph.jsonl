{"result_index": 0, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/life-cycle/startup.js", "start_line": 82, "start_column": 15, "end_line": null, "end_column": 19, "snippet": "   77:     ]);\n   78: }\n   79: function getNonce() {\n   80:     return new Promise((resolve, reject) => {\n   81:         const dir = utils_1.getDataDirectory();\n   82:         const file = path.join(dir, 'lock.json');\n   83:         fs.mkdir(dir, (err) => {\n   84:             if (err) {\n   85:                 if (err.code === 'EEXIST') {\n   86:                     fs.readFile(file, (err, data) => {\n   87:                         if (err) {"}, "source": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/life-cycle/utils.js", "start_line": 28, "start_column": 22, "end_line": null, "end_column": 31, "snippet": "   23: function generateNonce() {\n   24:     return crypto.randomBytes(32).toString('base64');\n   25: }\n   26: exports.generateNonce = generateNonce;\n   27: function getDataDirectory() {\n   28:     return path.join(__dirname, 'data');\n   29: }\n   30: exports.getDataDirectory = getDataDirectory;\n   31: function getLifeCycleFilePathInDirectory(directory) {\n   32:     return path.join(directory, 'life-cycle.json');\n   33: }"}, "path": [{"message": "__dirname", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/life-cycle/utils.js", "start_line": 28, "start_column": 22, "end_line": null, "end_column": 31, "snippet": "   23: function generateNonce() {\n   24:     return crypto.randomBytes(32).toString('base64');\n   25: }\n   26: exports.generateNonce = generateNonce;\n   27: function getDataDirectory() {\n   28:     return path.join(__dirname, 'data');\n   29: }\n   30: exports.getDataDirectory = getDataDirectory;\n   31: function getLifeCycleFilePathInDirectory(directory) {\n   32:     return path.join(directory, 'life-cycle.json');\n   33: }"}}, {"message": "path.jo ... 'data')", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/life-cycle/utils.js", "start_line": 28, "start_column": 12, "end_line": null, "end_column": 40, "snippet": "   23: function generateNonce() {\n   24:     return crypto.randomBytes(32).toString('base64');\n   25: }\n   26: exports.generateNonce = generateNonce;\n   27: function getDataDirectory() {\n   28:     return path.join(__dirname, 'data');\n   29: }\n   30: exports.getDataDirectory = getDataDirectory;\n   31: function getLifeCycleFilePathInDirectory(directory) {\n   32:     return path.join(directory, 'life-cycle.json');\n   33: }"}}, {"message": "utils_1 ... ctory()", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/life-cycle/startup.js", "start_line": 81, "start_column": 21, "end_line": null, "end_column": 47, "snippet": "   76:         utils_1.saveLifeCycleStateInDirectory(utils_1.getDataDirectory(), state)\n   77:     ]);\n   78: }\n   79: function getNonce() {\n   80:     return new Promise((resolve, reject) => {\n   81:         const dir = utils_1.getDataDirectory();\n   82:         const file = path.join(dir, 'lock.json');\n   83:         fs.mkdir(dir, (err) => {\n   84:             if (err) {\n   85:                 if (err.code === 'EEXIST') {\n   86:                     fs.readFile(file, (err, data) => {"}}, {"message": "dir", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/life-cycle/startup.js", "start_line": 81, "start_column": 15, "end_line": null, "end_column": 47, "snippet": "   76:         utils_1.saveLifeCycleStateInDirectory(utils_1.getDataDirectory(), state)\n   77:     ]);\n   78: }\n   79: function getNonce() {\n   80:     return new Promise((resolve, reject) => {\n   81:         const dir = utils_1.getDataDirectory();\n   82:         const file = path.join(dir, 'lock.json');\n   83:         fs.mkdir(dir, (err) => {\n   84:             if (err) {\n   85:                 if (err.code === 'EEXIST') {\n   86:                     fs.readFile(file, (err, data) => {"}}, {"message": "dir", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/life-cycle/startup.js", "start_line": 82, "start_column": 32, "end_line": null, "end_column": 35, "snippet": "   77:     ]);\n   78: }\n   79: function getNonce() {\n   80:     return new Promise((resolve, reject) => {\n   81:         const dir = utils_1.getDataDirectory();\n   82:         const file = path.join(dir, 'lock.json');\n   83:         fs.mkdir(dir, (err) => {\n   84:             if (err) {\n   85:                 if (err.code === 'EEXIST') {\n   86:                     fs.readFile(file, (err, data) => {\n   87:                         if (err) {"}}, {"message": "path.jo ... .json')", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/life-cycle/startup.js", "start_line": 82, "start_column": 22, "end_line": null, "end_column": 49, "snippet": "   77:     ]);\n   78: }\n   79: function getNonce() {\n   80:     return new Promise((resolve, reject) => {\n   81:         const dir = utils_1.getDataDirectory();\n   82:         const file = path.join(dir, 'lock.json');\n   83:         fs.mkdir(dir, (err) => {\n   84:             if (err) {\n   85:                 if (err.code === 'EEXIST') {\n   86:                     fs.readFile(file, (err, data) => {\n   87:                         if (err) {"}}, {"message": "file", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/life-cycle/startup.js", "start_line": 82, "start_column": 15, "end_line": null, "end_column": 49, "snippet": "   77:     ]);\n   78: }\n   79: function getNonce() {\n   80:     return new Promise((resolve, reject) => {\n   81:         const dir = utils_1.getDataDirectory();\n   82:         const file = path.join(dir, 'lock.json');\n   83:         fs.mkdir(dir, (err) => {\n   84:             if (err) {\n   85:                 if (err.code === 'EEXIST') {\n   86:                     fs.readFile(file, (err, data) => {\n   87:                         if (err) {"}}, {"message": "file", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/life-cycle/startup.js", "start_line": 82, "start_column": 15, "end_line": null, "end_column": 19, "snippet": "   77:     ]);\n   78: }\n   79: function getNonce() {\n   80:     return new Promise((resolve, reject) => {\n   81:         const dir = utils_1.getDataDirectory();\n   82:         const file = path.join(dir, 'lock.json');\n   83:         fs.mkdir(dir, (err) => {\n   84:             if (err) {\n   85:                 if (err.code === 'EEXIST') {\n   86:                     fs.readFile(file, (err, data) => {\n   87:                         if (err) {"}}]}
{"result_index": 1, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/life-cycle/utils.js", "start_line": 34, "start_column": 39, "end_line": null, "end_column": 48, "snippet": "   29: }\n   30: exports.getDataDirectory = getDataDirectory;\n   31: function getLifeCycleFilePathInDirectory(directory) {\n   32:     return path.join(directory, 'life-cycle.json');\n   33: }\n   34: function getLifeCycleStateInDirectory(directory) {\n   35:     return new Promise((resolve) => {\n   36:         fs.readFile(getLifeCycleFilePathInDirectory(directory), (err, data) => {\n   37:             if (err) {\n   38:                 resolve(null);\n   39:             }"}, "source": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/life-cycle/utils.js", "start_line": 28, "start_column": 22, "end_line": null, "end_column": 31, "snippet": "   23: function generateNonce() {\n   24:     return crypto.randomBytes(32).toString('base64');\n   25: }\n   26: exports.generateNonce = generateNonce;\n   27: function getDataDirectory() {\n   28:     return path.join(__dirname, 'data');\n   29: }\n   30: exports.getDataDirectory = getDataDirectory;\n   31: function getLifeCycleFilePathInDirectory(directory) {\n   32:     return path.join(directory, 'life-cycle.json');\n   33: }"}, "path": [{"message": "__dirname", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/life-cycle/utils.js", "start_line": 28, "start_column": 22, "end_line": null, "end_column": 31, "snippet": "   23: function generateNonce() {\n   24:     return crypto.randomBytes(32).toString('base64');\n   25: }\n   26: exports.generateNonce = generateNonce;\n   27: function getDataDirectory() {\n   28:     return path.join(__dirname, 'data');\n   29: }\n   30: exports.getDataDirectory = getDataDirectory;\n   31: function getLifeCycleFilePathInDirectory(directory) {\n   32:     return path.join(directory, 'life-cycle.json');\n   33: }"}}, {"message": "path.jo ... 'data')", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/life-cycle/utils.js", "start_line": 28, "start_column": 12, "end_line": null, "end_column": 40, "snippet": "   23: function generateNonce() {\n   24:     return crypto.randomBytes(32).toString('base64');\n   25: }\n   26: exports.generateNonce = generateNonce;\n   27: function getDataDirectory() {\n   28:     return path.join(__dirname, 'data');\n   29: }\n   30: exports.getDataDirectory = getDataDirectory;\n   31: function getLifeCycleFilePathInDirectory(directory) {\n   32:     return path.join(directory, 'life-cycle.json');\n   33: }"}}, {"message": "utils_1 ... ctory()", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/life-cycle/uninstall.js", "start_line": 16, "start_column": 70, "end_line": null, "end_column": 96, "snippet": "   11: Object.defineProperty(exports, \"__esModule\", { value: true });\n   12: const utils_1 = require(\"./utils\");\n   13: (function () {\n   14:     return __awaiter(this, void 0, void 0, function* () {\n   15:         try {\n   16:             const state = yield utils_1.getLifeCycleStateInDirectory(utils_1.getDataDirectory());\n   17:             if (state !== null) {\n   18:                 if (state.apiAvailable) {\n   19:                     state.queue.push({\n   20:                         stage: utils_1.LifeCycleStage.Uninstall,\n   21:                         extension: state.current.extension,"}}, {"message": "directory", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/life-cycle/utils.js", "start_line": 34, "start_column": 39, "end_line": null, "end_column": 48, "snippet": "   29: }\n   30: exports.getDataDirectory = getDataDirectory;\n   31: function getLifeCycleFilePathInDirectory(directory) {\n   32:     return path.join(directory, 'life-cycle.json');\n   33: }\n   34: function getLifeCycleStateInDirectory(directory) {\n   35:     return new Promise((resolve) => {\n   36:         fs.readFile(getLifeCycleFilePathInDirectory(directory), (err, data) => {\n   37:             if (err) {\n   38:                 resolve(null);\n   39:             }"}}, {"message": "directory", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/life-cycle/utils.js", "start_line": 34, "start_column": 39, "end_line": null, "end_column": 48, "snippet": "   29: }\n   30: exports.getDataDirectory = getDataDirectory;\n   31: function getLifeCycleFilePathInDirectory(directory) {\n   32:     return path.join(directory, 'life-cycle.json');\n   33: }\n   34: function getLifeCycleStateInDirectory(directory) {\n   35:     return new Promise((resolve) => {\n   36:         fs.readFile(getLifeCycleFilePathInDirectory(directory), (err, data) => {\n   37:             if (err) {\n   38:                 resolve(null);\n   39:             }"}}]}
{"result_index": 2, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/life-cycle/utils.js", "start_line": 52, "start_column": 40, "end_line": null, "end_column": 49, "snippet": "   47:             }\n   48:         });\n   49:     });\n   50: }\n   51: exports.getLifeCycleStateInDirectory = getLifeCycleStateInDirectory;\n   52: function saveLifeCycleStateInDirectory(directory, state) {\n   53:     return new Promise((resolve, reject) => {\n   54:         fs.mkdir(directory, (err) => {\n   55:             if (!err || err.code === 'EEXIST') {\n   56:                 fs.writeFile(getLifeCycleFilePathInDirectory(directory), JSON.stringify(state), (err) => {\n   57:                     if (err) {"}, "source": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/life-cycle/utils.js", "start_line": 28, "start_column": 22, "end_line": null, "end_column": 31, "snippet": "   23: function generateNonce() {\n   24:     return crypto.randomBytes(32).toString('base64');\n   25: }\n   26: exports.generateNonce = generateNonce;\n   27: function getDataDirectory() {\n   28:     return path.join(__dirname, 'data');\n   29: }\n   30: exports.getDataDirectory = getDataDirectory;\n   31: function getLifeCycleFilePathInDirectory(directory) {\n   32:     return path.join(directory, 'life-cycle.json');\n   33: }"}, "path": [{"message": "__dirname", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/life-cycle/utils.js", "start_line": 28, "start_column": 22, "end_line": null, "end_column": 31, "snippet": "   23: function generateNonce() {\n   24:     return crypto.randomBytes(32).toString('base64');\n   25: }\n   26: exports.generateNonce = generateNonce;\n   27: function getDataDirectory() {\n   28:     return path.join(__dirname, 'data');\n   29: }\n   30: exports.getDataDirectory = getDataDirectory;\n   31: function getLifeCycleFilePathInDirectory(directory) {\n   32:     return path.join(directory, 'life-cycle.json');\n   33: }"}}, {"message": "path.jo ... 'data')", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/life-cycle/utils.js", "start_line": 28, "start_column": 12, "end_line": null, "end_column": 40, "snippet": "   23: function generateNonce() {\n   24:     return crypto.randomBytes(32).toString('base64');\n   25: }\n   26: exports.generateNonce = generateNonce;\n   27: function getDataDirectory() {\n   28:     return path.join(__dirname, 'data');\n   29: }\n   30: exports.getDataDirectory = getDataDirectory;\n   31: function getLifeCycleFilePathInDirectory(directory) {\n   32:     return path.join(directory, 'life-cycle.json');\n   33: }"}}, {"message": "utils_1 ... ctory()", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/life-cycle/startup.js", "start_line": 76, "start_column": 47, "end_line": null, "end_column": 73, "snippet": "   71: }\n   72: exports.onStartUp = onStartUp;\n   73: function saveLifeCycleState(extensionContext, state) {\n   74:     return Promise.all([\n   75:         utils_1.saveLifeCycleStateInDirectory(extensionContext.globalStoragePath, state),\n   76:         utils_1.saveLifeCycleStateInDirectory(utils_1.getDataDirectory(), state)\n   77:     ]);\n   78: }\n   79: function getNonce() {\n   80:     return new Promise((resolve, reject) => {\n   81:         const dir = utils_1.getDataDirectory();"}}, {"message": "directory", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/life-cycle/utils.js", "start_line": 52, "start_column": 40, "end_line": null, "end_column": 49, "snippet": "   47:             }\n   48:         });\n   49:     });\n   50: }\n   51: exports.getLifeCycleStateInDirectory = getLifeCycleStateInDirectory;\n   52: function saveLifeCycleStateInDirectory(directory, state) {\n   53:     return new Promise((resolve, reject) => {\n   54:         fs.mkdir(directory, (err) => {\n   55:             if (!err || err.code === 'EEXIST') {\n   56:                 fs.writeFile(getLifeCycleFilePathInDirectory(directory), JSON.stringify(state), (err) => {\n   57:                     if (err) {"}}, {"message": "directory", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/life-cycle/utils.js", "start_line": 52, "start_column": 40, "end_line": null, "end_column": 49, "snippet": "   47:             }\n   48:         });\n   49:     });\n   50: }\n   51: exports.getLifeCycleStateInDirectory = getLifeCycleStateInDirectory;\n   52: function saveLifeCycleStateInDirectory(directory, state) {\n   53:     return new Promise((resolve, reject) => {\n   54:         fs.mkdir(directory, (err) => {\n   55:             if (!err || err.code === 'EEXIST') {\n   56:                 fs.writeFile(getLifeCycleFilePathInDirectory(directory), JSON.stringify(state), (err) => {\n   57:                     if (err) {"}}]}
{"result_index": 3, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 515, "start_column": 23, "end_line": null, "end_column": 27, "snippet": "  510:             }\n  511:         }\n  512:         return Promise.reject();\n  513:     });\n  514: }\n  515: function isExecutable(path) {\n  516:     return new Promise(resolve => {\n  517:         fs.stat(path, (err, stat) => {\n  518:             resolve(!err && (stat.isFile() || stat.isSymbolicLink()));\n  519:         });\n  520:     });"}, "source": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 502, "start_column": 22, "end_line": null, "end_column": 35, "snippet": "  497:         : Promise.reject();\n  498: }\n  499: function findGitWin32InPath() {\n  500:     return __awaiter(this, void 0, void 0, function* () {\n  501:         let dirs = (process.env['PATH'] || '').split(';');\n  502:         dirs.unshift(process.cwd());\n  503:         for (let i = 0; i < dirs.length; i++) {\n  504:             let file = path.join(dirs[i], 'git.exe');\n  505:             if (yield isExecutable(file)) {\n  506:                 try {\n  507:                     return yield getGitExecutable(file);"}, "path": [{"message": "process.cwd()", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 502, "start_column": 22, "end_line": null, "end_column": 35, "snippet": "  497:         : Promise.reject();\n  498: }\n  499: function findGitWin32InPath() {\n  500:     return __awaiter(this, void 0, void 0, function* () {\n  501:         let dirs = (process.env['PATH'] || '').split(';');\n  502:         dirs.unshift(process.cwd());\n  503:         for (let i = 0; i < dirs.length; i++) {\n  504:             let file = path.join(dirs[i], 'git.exe');\n  505:             if (yield isExecutable(file)) {\n  506:                 try {\n  507:                     return yield getGitExecutable(file);"}}, {"message": "dirs[i]", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 504, "start_column": 34, "end_line": null, "end_column": 41, "snippet": "  499: function findGitWin32InPath() {\n  500:     return __awaiter(this, void 0, void 0, function* () {\n  501:         let dirs = (process.env['PATH'] || '').split(';');\n  502:         dirs.unshift(process.cwd());\n  503:         for (let i = 0; i < dirs.length; i++) {\n  504:             let file = path.join(dirs[i], 'git.exe');\n  505:             if (yield isExecutable(file)) {\n  506:                 try {\n  507:                     return yield getGitExecutable(file);\n  508:                 }\n  509:                 catch (_) { }"}}, {"message": "path.jo ... t.exe')", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 504, "start_column": 24, "end_line": null, "end_column": 53, "snippet": "  499: function findGitWin32InPath() {\n  500:     return __awaiter(this, void 0, void 0, function* () {\n  501:         let dirs = (process.env['PATH'] || '').split(';');\n  502:         dirs.unshift(process.cwd());\n  503:         for (let i = 0; i < dirs.length; i++) {\n  504:             let file = path.join(dirs[i], 'git.exe');\n  505:             if (yield isExecutable(file)) {\n  506:                 try {\n  507:                     return yield getGitExecutable(file);\n  508:                 }\n  509:                 catch (_) { }"}}, {"message": "file", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 504, "start_column": 17, "end_line": null, "end_column": 53, "snippet": "  499: function findGitWin32InPath() {\n  500:     return __awaiter(this, void 0, void 0, function* () {\n  501:         let dirs = (process.env['PATH'] || '').split(';');\n  502:         dirs.unshift(process.cwd());\n  503:         for (let i = 0; i < dirs.length; i++) {\n  504:             let file = path.join(dirs[i], 'git.exe');\n  505:             if (yield isExecutable(file)) {\n  506:                 try {\n  507:                     return yield getGitExecutable(file);\n  508:                 }\n  509:                 catch (_) { }"}}, {"message": "file", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 505, "start_column": 36, "end_line": null, "end_column": 40, "snippet": "  500:     return __awaiter(this, void 0, void 0, function* () {\n  501:         let dirs = (process.env['PATH'] || '').split(';');\n  502:         dirs.unshift(process.cwd());\n  503:         for (let i = 0; i < dirs.length; i++) {\n  504:             let file = path.join(dirs[i], 'git.exe');\n  505:             if (yield isExecutable(file)) {\n  506:                 try {\n  507:                     return yield getGitExecutable(file);\n  508:                 }\n  509:                 catch (_) { }\n  510:             }"}}, {"message": "path", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 515, "start_column": 23, "end_line": null, "end_column": 27, "snippet": "  510:             }\n  511:         }\n  512:         return Promise.reject();\n  513:     });\n  514: }\n  515: function isExecutable(path) {\n  516:     return new Promise(resolve => {\n  517:         fs.stat(path, (err, stat) => {\n  518:             resolve(!err && (stat.isFile() || stat.isSymbolicLink()));\n  519:         });\n  520:     });"}}, {"message": "path", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 515, "start_column": 23, "end_line": null, "end_column": 27, "snippet": "  510:             }\n  511:         }\n  512:         return Promise.reject();\n  513:     });\n  514: }\n  515: function isExecutable(path) {\n  516:     return new Promise(resolve => {\n  517:         fs.stat(path, (err, stat) => {\n  518:             resolve(!err && (stat.isFile() || stat.isSymbolicLink()));\n  519:         });\n  520:     });"}}, {"message": "process.cwd()", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 502, "start_column": 22, "end_line": null, "end_column": 35, "snippet": "  497:         : Promise.reject();\n  498: }\n  499: function findGitWin32InPath() {\n  500:     return __awaiter(this, void 0, void 0, function* () {\n  501:         let dirs = (process.env['PATH'] || '').split(';');\n  502:         dirs.unshift(process.cwd());\n  503:         for (let i = 0; i < dirs.length; i++) {\n  504:             let file = path.join(dirs[i], 'git.exe');\n  505:             if (yield isExecutable(file)) {\n  506:                 try {\n  507:                     return yield getGitExecutable(file);"}}, {"message": "(proces ... it(';')", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 501, "start_column": 20, "end_line": null, "end_column": 58, "snippet": "  496:         ? getGitExecutable(path.join(pathBase, 'Git', 'cmd', 'git.exe'))\n  497:         : Promise.reject();\n  498: }\n  499: function findGitWin32InPath() {\n  500:     return __awaiter(this, void 0, void 0, function* () {\n  501:         let dirs = (process.env['PATH'] || '').split(';');\n  502:         dirs.unshift(process.cwd());\n  503:         for (let i = 0; i < dirs.length; i++) {\n  504:             let file = path.join(dirs[i], 'git.exe');\n  505:             if (yield isExecutable(file)) {\n  506:                 try {"}}, {"message": "dirs", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 501, "start_column": 13, "end_line": null, "end_column": 58, "snippet": "  496:         ? getGitExecutable(path.join(pathBase, 'Git', 'cmd', 'git.exe'))\n  497:         : Promise.reject();\n  498: }\n  499: function findGitWin32InPath() {\n  500:     return __awaiter(this, void 0, void 0, function* () {\n  501:         let dirs = (process.env['PATH'] || '').split(';');\n  502:         dirs.unshift(process.cwd());\n  503:         for (let i = 0; i < dirs.length; i++) {\n  504:             let file = path.join(dirs[i], 'git.exe');\n  505:             if (yield isExecutable(file)) {\n  506:                 try {"}}, {"message": "dirs", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 504, "start_column": 34, "end_line": null, "end_column": 38, "snippet": "  499: function findGitWin32InPath() {\n  500:     return __awaiter(this, void 0, void 0, function* () {\n  501:         let dirs = (process.env['PATH'] || '').split(';');\n  502:         dirs.unshift(process.cwd());\n  503:         for (let i = 0; i < dirs.length; i++) {\n  504:             let file = path.join(dirs[i], 'git.exe');\n  505:             if (yield isExecutable(file)) {\n  506:                 try {\n  507:                     return yield getGitExecutable(file);\n  508:                 }\n  509:                 catch (_) { }"}}, {"message": "dirs[i]", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 504, "start_column": 34, "end_line": null, "end_column": 41, "snippet": "  499: function findGitWin32InPath() {\n  500:     return __awaiter(this, void 0, void 0, function* () {\n  501:         let dirs = (process.env['PATH'] || '').split(';');\n  502:         dirs.unshift(process.cwd());\n  503:         for (let i = 0; i < dirs.length; i++) {\n  504:             let file = path.join(dirs[i], 'git.exe');\n  505:             if (yield isExecutable(file)) {\n  506:                 try {\n  507:                     return yield getGitExecutable(file);\n  508:                 }\n  509:                 catch (_) { }"}}, {"message": "path.jo ... t.exe')", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 504, "start_column": 24, "end_line": null, "end_column": 53, "snippet": "  499: function findGitWin32InPath() {\n  500:     return __awaiter(this, void 0, void 0, function* () {\n  501:         let dirs = (process.env['PATH'] || '').split(';');\n  502:         dirs.unshift(process.cwd());\n  503:         for (let i = 0; i < dirs.length; i++) {\n  504:             let file = path.join(dirs[i], 'git.exe');\n  505:             if (yield isExecutable(file)) {\n  506:                 try {\n  507:                     return yield getGitExecutable(file);\n  508:                 }\n  509:                 catch (_) { }"}}, {"message": "file", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 504, "start_column": 17, "end_line": null, "end_column": 53, "snippet": "  499: function findGitWin32InPath() {\n  500:     return __awaiter(this, void 0, void 0, function* () {\n  501:         let dirs = (process.env['PATH'] || '').split(';');\n  502:         dirs.unshift(process.cwd());\n  503:         for (let i = 0; i < dirs.length; i++) {\n  504:             let file = path.join(dirs[i], 'git.exe');\n  505:             if (yield isExecutable(file)) {\n  506:                 try {\n  507:                     return yield getGitExecutable(file);\n  508:                 }\n  509:                 catch (_) { }"}}, {"message": "file", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 505, "start_column": 36, "end_line": null, "end_column": 40, "snippet": "  500:     return __awaiter(this, void 0, void 0, function* () {\n  501:         let dirs = (process.env['PATH'] || '').split(';');\n  502:         dirs.unshift(process.cwd());\n  503:         for (let i = 0; i < dirs.length; i++) {\n  504:             let file = path.join(dirs[i], 'git.exe');\n  505:             if (yield isExecutable(file)) {\n  506:                 try {\n  507:                     return yield getGitExecutable(file);\n  508:                 }\n  509:                 catch (_) { }\n  510:             }"}}, {"message": "path", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 515, "start_column": 23, "end_line": null, "end_column": 27, "snippet": "  510:             }\n  511:         }\n  512:         return Promise.reject();\n  513:     });\n  514: }\n  515: function isExecutable(path) {\n  516:     return new Promise(resolve => {\n  517:         fs.stat(path, (err, stat) => {\n  518:             resolve(!err && (stat.isFile() || stat.isSymbolicLink()));\n  519:         });\n  520:     });"}}, {"message": "path", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 515, "start_column": 23, "end_line": null, "end_column": 27, "snippet": "  510:             }\n  511:         }\n  512:         return Promise.reject();\n  513:     });\n  514: }\n  515: function isExecutable(path) {\n  516:     return new Promise(resolve => {\n  517:         fs.stat(path, (err, stat) => {\n  518:             resolve(!err && (stat.isFile() || stat.isSymbolicLink()));\n  519:         });\n  520:     });"}}]}
{"result_index": 4, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 522, "start_column": 27, "end_line": null, "end_column": 31, "snippet": "  517:         fs.stat(path, (err, stat) => {\n  518:             resolve(!err && (stat.isFile() || stat.isSymbolicLink()));\n  519:         });\n  520:     });\n  521: }\n  522: function getGitExecutable(path) {\n  523:     return new Promise((resolve, reject) => {\n  524:         resolveSpawnOutput(cp.spawn(path, ['--version'])).then((values) => {\n  525:             if (values[0].code === 0) {\n  526:                 resolve({ path: path, version: values[1].toString().trim().replace(/^git version /, '') });\n  527:             }"}, "source": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 502, "start_column": 22, "end_line": null, "end_column": 35, "snippet": "  497:         : Promise.reject();\n  498: }\n  499: function findGitWin32InPath() {\n  500:     return __awaiter(this, void 0, void 0, function* () {\n  501:         let dirs = (process.env['PATH'] || '').split(';');\n  502:         dirs.unshift(process.cwd());\n  503:         for (let i = 0; i < dirs.length; i++) {\n  504:             let file = path.join(dirs[i], 'git.exe');\n  505:             if (yield isExecutable(file)) {\n  506:                 try {\n  507:                     return yield getGitExecutable(file);"}, "path": [{"message": "process.cwd()", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 502, "start_column": 22, "end_line": null, "end_column": 35, "snippet": "  497:         : Promise.reject();\n  498: }\n  499: function findGitWin32InPath() {\n  500:     return __awaiter(this, void 0, void 0, function* () {\n  501:         let dirs = (process.env['PATH'] || '').split(';');\n  502:         dirs.unshift(process.cwd());\n  503:         for (let i = 0; i < dirs.length; i++) {\n  504:             let file = path.join(dirs[i], 'git.exe');\n  505:             if (yield isExecutable(file)) {\n  506:                 try {\n  507:                     return yield getGitExecutable(file);"}}, {"message": "dirs[i]", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 504, "start_column": 34, "end_line": null, "end_column": 41, "snippet": "  499: function findGitWin32InPath() {\n  500:     return __awaiter(this, void 0, void 0, function* () {\n  501:         let dirs = (process.env['PATH'] || '').split(';');\n  502:         dirs.unshift(process.cwd());\n  503:         for (let i = 0; i < dirs.length; i++) {\n  504:             let file = path.join(dirs[i], 'git.exe');\n  505:             if (yield isExecutable(file)) {\n  506:                 try {\n  507:                     return yield getGitExecutable(file);\n  508:                 }\n  509:                 catch (_) { }"}}, {"message": "path.jo ... t.exe')", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 504, "start_column": 24, "end_line": null, "end_column": 53, "snippet": "  499: function findGitWin32InPath() {\n  500:     return __awaiter(this, void 0, void 0, function* () {\n  501:         let dirs = (process.env['PATH'] || '').split(';');\n  502:         dirs.unshift(process.cwd());\n  503:         for (let i = 0; i < dirs.length; i++) {\n  504:             let file = path.join(dirs[i], 'git.exe');\n  505:             if (yield isExecutable(file)) {\n  506:                 try {\n  507:                     return yield getGitExecutable(file);\n  508:                 }\n  509:                 catch (_) { }"}}, {"message": "file", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 504, "start_column": 17, "end_line": null, "end_column": 53, "snippet": "  499: function findGitWin32InPath() {\n  500:     return __awaiter(this, void 0, void 0, function* () {\n  501:         let dirs = (process.env['PATH'] || '').split(';');\n  502:         dirs.unshift(process.cwd());\n  503:         for (let i = 0; i < dirs.length; i++) {\n  504:             let file = path.join(dirs[i], 'git.exe');\n  505:             if (yield isExecutable(file)) {\n  506:                 try {\n  507:                     return yield getGitExecutable(file);\n  508:                 }\n  509:                 catch (_) { }"}}, {"message": "file", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 507, "start_column": 51, "end_line": null, "end_column": 55, "snippet": "  502:         dirs.unshift(process.cwd());\n  503:         for (let i = 0; i < dirs.length; i++) {\n  504:             let file = path.join(dirs[i], 'git.exe');\n  505:             if (yield isExecutable(file)) {\n  506:                 try {\n  507:                     return yield getGitExecutable(file);\n  508:                 }\n  509:                 catch (_) { }\n  510:             }\n  511:         }\n  512:         return Promise.reject();"}}, {"message": "path", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 522, "start_column": 27, "end_line": null, "end_column": 31, "snippet": "  517:         fs.stat(path, (err, stat) => {\n  518:             resolve(!err && (stat.isFile() || stat.isSymbolicLink()));\n  519:         });\n  520:     });\n  521: }\n  522: function getGitExecutable(path) {\n  523:     return new Promise((resolve, reject) => {\n  524:         resolveSpawnOutput(cp.spawn(path, ['--version'])).then((values) => {\n  525:             if (values[0].code === 0) {\n  526:                 resolve({ path: path, version: values[1].toString().trim().replace(/^git version /, '') });\n  527:             }"}}, {"message": "path", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 522, "start_column": 27, "end_line": null, "end_column": 31, "snippet": "  517:         fs.stat(path, (err, stat) => {\n  518:             resolve(!err && (stat.isFile() || stat.isSymbolicLink()));\n  519:         });\n  520:     });\n  521: }\n  522: function getGitExecutable(path) {\n  523:     return new Promise((resolve, reject) => {\n  524:         resolveSpawnOutput(cp.spawn(path, ['--version'])).then((values) => {\n  525:             if (values[0].code === 0) {\n  526:                 resolve({ path: path, version: values[1].toString().trim().replace(/^git version /, '') });\n  527:             }"}}, {"message": "process.cwd()", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 502, "start_column": 22, "end_line": null, "end_column": 35, "snippet": "  497:         : Promise.reject();\n  498: }\n  499: function findGitWin32InPath() {\n  500:     return __awaiter(this, void 0, void 0, function* () {\n  501:         let dirs = (process.env['PATH'] || '').split(';');\n  502:         dirs.unshift(process.cwd());\n  503:         for (let i = 0; i < dirs.length; i++) {\n  504:             let file = path.join(dirs[i], 'git.exe');\n  505:             if (yield isExecutable(file)) {\n  506:                 try {\n  507:                     return yield getGitExecutable(file);"}}, {"message": "(proces ... it(';')", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 501, "start_column": 20, "end_line": null, "end_column": 58, "snippet": "  496:         ? getGitExecutable(path.join(pathBase, 'Git', 'cmd', 'git.exe'))\n  497:         : Promise.reject();\n  498: }\n  499: function findGitWin32InPath() {\n  500:     return __awaiter(this, void 0, void 0, function* () {\n  501:         let dirs = (process.env['PATH'] || '').split(';');\n  502:         dirs.unshift(process.cwd());\n  503:         for (let i = 0; i < dirs.length; i++) {\n  504:             let file = path.join(dirs[i], 'git.exe');\n  505:             if (yield isExecutable(file)) {\n  506:                 try {"}}, {"message": "dirs", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 501, "start_column": 13, "end_line": null, "end_column": 58, "snippet": "  496:         ? getGitExecutable(path.join(pathBase, 'Git', 'cmd', 'git.exe'))\n  497:         : Promise.reject();\n  498: }\n  499: function findGitWin32InPath() {\n  500:     return __awaiter(this, void 0, void 0, function* () {\n  501:         let dirs = (process.env['PATH'] || '').split(';');\n  502:         dirs.unshift(process.cwd());\n  503:         for (let i = 0; i < dirs.length; i++) {\n  504:             let file = path.join(dirs[i], 'git.exe');\n  505:             if (yield isExecutable(file)) {\n  506:                 try {"}}, {"message": "dirs", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 504, "start_column": 34, "end_line": null, "end_column": 38, "snippet": "  499: function findGitWin32InPath() {\n  500:     return __awaiter(this, void 0, void 0, function* () {\n  501:         let dirs = (process.env['PATH'] || '').split(';');\n  502:         dirs.unshift(process.cwd());\n  503:         for (let i = 0; i < dirs.length; i++) {\n  504:             let file = path.join(dirs[i], 'git.exe');\n  505:             if (yield isExecutable(file)) {\n  506:                 try {\n  507:                     return yield getGitExecutable(file);\n  508:                 }\n  509:                 catch (_) { }"}}, {"message": "dirs[i]", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 504, "start_column": 34, "end_line": null, "end_column": 41, "snippet": "  499: function findGitWin32InPath() {\n  500:     return __awaiter(this, void 0, void 0, function* () {\n  501:         let dirs = (process.env['PATH'] || '').split(';');\n  502:         dirs.unshift(process.cwd());\n  503:         for (let i = 0; i < dirs.length; i++) {\n  504:             let file = path.join(dirs[i], 'git.exe');\n  505:             if (yield isExecutable(file)) {\n  506:                 try {\n  507:                     return yield getGitExecutable(file);\n  508:                 }\n  509:                 catch (_) { }"}}, {"message": "path.jo ... t.exe')", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 504, "start_column": 24, "end_line": null, "end_column": 53, "snippet": "  499: function findGitWin32InPath() {\n  500:     return __awaiter(this, void 0, void 0, function* () {\n  501:         let dirs = (process.env['PATH'] || '').split(';');\n  502:         dirs.unshift(process.cwd());\n  503:         for (let i = 0; i < dirs.length; i++) {\n  504:             let file = path.join(dirs[i], 'git.exe');\n  505:             if (yield isExecutable(file)) {\n  506:                 try {\n  507:                     return yield getGitExecutable(file);\n  508:                 }\n  509:                 catch (_) { }"}}, {"message": "file", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 504, "start_column": 17, "end_line": null, "end_column": 53, "snippet": "  499: function findGitWin32InPath() {\n  500:     return __awaiter(this, void 0, void 0, function* () {\n  501:         let dirs = (process.env['PATH'] || '').split(';');\n  502:         dirs.unshift(process.cwd());\n  503:         for (let i = 0; i < dirs.length; i++) {\n  504:             let file = path.join(dirs[i], 'git.exe');\n  505:             if (yield isExecutable(file)) {\n  506:                 try {\n  507:                     return yield getGitExecutable(file);\n  508:                 }\n  509:                 catch (_) { }"}}, {"message": "file", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 507, "start_column": 51, "end_line": null, "end_column": 55, "snippet": "  502:         dirs.unshift(process.cwd());\n  503:         for (let i = 0; i < dirs.length; i++) {\n  504:             let file = path.join(dirs[i], 'git.exe');\n  505:             if (yield isExecutable(file)) {\n  506:                 try {\n  507:                     return yield getGitExecutable(file);\n  508:                 }\n  509:                 catch (_) { }\n  510:             }\n  511:         }\n  512:         return Promise.reject();"}}, {"message": "path", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 522, "start_column": 27, "end_line": null, "end_column": 31, "snippet": "  517:         fs.stat(path, (err, stat) => {\n  518:             resolve(!err && (stat.isFile() || stat.isSymbolicLink()));\n  519:         });\n  520:     });\n  521: }\n  522: function getGitExecutable(path) {\n  523:     return new Promise((resolve, reject) => {\n  524:         resolveSpawnOutput(cp.spawn(path, ['--version'])).then((values) => {\n  525:             if (values[0].code === 0) {\n  526:                 resolve({ path: path, version: values[1].toString().trim().replace(/^git version /, '') });\n  527:             }"}}, {"message": "path", "location": {"uri": "home/etlin/data/download_packages/mhutchie.git-graph-1.30.0/extension/out/utils.js", "start_line": 522, "start_column": 27, "end_line": null, "end_column": 31, "snippet": "  517:         fs.stat(path, (err, stat) => {\n  518:             resolve(!err && (stat.isFile() || stat.isSymbolicLink()));\n  519:         });\n  520:     });\n  521: }\n  522: function getGitExecutable(path) {\n  523:     return new Promise((resolve, reject) => {\n  524:         resolveSpawnOutput(cp.spawn(path, ['--version'])).then((values) => {\n  525:             if (values[0].code === 0) {\n  526:                 resolve({ path: path, version: values[1].toString().trim().replace(/^git version /, '') });\n  527:             }"}}]}
