{"result_index": 0, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.\n(Experimental) This shell command depends on [an uncontrolled value](2). Identified using machine learning.\n(Experimental) This shell command depends on [an uncontrolled value](3). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/download.js", "start_line": 63, "start_column": 41, "end_line": null, "end_column": 57, "snippet": "   58:             }\n   59:             return resolve(res);\n   60:         });\n   61:     });\n   62: }\n   63: function go(flavor, platform, fileName, installDirectory, fileManager, log, proxy, strictSSL) {\n   64:     return new Promise((resolve, reject) => {\n   65:         // log = log || ((_ )=> { });\n   66:         let logger = logger_1.Logger.getLogger('ADL (Storage)');\n   67:         installDirectory = installDirectory || extension_1.getInstallDirectory(flavor);\n   68:         fileManager = fileManager;"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 1910, "start_column": 32, "end_line": null, "end_column": 41, "snippet": " 1905:     shutdownLanguageService();\n 1906:     shutdownDataLakeService();\n 1907: }\n 1908: exports.deactivate = deactivate;\n 1909: function getInstallDirectory(flavor) {\n 1910:     const basePath = path.join(__dirname, '..', '..', 'scopecompiler');\n 1911:     console.log(basePath);\n 1912:     switch (flavor) {\n 1913:         case platform_1.Flavor.CoreCLR:\n 1914:             return basePath + '-coreclr';\n 1915:         case platform_1.Flavor.Desktop:"}, "path": [{"message": "__dirname", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 1910, "start_column": 32, "end_line": null, "end_column": 41, "snippet": " 1905:     shutdownLanguageService();\n 1906:     shutdownDataLakeService();\n 1907: }\n 1908: exports.deactivate = deactivate;\n 1909: function getInstallDirectory(flavor) {\n 1910:     const basePath = path.join(__dirname, '..', '..', 'scopecompiler');\n 1911:     console.log(basePath);\n 1912:     switch (flavor) {\n 1913:         case platform_1.Flavor.CoreCLR:\n 1914:             return basePath + '-coreclr';\n 1915:         case platform_1.Flavor.Desktop:"}}, {"message": "path.jo ... piler')", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 1910, "start_column": 22, "end_line": null, "end_column": 71, "snippet": " 1905:     shutdownLanguageService();\n 1906:     shutdownDataLakeService();\n 1907: }\n 1908: exports.deactivate = deactivate;\n 1909: function getInstallDirectory(flavor) {\n 1910:     const basePath = path.join(__dirname, '..', '..', 'scopecompiler');\n 1911:     console.log(basePath);\n 1912:     switch (flavor) {\n 1913:         case platform_1.Flavor.CoreCLR:\n 1914:             return basePath + '-coreclr';\n 1915:         case platform_1.Flavor.Desktop:"}}, {"message": "basePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 1910, "start_column": 11, "end_line": null, "end_column": 71, "snippet": " 1905:     shutdownLanguageService();\n 1906:     shutdownDataLakeService();\n 1907: }\n 1908: exports.deactivate = deactivate;\n 1909: function getInstallDirectory(flavor) {\n 1910:     const basePath = path.join(__dirname, '..', '..', 'scopecompiler');\n 1911:     console.log(basePath);\n 1912:     switch (flavor) {\n 1913:         case platform_1.Flavor.CoreCLR:\n 1914:             return basePath + '-coreclr';\n 1915:         case platform_1.Flavor.Desktop:"}}, {"message": "basePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 1914, "start_column": 20, "end_line": null, "end_column": 28, "snippet": " 1909: function getInstallDirectory(flavor) {\n 1910:     const basePath = path.join(__dirname, '..', '..', 'scopecompiler');\n 1911:     console.log(basePath);\n 1912:     switch (flavor) {\n 1913:         case platform_1.Flavor.CoreCLR:\n 1914:             return basePath + '-coreclr';\n 1915:         case platform_1.Flavor.Desktop:\n 1916:             return basePath + '-desktop';\n 1917:         case platform_1.Flavor.Mono:\n 1918:             return basePath + '-mono';\n 1919:         default:"}}, {"message": "basePat ... oreclr'", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 1914, "start_column": 20, "end_line": null, "end_column": 41, "snippet": " 1909: function getInstallDirectory(flavor) {\n 1910:     const basePath = path.join(__dirname, '..', '..', 'scopecompiler');\n 1911:     console.log(basePath);\n 1912:     switch (flavor) {\n 1913:         case platform_1.Flavor.CoreCLR:\n 1914:             return basePath + '-coreclr';\n 1915:         case platform_1.Flavor.Desktop:\n 1916:             return basePath + '-desktop';\n 1917:         case platform_1.Flavor.Mono:\n 1918:             return basePath + '-mono';\n 1919:         default:"}}, {"message": "extensi ... flavor)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/download.js", "start_line": 67, "start_column": 48, "end_line": null, "end_column": 87, "snippet": "   62: }\n   63: function go(flavor, platform, fileName, installDirectory, fileManager, log, proxy, strictSSL) {\n   64:     return new Promise((resolve, reject) => {\n   65:         // log = log || ((_ )=> { });\n   66:         let logger = logger_1.Logger.getLogger('ADL (Storage)');\n   67:         installDirectory = installDirectory || extension_1.getInstallDirectory(flavor);\n   68:         fileManager = fileManager;\n   69:         console.log(`Flavor: ${flavor}, Platform: ${platform}`);\n   70:         console.log(`[INFO] Installing ${fileName} to ${installDirectory}`);\n   71:         logger.log(`Installing ${fileName} to ${installDirectory}`);\n   72:         const urlString = fileManager.getDownloadUrl(fileName);"}}, {"message": "install ... flavor)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/download.js", "start_line": 67, "start_column": 28, "end_line": null, "end_column": 87, "snippet": "   62: }\n   63: function go(flavor, platform, fileName, installDirectory, fileManager, log, proxy, strictSSL) {\n   64:     return new Promise((resolve, reject) => {\n   65:         // log = log || ((_ )=> { });\n   66:         let logger = logger_1.Logger.getLogger('ADL (Storage)');\n   67:         installDirectory = installDirectory || extension_1.getInstallDirectory(flavor);\n   68:         fileManager = fileManager;\n   69:         console.log(`Flavor: ${flavor}, Platform: ${platform}`);\n   70:         console.log(`[INFO] Installing ${fileName} to ${installDirectory}`);\n   71:         logger.log(`Installing ${fileName} to ${installDirectory}`);\n   72:         const urlString = fileManager.getDownloadUrl(fileName);"}}, {"message": "installDirectory", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/download.js", "start_line": 67, "start_column": 9, "end_line": null, "end_column": 87, "snippet": "   62: }\n   63: function go(flavor, platform, fileName, installDirectory, fileManager, log, proxy, strictSSL) {\n   64:     return new Promise((resolve, reject) => {\n   65:         // log = log || ((_ )=> { });\n   66:         let logger = logger_1.Logger.getLogger('ADL (Storage)');\n   67:         installDirectory = installDirectory || extension_1.getInstallDirectory(flavor);\n   68:         fileManager = fileManager;\n   69:         console.log(`Flavor: ${flavor}, Platform: ${platform}`);\n   70:         console.log(`[INFO] Installing ${fileName} to ${installDirectory}`);\n   71:         logger.log(`Installing ${fileName} to ${installDirectory}`);\n   72:         const urlString = fileManager.getDownloadUrl(fileName);"}}, {"message": "installDirectory", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/download.js", "start_line": 63, "start_column": 41, "end_line": null, "end_column": 57, "snippet": "   58:             }\n   59:             return resolve(res);\n   60:         });\n   61:     });\n   62: }\n   63: function go(flavor, platform, fileName, installDirectory, fileManager, log, proxy, strictSSL) {\n   64:     return new Promise((resolve, reject) => {\n   65:         // log = log || ((_ )=> { });\n   66:         let logger = logger_1.Logger.getLogger('ADL (Storage)');\n   67:         installDirectory = installDirectory || extension_1.getInstallDirectory(flavor);\n   68:         fileManager = fileManager;"}}, {"message": "__dirname", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 1910, "start_column": 32, "end_line": null, "end_column": 41, "snippet": " 1905:     shutdownLanguageService();\n 1906:     shutdownDataLakeService();\n 1907: }\n 1908: exports.deactivate = deactivate;\n 1909: function getInstallDirectory(flavor) {\n 1910:     const basePath = path.join(__dirname, '..', '..', 'scopecompiler');\n 1911:     console.log(basePath);\n 1912:     switch (flavor) {\n 1913:         case platform_1.Flavor.CoreCLR:\n 1914:             return basePath + '-coreclr';\n 1915:         case platform_1.Flavor.Desktop:"}}, {"message": "path.jo ... piler')", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 1910, "start_column": 22, "end_line": null, "end_column": 71, "snippet": " 1905:     shutdownLanguageService();\n 1906:     shutdownDataLakeService();\n 1907: }\n 1908: exports.deactivate = deactivate;\n 1909: function getInstallDirectory(flavor) {\n 1910:     const basePath = path.join(__dirname, '..', '..', 'scopecompiler');\n 1911:     console.log(basePath);\n 1912:     switch (flavor) {\n 1913:         case platform_1.Flavor.CoreCLR:\n 1914:             return basePath + '-coreclr';\n 1915:         case platform_1.Flavor.Desktop:"}}, {"message": "basePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 1910, "start_column": 11, "end_line": null, "end_column": 71, "snippet": " 1905:     shutdownLanguageService();\n 1906:     shutdownDataLakeService();\n 1907: }\n 1908: exports.deactivate = deactivate;\n 1909: function getInstallDirectory(flavor) {\n 1910:     const basePath = path.join(__dirname, '..', '..', 'scopecompiler');\n 1911:     console.log(basePath);\n 1912:     switch (flavor) {\n 1913:         case platform_1.Flavor.CoreCLR:\n 1914:             return basePath + '-coreclr';\n 1915:         case platform_1.Flavor.Desktop:"}}, {"message": "basePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 1916, "start_column": 20, "end_line": null, "end_column": 28, "snippet": " 1911:     console.log(basePath);\n 1912:     switch (flavor) {\n 1913:         case platform_1.Flavor.CoreCLR:\n 1914:             return basePath + '-coreclr';\n 1915:         case platform_1.Flavor.Desktop:\n 1916:             return basePath + '-desktop';\n 1917:         case platform_1.Flavor.Mono:\n 1918:             return basePath + '-mono';\n 1919:         default:\n 1920:             throw new Error(`Unexpected flavor specified: ${flavor}`);\n 1921:     }"}}, {"message": "basePat ... esktop'", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 1916, "start_column": 20, "end_line": null, "end_column": 41, "snippet": " 1911:     console.log(basePath);\n 1912:     switch (flavor) {\n 1913:         case platform_1.Flavor.CoreCLR:\n 1914:             return basePath + '-coreclr';\n 1915:         case platform_1.Flavor.Desktop:\n 1916:             return basePath + '-desktop';\n 1917:         case platform_1.Flavor.Mono:\n 1918:             return basePath + '-mono';\n 1919:         default:\n 1920:             throw new Error(`Unexpected flavor specified: ${flavor}`);\n 1921:     }"}}, {"message": "extensi ... flavor)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/download.js", "start_line": 67, "start_column": 48, "end_line": null, "end_column": 87, "snippet": "   62: }\n   63: function go(flavor, platform, fileName, installDirectory, fileManager, log, proxy, strictSSL) {\n   64:     return new Promise((resolve, reject) => {\n   65:         // log = log || ((_ )=> { });\n   66:         let logger = logger_1.Logger.getLogger('ADL (Storage)');\n   67:         installDirectory = installDirectory || extension_1.getInstallDirectory(flavor);\n   68:         fileManager = fileManager;\n   69:         console.log(`Flavor: ${flavor}, Platform: ${platform}`);\n   70:         console.log(`[INFO] Installing ${fileName} to ${installDirectory}`);\n   71:         logger.log(`Installing ${fileName} to ${installDirectory}`);\n   72:         const urlString = fileManager.getDownloadUrl(fileName);"}}, {"message": "install ... flavor)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/download.js", "start_line": 67, "start_column": 28, "end_line": null, "end_column": 87, "snippet": "   62: }\n   63: function go(flavor, platform, fileName, installDirectory, fileManager, log, proxy, strictSSL) {\n   64:     return new Promise((resolve, reject) => {\n   65:         // log = log || ((_ )=> { });\n   66:         let logger = logger_1.Logger.getLogger('ADL (Storage)');\n   67:         installDirectory = installDirectory || extension_1.getInstallDirectory(flavor);\n   68:         fileManager = fileManager;\n   69:         console.log(`Flavor: ${flavor}, Platform: ${platform}`);\n   70:         console.log(`[INFO] Installing ${fileName} to ${installDirectory}`);\n   71:         logger.log(`Installing ${fileName} to ${installDirectory}`);\n   72:         const urlString = fileManager.getDownloadUrl(fileName);"}}, {"message": "installDirectory", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/download.js", "start_line": 67, "start_column": 9, "end_line": null, "end_column": 87, "snippet": "   62: }\n   63: function go(flavor, platform, fileName, installDirectory, fileManager, log, proxy, strictSSL) {\n   64:     return new Promise((resolve, reject) => {\n   65:         // log = log || ((_ )=> { });\n   66:         let logger = logger_1.Logger.getLogger('ADL (Storage)');\n   67:         installDirectory = installDirectory || extension_1.getInstallDirectory(flavor);\n   68:         fileManager = fileManager;\n   69:         console.log(`Flavor: ${flavor}, Platform: ${platform}`);\n   70:         console.log(`[INFO] Installing ${fileName} to ${installDirectory}`);\n   71:         logger.log(`Installing ${fileName} to ${installDirectory}`);\n   72:         const urlString = fileManager.getDownloadUrl(fileName);"}}, {"message": "installDirectory", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/download.js", "start_line": 63, "start_column": 41, "end_line": null, "end_column": 57, "snippet": "   58:             }\n   59:             return resolve(res);\n   60:         });\n   61:     });\n   62: }\n   63: function go(flavor, platform, fileName, installDirectory, fileManager, log, proxy, strictSSL) {\n   64:     return new Promise((resolve, reject) => {\n   65:         // log = log || ((_ )=> { });\n   66:         let logger = logger_1.Logger.getLogger('ADL (Storage)');\n   67:         installDirectory = installDirectory || extension_1.getInstallDirectory(flavor);\n   68:         fileManager = fileManager;"}}, {"message": "__dirname", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/fileManager.js", "start_line": 71, "start_column": 30, "end_line": null, "end_column": 39, "snippet": "   66:     getInstallDirectory(fileId) {\n   67:         var fileItem = this.fileList.find(t => t.FileId == fileId);\n   68:         if (fileItem.Runtime != \"\") {\n   69:             // Append runtime to installation directory\n   70:             var directory = fileItem.FileId + (platform.getFlavoredVersion() == platform.Flavor.Mono ? \"-mono\" : \"-desktop\");\n   71:             return path.join(__dirname, '..', '..', directory);\n   72:         }\n   73:         else {\n   74:             return path.join(__dirname, '..', '..', fileItem.FileId);\n   75:         }\n   76:     }"}}, {"message": "path.jo ... ectory)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/fileManager.js", "start_line": 71, "start_column": 20, "end_line": null, "end_column": 63, "snippet": "   66:     getInstallDirectory(fileId) {\n   67:         var fileItem = this.fileList.find(t => t.FileId == fileId);\n   68:         if (fileItem.Runtime != \"\") {\n   69:             // Append runtime to installation directory\n   70:             var directory = fileItem.FileId + (platform.getFlavoredVersion() == platform.Flavor.Mono ? \"-mono\" : \"-desktop\");\n   71:             return path.join(__dirname, '..', '..', directory);\n   72:         }\n   73:         else {\n   74:             return path.join(__dirname, '..', '..', fileItem.FileId);\n   75:         }\n   76:     }"}}, {"message": "_fileMa ... FileId)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 1931, "start_column": 153, "end_line": null, "end_column": 202, "snippet": " 1926:         if (fs.existsSync(path.join(_fileManager.getInstallDirectory(_dataLakeFileId), _dataLakeExecutableName))) {\n 1927:             _fileManager.completeCheckDependency(_fileManager.getFileNamebyId(_dataLakeFileId));\n 1928:             return (resolve());\n 1929:         }\n 1930:         else {\n 1931:             return resolve(download.go(platform_1.getFlavoredVersion(), platform_1.getCurrentPlatform(), _fileManager.getFileNamebyId(_dataLakeFileId), _fileManager.getInstallDirectory(_dataLakeFileId), _fileManager, null, _proxySetting));\n 1932:         }\n 1933:     });\n 1934: }\n 1935: function resolveLanguageServicePackages() {\n 1936:     return new Promise((resolve, reject) => {"}}, {"message": "installDirectory", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/download.js", "start_line": 63, "start_column": 41, "end_line": null, "end_column": 57, "snippet": "   58:             }\n   59:             return resolve(res);\n   60:         });\n   61:     });\n   62: }\n   63: function go(flavor, platform, fileName, installDirectory, fileManager, log, proxy, strictSSL) {\n   64:     return new Promise((resolve, reject) => {\n   65:         // log = log || ((_ )=> { });\n   66:         let logger = logger_1.Logger.getLogger('ADL (Storage)');\n   67:         installDirectory = installDirectory || extension_1.getInstallDirectory(flavor);\n   68:         fileManager = fileManager;"}}, {"message": "installDirectory", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/download.js", "start_line": 63, "start_column": 41, "end_line": null, "end_column": 57, "snippet": "   58:             }\n   59:             return resolve(res);\n   60:         });\n   61:     });\n   62: }\n   63: function go(flavor, platform, fileName, installDirectory, fileManager, log, proxy, strictSSL) {\n   64:     return new Promise((resolve, reject) => {\n   65:         // log = log || ((_ )=> { });\n   66:         let logger = logger_1.Logger.getLogger('ADL (Storage)');\n   67:         installDirectory = installDirectory || extension_1.getInstallDirectory(flavor);\n   68:         fileManager = fileManager;"}}, {"message": "__dirname", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/fileManager.js", "start_line": 74, "start_column": 30, "end_line": null, "end_column": 39, "snippet": "   69:             // Append runtime to installation directory\n   70:             var directory = fileItem.FileId + (platform.getFlavoredVersion() == platform.Flavor.Mono ? \"-mono\" : \"-desktop\");\n   71:             return path.join(__dirname, '..', '..', directory);\n   72:         }\n   73:         else {\n   74:             return path.join(__dirname, '..', '..', fileItem.FileId);\n   75:         }\n   76:     }\n   77:     isAllDependencyFulfilled() {\n   78:         this.fileList.forEach(element => {\n   79:             var fileName = path.join(this.getInstallDirectory(element.FileId), element.ExecutableFileName);"}}, {"message": "path.jo ... FileId)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/fileManager.js", "start_line": 74, "start_column": 20, "end_line": null, "end_column": 69, "snippet": "   69:             // Append runtime to installation directory\n   70:             var directory = fileItem.FileId + (platform.getFlavoredVersion() == platform.Flavor.Mono ? \"-mono\" : \"-desktop\");\n   71:             return path.join(__dirname, '..', '..', directory);\n   72:         }\n   73:         else {\n   74:             return path.join(__dirname, '..', '..', fileItem.FileId);\n   75:         }\n   76:     }\n   77:     isAllDependencyFulfilled() {\n   78:         this.fileList.forEach(element => {\n   79:             var fileName = path.join(this.getInstallDirectory(element.FileId), element.ExecutableFileName);"}}, {"message": "_fileMa ... FileId)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 1931, "start_column": 153, "end_line": null, "end_column": 202, "snippet": " 1926:         if (fs.existsSync(path.join(_fileManager.getInstallDirectory(_dataLakeFileId), _dataLakeExecutableName))) {\n 1927:             _fileManager.completeCheckDependency(_fileManager.getFileNamebyId(_dataLakeFileId));\n 1928:             return (resolve());\n 1929:         }\n 1930:         else {\n 1931:             return resolve(download.go(platform_1.getFlavoredVersion(), platform_1.getCurrentPlatform(), _fileManager.getFileNamebyId(_dataLakeFileId), _fileManager.getInstallDirectory(_dataLakeFileId), _fileManager, null, _proxySetting));\n 1932:         }\n 1933:     });\n 1934: }\n 1935: function resolveLanguageServicePackages() {\n 1936:     return new Promise((resolve, reject) => {"}}, {"message": "installDirectory", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/download.js", "start_line": 63, "start_column": 41, "end_line": null, "end_column": 57, "snippet": "   58:             }\n   59:             return resolve(res);\n   60:         });\n   61:     });\n   62: }\n   63: function go(flavor, platform, fileName, installDirectory, fileManager, log, proxy, strictSSL) {\n   64:     return new Promise((resolve, reject) => {\n   65:         // log = log || ((_ )=> { });\n   66:         let logger = logger_1.Logger.getLogger('ADL (Storage)');\n   67:         installDirectory = installDirectory || extension_1.getInstallDirectory(flavor);\n   68:         fileManager = fileManager;"}}, {"message": "installDirectory", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/download.js", "start_line": 63, "start_column": 41, "end_line": null, "end_column": 57, "snippet": "   58:             }\n   59:             return resolve(res);\n   60:         });\n   61:     });\n   62: }\n   63: function go(flavor, platform, fileName, installDirectory, fileManager, log, proxy, strictSSL) {\n   64:     return new Promise((resolve, reject) => {\n   65:         // log = log || ((_ )=> { });\n   66:         let logger = logger_1.Logger.getLogger('ADL (Storage)');\n   67:         installDirectory = installDirectory || extension_1.getInstallDirectory(flavor);\n   68:         fileManager = fileManager;"}}]}
{"result_index": 1, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.\n(Experimental) This shell command depends on [an uncontrolled value](2). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 250, "start_column": 11, "end_line": null, "end_column": 17, "snippet": "  245:         charset: 'alphabetic',\n  246:         length: 12,\n  247:     });\n  248:     _dataLakeRuntimeFolder = path.join(tempFolder, folder);\n  249:     fs.mkdirSync(_dataLakeRuntimeFolder);\n  250:     const source = _fileManager.getInstallDirectory(_dataLakeFileId);\n  251:     const copyFileList = fs.readdirSync(source);\n  252:     const promises = copyFileList.map((file) => {\n  253:         return fspromise.writeFileAsync(path.join(_dataLakeRuntimeFolder, file), fspromise.readFileSync(path.join(source, file)));\n  254:     });\n  255:     // fs.readdirSync(source).forEach(file => {"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/fileManager.js", "start_line": 71, "start_column": 30, "end_line": null, "end_column": 39, "snippet": "   66:     getInstallDirectory(fileId) {\n   67:         var fileItem = this.fileList.find(t => t.FileId == fileId);\n   68:         if (fileItem.Runtime != \"\") {\n   69:             // Append runtime to installation directory\n   70:             var directory = fileItem.FileId + (platform.getFlavoredVersion() == platform.Flavor.Mono ? \"-mono\" : \"-desktop\");\n   71:             return path.join(__dirname, '..', '..', directory);\n   72:         }\n   73:         else {\n   74:             return path.join(__dirname, '..', '..', fileItem.FileId);\n   75:         }\n   76:     }"}, "path": [{"message": "__dirname", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/fileManager.js", "start_line": 71, "start_column": 30, "end_line": null, "end_column": 39, "snippet": "   66:     getInstallDirectory(fileId) {\n   67:         var fileItem = this.fileList.find(t => t.FileId == fileId);\n   68:         if (fileItem.Runtime != \"\") {\n   69:             // Append runtime to installation directory\n   70:             var directory = fileItem.FileId + (platform.getFlavoredVersion() == platform.Flavor.Mono ? \"-mono\" : \"-desktop\");\n   71:             return path.join(__dirname, '..', '..', directory);\n   72:         }\n   73:         else {\n   74:             return path.join(__dirname, '..', '..', fileItem.FileId);\n   75:         }\n   76:     }"}}, {"message": "path.jo ... ectory)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/fileManager.js", "start_line": 71, "start_column": 20, "end_line": null, "end_column": 63, "snippet": "   66:     getInstallDirectory(fileId) {\n   67:         var fileItem = this.fileList.find(t => t.FileId == fileId);\n   68:         if (fileItem.Runtime != \"\") {\n   69:             // Append runtime to installation directory\n   70:             var directory = fileItem.FileId + (platform.getFlavoredVersion() == platform.Flavor.Mono ? \"-mono\" : \"-desktop\");\n   71:             return path.join(__dirname, '..', '..', directory);\n   72:         }\n   73:         else {\n   74:             return path.join(__dirname, '..', '..', fileItem.FileId);\n   75:         }\n   76:     }"}}, {"message": "_fileMa ... FileId)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 250, "start_column": 20, "end_line": null, "end_column": 69, "snippet": "  245:         charset: 'alphabetic',\n  246:         length: 12,\n  247:     });\n  248:     _dataLakeRuntimeFolder = path.join(tempFolder, folder);\n  249:     fs.mkdirSync(_dataLakeRuntimeFolder);\n  250:     const source = _fileManager.getInstallDirectory(_dataLakeFileId);\n  251:     const copyFileList = fs.readdirSync(source);\n  252:     const promises = copyFileList.map((file) => {\n  253:         return fspromise.writeFileAsync(path.join(_dataLakeRuntimeFolder, file), fspromise.readFileSync(path.join(source, file)));\n  254:     });\n  255:     // fs.readdirSync(source).forEach(file => {"}}, {"message": "source", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 250, "start_column": 11, "end_line": null, "end_column": 69, "snippet": "  245:         charset: 'alphabetic',\n  246:         length: 12,\n  247:     });\n  248:     _dataLakeRuntimeFolder = path.join(tempFolder, folder);\n  249:     fs.mkdirSync(_dataLakeRuntimeFolder);\n  250:     const source = _fileManager.getInstallDirectory(_dataLakeFileId);\n  251:     const copyFileList = fs.readdirSync(source);\n  252:     const promises = copyFileList.map((file) => {\n  253:         return fspromise.writeFileAsync(path.join(_dataLakeRuntimeFolder, file), fspromise.readFileSync(path.join(source, file)));\n  254:     });\n  255:     // fs.readdirSync(source).forEach(file => {"}}, {"message": "source", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 250, "start_column": 11, "end_line": null, "end_column": 17, "snippet": "  245:         charset: 'alphabetic',\n  246:         length: 12,\n  247:     });\n  248:     _dataLakeRuntimeFolder = path.join(tempFolder, folder);\n  249:     fs.mkdirSync(_dataLakeRuntimeFolder);\n  250:     const source = _fileManager.getInstallDirectory(_dataLakeFileId);\n  251:     const copyFileList = fs.readdirSync(source);\n  252:     const promises = copyFileList.map((file) => {\n  253:         return fspromise.writeFileAsync(path.join(_dataLakeRuntimeFolder, file), fspromise.readFileSync(path.join(source, file)));\n  254:     });\n  255:     // fs.readdirSync(source).forEach(file => {"}}, {"message": "__dirname", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/fileManager.js", "start_line": 74, "start_column": 30, "end_line": null, "end_column": 39, "snippet": "   69:             // Append runtime to installation directory\n   70:             var directory = fileItem.FileId + (platform.getFlavoredVersion() == platform.Flavor.Mono ? \"-mono\" : \"-desktop\");\n   71:             return path.join(__dirname, '..', '..', directory);\n   72:         }\n   73:         else {\n   74:             return path.join(__dirname, '..', '..', fileItem.FileId);\n   75:         }\n   76:     }\n   77:     isAllDependencyFulfilled() {\n   78:         this.fileList.forEach(element => {\n   79:             var fileName = path.join(this.getInstallDirectory(element.FileId), element.ExecutableFileName);"}}, {"message": "path.jo ... FileId)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/fileManager.js", "start_line": 74, "start_column": 20, "end_line": null, "end_column": 69, "snippet": "   69:             // Append runtime to installation directory\n   70:             var directory = fileItem.FileId + (platform.getFlavoredVersion() == platform.Flavor.Mono ? \"-mono\" : \"-desktop\");\n   71:             return path.join(__dirname, '..', '..', directory);\n   72:         }\n   73:         else {\n   74:             return path.join(__dirname, '..', '..', fileItem.FileId);\n   75:         }\n   76:     }\n   77:     isAllDependencyFulfilled() {\n   78:         this.fileList.forEach(element => {\n   79:             var fileName = path.join(this.getInstallDirectory(element.FileId), element.ExecutableFileName);"}}, {"message": "_fileMa ... FileId)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 250, "start_column": 20, "end_line": null, "end_column": 69, "snippet": "  245:         charset: 'alphabetic',\n  246:         length: 12,\n  247:     });\n  248:     _dataLakeRuntimeFolder = path.join(tempFolder, folder);\n  249:     fs.mkdirSync(_dataLakeRuntimeFolder);\n  250:     const source = _fileManager.getInstallDirectory(_dataLakeFileId);\n  251:     const copyFileList = fs.readdirSync(source);\n  252:     const promises = copyFileList.map((file) => {\n  253:         return fspromise.writeFileAsync(path.join(_dataLakeRuntimeFolder, file), fspromise.readFileSync(path.join(source, file)));\n  254:     });\n  255:     // fs.readdirSync(source).forEach(file => {"}}, {"message": "source", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 250, "start_column": 11, "end_line": null, "end_column": 69, "snippet": "  245:         charset: 'alphabetic',\n  246:         length: 12,\n  247:     });\n  248:     _dataLakeRuntimeFolder = path.join(tempFolder, folder);\n  249:     fs.mkdirSync(_dataLakeRuntimeFolder);\n  250:     const source = _fileManager.getInstallDirectory(_dataLakeFileId);\n  251:     const copyFileList = fs.readdirSync(source);\n  252:     const promises = copyFileList.map((file) => {\n  253:         return fspromise.writeFileAsync(path.join(_dataLakeRuntimeFolder, file), fspromise.readFileSync(path.join(source, file)));\n  254:     });\n  255:     // fs.readdirSync(source).forEach(file => {"}}, {"message": "source", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 250, "start_column": 11, "end_line": null, "end_column": 17, "snippet": "  245:         charset: 'alphabetic',\n  246:         length: 12,\n  247:     });\n  248:     _dataLakeRuntimeFolder = path.join(tempFolder, folder);\n  249:     fs.mkdirSync(_dataLakeRuntimeFolder);\n  250:     const source = _fileManager.getInstallDirectory(_dataLakeFileId);\n  251:     const copyFileList = fs.readdirSync(source);\n  252:     const promises = copyFileList.map((file) => {\n  253:         return fspromise.writeFileAsync(path.join(_dataLakeRuntimeFolder, file), fspromise.readFileSync(path.join(source, file)));\n  254:     });\n  255:     // fs.readdirSync(source).forEach(file => {"}}]}
{"result_index": 2, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.\n(Experimental) This shell command depends on [an uncontrolled value](2). Identified using machine learning.\n(Experimental) This shell command depends on [an uncontrolled value](3). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 274, "start_column": 21, "end_line": null, "end_column": 33, "snippet": "  269:     fs.mkdirSync(_languageServiceRuntimeFolder);\n  270:     const sourceFolder = _fileManager.getInstallDirectory(_scopecompilerFileId);\n  271:     const promises = copyFolder(sourceFolder, _languageServiceRuntimeFolder);\n  272:     return Promise.all(promises);\n  273: }\n  274: function copyFolder(sourceFolder, destFolder) {\n  275:     if (!fs.existsSync(destFolder)) {\n  276:         fs.mkdirSync(destFolder);\n  277:     }\n  278:     const copyFileList = fs.readdirSync(sourceFolder);\n  279:     const promises = copyFileList.map((file) => {"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 278, "start_column": 26, "end_line": null, "end_column": 54, "snippet": "  273: }\n  274: function copyFolder(sourceFolder, destFolder) {\n  275:     if (!fs.existsSync(destFolder)) {\n  276:         fs.mkdirSync(destFolder);\n  277:     }\n  278:     const copyFileList = fs.readdirSync(sourceFolder);\n  279:     const promises = copyFileList.map((file) => {\n  280:         if (fs.statSync(path.join(sourceFolder, file)).isDirectory()) {\n  281:             return copyFolder(path.join(sourceFolder, file), path.join(destFolder, file));\n  282:         }\n  283:         else {"}, "path": [{"message": "fs.read ... Folder)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 278, "start_column": 26, "end_line": null, "end_column": 54, "snippet": "  273: }\n  274: function copyFolder(sourceFolder, destFolder) {\n  275:     if (!fs.existsSync(destFolder)) {\n  276:         fs.mkdirSync(destFolder);\n  277:     }\n  278:     const copyFileList = fs.readdirSync(sourceFolder);\n  279:     const promises = copyFileList.map((file) => {\n  280:         if (fs.statSync(path.join(sourceFolder, file)).isDirectory()) {\n  281:             return copyFolder(path.join(sourceFolder, file), path.join(destFolder, file));\n  282:         }\n  283:         else {"}}, {"message": "copyFileList", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 278, "start_column": 11, "end_line": null, "end_column": 54, "snippet": "  273: }\n  274: function copyFolder(sourceFolder, destFolder) {\n  275:     if (!fs.existsSync(destFolder)) {\n  276:         fs.mkdirSync(destFolder);\n  277:     }\n  278:     const copyFileList = fs.readdirSync(sourceFolder);\n  279:     const promises = copyFileList.map((file) => {\n  280:         if (fs.statSync(path.join(sourceFolder, file)).isDirectory()) {\n  281:             return copyFolder(path.join(sourceFolder, file), path.join(destFolder, file));\n  282:         }\n  283:         else {"}}, {"message": "copyFileList", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 279, "start_column": 22, "end_line": null, "end_column": 34, "snippet": "  274: function copyFolder(sourceFolder, destFolder) {\n  275:     if (!fs.existsSync(destFolder)) {\n  276:         fs.mkdirSync(destFolder);\n  277:     }\n  278:     const copyFileList = fs.readdirSync(sourceFolder);\n  279:     const promises = copyFileList.map((file) => {\n  280:         if (fs.statSync(path.join(sourceFolder, file)).isDirectory()) {\n  281:             return copyFolder(path.join(sourceFolder, file), path.join(destFolder, file));\n  282:         }\n  283:         else {\n  284:             return fspromise.writeFileAsync(path.join(destFolder, file), fspromise.readFileSync(path.join(sourceFolder, file)));"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 279, "start_column": 40, "end_line": null, "end_column": 44, "snippet": "  274: function copyFolder(sourceFolder, destFolder) {\n  275:     if (!fs.existsSync(destFolder)) {\n  276:         fs.mkdirSync(destFolder);\n  277:     }\n  278:     const copyFileList = fs.readdirSync(sourceFolder);\n  279:     const promises = copyFileList.map((file) => {\n  280:         if (fs.statSync(path.join(sourceFolder, file)).isDirectory()) {\n  281:             return copyFolder(path.join(sourceFolder, file), path.join(destFolder, file));\n  282:         }\n  283:         else {\n  284:             return fspromise.writeFileAsync(path.join(destFolder, file), fspromise.readFileSync(path.join(sourceFolder, file)));"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 281, "start_column": 55, "end_line": null, "end_column": 59, "snippet": "  276:         fs.mkdirSync(destFolder);\n  277:     }\n  278:     const copyFileList = fs.readdirSync(sourceFolder);\n  279:     const promises = copyFileList.map((file) => {\n  280:         if (fs.statSync(path.join(sourceFolder, file)).isDirectory()) {\n  281:             return copyFolder(path.join(sourceFolder, file), path.join(destFolder, file));\n  282:         }\n  283:         else {\n  284:             return fspromise.writeFileAsync(path.join(destFolder, file), fspromise.readFileSync(path.join(sourceFolder, file)));\n  285:         }\n  286:     });"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 281, "start_column": 31, "end_line": null, "end_column": 60, "snippet": "  276:         fs.mkdirSync(destFolder);\n  277:     }\n  278:     const copyFileList = fs.readdirSync(sourceFolder);\n  279:     const promises = copyFileList.map((file) => {\n  280:         if (fs.statSync(path.join(sourceFolder, file)).isDirectory()) {\n  281:             return copyFolder(path.join(sourceFolder, file), path.join(destFolder, file));\n  282:         }\n  283:         else {\n  284:             return fspromise.writeFileAsync(path.join(destFolder, file), fspromise.readFileSync(path.join(sourceFolder, file)));\n  285:         }\n  286:     });"}}, {"message": "sourceFolder", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 274, "start_column": 21, "end_line": null, "end_column": 33, "snippet": "  269:     fs.mkdirSync(_languageServiceRuntimeFolder);\n  270:     const sourceFolder = _fileManager.getInstallDirectory(_scopecompilerFileId);\n  271:     const promises = copyFolder(sourceFolder, _languageServiceRuntimeFolder);\n  272:     return Promise.all(promises);\n  273: }\n  274: function copyFolder(sourceFolder, destFolder) {\n  275:     if (!fs.existsSync(destFolder)) {\n  276:         fs.mkdirSync(destFolder);\n  277:     }\n  278:     const copyFileList = fs.readdirSync(sourceFolder);\n  279:     const promises = copyFileList.map((file) => {"}}, {"message": "sourceFolder", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 274, "start_column": 21, "end_line": null, "end_column": 33, "snippet": "  269:     fs.mkdirSync(_languageServiceRuntimeFolder);\n  270:     const sourceFolder = _fileManager.getInstallDirectory(_scopecompilerFileId);\n  271:     const promises = copyFolder(sourceFolder, _languageServiceRuntimeFolder);\n  272:     return Promise.all(promises);\n  273: }\n  274: function copyFolder(sourceFolder, destFolder) {\n  275:     if (!fs.existsSync(destFolder)) {\n  276:         fs.mkdirSync(destFolder);\n  277:     }\n  278:     const copyFileList = fs.readdirSync(sourceFolder);\n  279:     const promises = copyFileList.map((file) => {"}}, {"message": "__dirname", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/fileManager.js", "start_line": 71, "start_column": 30, "end_line": null, "end_column": 39, "snippet": "   66:     getInstallDirectory(fileId) {\n   67:         var fileItem = this.fileList.find(t => t.FileId == fileId);\n   68:         if (fileItem.Runtime != \"\") {\n   69:             // Append runtime to installation directory\n   70:             var directory = fileItem.FileId + (platform.getFlavoredVersion() == platform.Flavor.Mono ? \"-mono\" : \"-desktop\");\n   71:             return path.join(__dirname, '..', '..', directory);\n   72:         }\n   73:         else {\n   74:             return path.join(__dirname, '..', '..', fileItem.FileId);\n   75:         }\n   76:     }"}}, {"message": "path.jo ... ectory)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/fileManager.js", "start_line": 71, "start_column": 20, "end_line": null, "end_column": 63, "snippet": "   66:     getInstallDirectory(fileId) {\n   67:         var fileItem = this.fileList.find(t => t.FileId == fileId);\n   68:         if (fileItem.Runtime != \"\") {\n   69:             // Append runtime to installation directory\n   70:             var directory = fileItem.FileId + (platform.getFlavoredVersion() == platform.Flavor.Mono ? \"-mono\" : \"-desktop\");\n   71:             return path.join(__dirname, '..', '..', directory);\n   72:         }\n   73:         else {\n   74:             return path.join(__dirname, '..', '..', fileItem.FileId);\n   75:         }\n   76:     }"}}, {"message": "_fileMa ... FileId)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 270, "start_column": 26, "end_line": null, "end_column": 80, "snippet": "  265:         charset: 'alphabetic',\n  266:         length: 12,\n  267:     });\n  268:     _languageServiceRuntimeFolder = path.join(tempFolder, folder);\n  269:     fs.mkdirSync(_languageServiceRuntimeFolder);\n  270:     const sourceFolder = _fileManager.getInstallDirectory(_scopecompilerFileId);\n  271:     const promises = copyFolder(sourceFolder, _languageServiceRuntimeFolder);\n  272:     return Promise.all(promises);\n  273: }\n  274: function copyFolder(sourceFolder, destFolder) {\n  275:     if (!fs.existsSync(destFolder)) {"}}, {"message": "sourceFolder", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 270, "start_column": 11, "end_line": null, "end_column": 80, "snippet": "  265:         charset: 'alphabetic',\n  266:         length: 12,\n  267:     });\n  268:     _languageServiceRuntimeFolder = path.join(tempFolder, folder);\n  269:     fs.mkdirSync(_languageServiceRuntimeFolder);\n  270:     const sourceFolder = _fileManager.getInstallDirectory(_scopecompilerFileId);\n  271:     const promises = copyFolder(sourceFolder, _languageServiceRuntimeFolder);\n  272:     return Promise.all(promises);\n  273: }\n  274: function copyFolder(sourceFolder, destFolder) {\n  275:     if (!fs.existsSync(destFolder)) {"}}, {"message": "sourceFolder", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 271, "start_column": 33, "end_line": null, "end_column": 45, "snippet": "  266:         length: 12,\n  267:     });\n  268:     _languageServiceRuntimeFolder = path.join(tempFolder, folder);\n  269:     fs.mkdirSync(_languageServiceRuntimeFolder);\n  270:     const sourceFolder = _fileManager.getInstallDirectory(_scopecompilerFileId);\n  271:     const promises = copyFolder(sourceFolder, _languageServiceRuntimeFolder);\n  272:     return Promise.all(promises);\n  273: }\n  274: function copyFolder(sourceFolder, destFolder) {\n  275:     if (!fs.existsSync(destFolder)) {\n  276:         fs.mkdirSync(destFolder);"}}, {"message": "sourceFolder", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 274, "start_column": 21, "end_line": null, "end_column": 33, "snippet": "  269:     fs.mkdirSync(_languageServiceRuntimeFolder);\n  270:     const sourceFolder = _fileManager.getInstallDirectory(_scopecompilerFileId);\n  271:     const promises = copyFolder(sourceFolder, _languageServiceRuntimeFolder);\n  272:     return Promise.all(promises);\n  273: }\n  274: function copyFolder(sourceFolder, destFolder) {\n  275:     if (!fs.existsSync(destFolder)) {\n  276:         fs.mkdirSync(destFolder);\n  277:     }\n  278:     const copyFileList = fs.readdirSync(sourceFolder);\n  279:     const promises = copyFileList.map((file) => {"}}, {"message": "sourceFolder", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 274, "start_column": 21, "end_line": null, "end_column": 33, "snippet": "  269:     fs.mkdirSync(_languageServiceRuntimeFolder);\n  270:     const sourceFolder = _fileManager.getInstallDirectory(_scopecompilerFileId);\n  271:     const promises = copyFolder(sourceFolder, _languageServiceRuntimeFolder);\n  272:     return Promise.all(promises);\n  273: }\n  274: function copyFolder(sourceFolder, destFolder) {\n  275:     if (!fs.existsSync(destFolder)) {\n  276:         fs.mkdirSync(destFolder);\n  277:     }\n  278:     const copyFileList = fs.readdirSync(sourceFolder);\n  279:     const promises = copyFileList.map((file) => {"}}, {"message": "__dirname", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/fileManager.js", "start_line": 74, "start_column": 30, "end_line": null, "end_column": 39, "snippet": "   69:             // Append runtime to installation directory\n   70:             var directory = fileItem.FileId + (platform.getFlavoredVersion() == platform.Flavor.Mono ? \"-mono\" : \"-desktop\");\n   71:             return path.join(__dirname, '..', '..', directory);\n   72:         }\n   73:         else {\n   74:             return path.join(__dirname, '..', '..', fileItem.FileId);\n   75:         }\n   76:     }\n   77:     isAllDependencyFulfilled() {\n   78:         this.fileList.forEach(element => {\n   79:             var fileName = path.join(this.getInstallDirectory(element.FileId), element.ExecutableFileName);"}}, {"message": "path.jo ... FileId)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/fileManager.js", "start_line": 74, "start_column": 20, "end_line": null, "end_column": 69, "snippet": "   69:             // Append runtime to installation directory\n   70:             var directory = fileItem.FileId + (platform.getFlavoredVersion() == platform.Flavor.Mono ? \"-mono\" : \"-desktop\");\n   71:             return path.join(__dirname, '..', '..', directory);\n   72:         }\n   73:         else {\n   74:             return path.join(__dirname, '..', '..', fileItem.FileId);\n   75:         }\n   76:     }\n   77:     isAllDependencyFulfilled() {\n   78:         this.fileList.forEach(element => {\n   79:             var fileName = path.join(this.getInstallDirectory(element.FileId), element.ExecutableFileName);"}}, {"message": "_fileMa ... FileId)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 270, "start_column": 26, "end_line": null, "end_column": 80, "snippet": "  265:         charset: 'alphabetic',\n  266:         length: 12,\n  267:     });\n  268:     _languageServiceRuntimeFolder = path.join(tempFolder, folder);\n  269:     fs.mkdirSync(_languageServiceRuntimeFolder);\n  270:     const sourceFolder = _fileManager.getInstallDirectory(_scopecompilerFileId);\n  271:     const promises = copyFolder(sourceFolder, _languageServiceRuntimeFolder);\n  272:     return Promise.all(promises);\n  273: }\n  274: function copyFolder(sourceFolder, destFolder) {\n  275:     if (!fs.existsSync(destFolder)) {"}}, {"message": "sourceFolder", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 270, "start_column": 11, "end_line": null, "end_column": 80, "snippet": "  265:         charset: 'alphabetic',\n  266:         length: 12,\n  267:     });\n  268:     _languageServiceRuntimeFolder = path.join(tempFolder, folder);\n  269:     fs.mkdirSync(_languageServiceRuntimeFolder);\n  270:     const sourceFolder = _fileManager.getInstallDirectory(_scopecompilerFileId);\n  271:     const promises = copyFolder(sourceFolder, _languageServiceRuntimeFolder);\n  272:     return Promise.all(promises);\n  273: }\n  274: function copyFolder(sourceFolder, destFolder) {\n  275:     if (!fs.existsSync(destFolder)) {"}}, {"message": "sourceFolder", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 271, "start_column": 33, "end_line": null, "end_column": 45, "snippet": "  266:         length: 12,\n  267:     });\n  268:     _languageServiceRuntimeFolder = path.join(tempFolder, folder);\n  269:     fs.mkdirSync(_languageServiceRuntimeFolder);\n  270:     const sourceFolder = _fileManager.getInstallDirectory(_scopecompilerFileId);\n  271:     const promises = copyFolder(sourceFolder, _languageServiceRuntimeFolder);\n  272:     return Promise.all(promises);\n  273: }\n  274: function copyFolder(sourceFolder, destFolder) {\n  275:     if (!fs.existsSync(destFolder)) {\n  276:         fs.mkdirSync(destFolder);"}}, {"message": "sourceFolder", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 274, "start_column": 21, "end_line": null, "end_column": 33, "snippet": "  269:     fs.mkdirSync(_languageServiceRuntimeFolder);\n  270:     const sourceFolder = _fileManager.getInstallDirectory(_scopecompilerFileId);\n  271:     const promises = copyFolder(sourceFolder, _languageServiceRuntimeFolder);\n  272:     return Promise.all(promises);\n  273: }\n  274: function copyFolder(sourceFolder, destFolder) {\n  275:     if (!fs.existsSync(destFolder)) {\n  276:         fs.mkdirSync(destFolder);\n  277:     }\n  278:     const copyFileList = fs.readdirSync(sourceFolder);\n  279:     const promises = copyFileList.map((file) => {"}}, {"message": "sourceFolder", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 274, "start_column": 21, "end_line": null, "end_column": 33, "snippet": "  269:     fs.mkdirSync(_languageServiceRuntimeFolder);\n  270:     const sourceFolder = _fileManager.getInstallDirectory(_scopecompilerFileId);\n  271:     const promises = copyFolder(sourceFolder, _languageServiceRuntimeFolder);\n  272:     return Promise.all(promises);\n  273: }\n  274: function copyFolder(sourceFolder, destFolder) {\n  275:     if (!fs.existsSync(destFolder)) {\n  276:         fs.mkdirSync(destFolder);\n  277:     }\n  278:     const copyFileList = fs.readdirSync(sourceFolder);\n  279:     const promises = copyFileList.map((file) => {"}}]}
{"result_index": 3, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 274, "start_column": 35, "end_line": null, "end_column": 45, "snippet": "  269:     fs.mkdirSync(_languageServiceRuntimeFolder);\n  270:     const sourceFolder = _fileManager.getInstallDirectory(_scopecompilerFileId);\n  271:     const promises = copyFolder(sourceFolder, _languageServiceRuntimeFolder);\n  272:     return Promise.all(promises);\n  273: }\n  274: function copyFolder(sourceFolder, destFolder) {\n  275:     if (!fs.existsSync(destFolder)) {\n  276:         fs.mkdirSync(destFolder);\n  277:     }\n  278:     const copyFileList = fs.readdirSync(sourceFolder);\n  279:     const promises = copyFileList.map((file) => {"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 278, "start_column": 26, "end_line": null, "end_column": 54, "snippet": "  273: }\n  274: function copyFolder(sourceFolder, destFolder) {\n  275:     if (!fs.existsSync(destFolder)) {\n  276:         fs.mkdirSync(destFolder);\n  277:     }\n  278:     const copyFileList = fs.readdirSync(sourceFolder);\n  279:     const promises = copyFileList.map((file) => {\n  280:         if (fs.statSync(path.join(sourceFolder, file)).isDirectory()) {\n  281:             return copyFolder(path.join(sourceFolder, file), path.join(destFolder, file));\n  282:         }\n  283:         else {"}, "path": [{"message": "fs.read ... Folder)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 278, "start_column": 26, "end_line": null, "end_column": 54, "snippet": "  273: }\n  274: function copyFolder(sourceFolder, destFolder) {\n  275:     if (!fs.existsSync(destFolder)) {\n  276:         fs.mkdirSync(destFolder);\n  277:     }\n  278:     const copyFileList = fs.readdirSync(sourceFolder);\n  279:     const promises = copyFileList.map((file) => {\n  280:         if (fs.statSync(path.join(sourceFolder, file)).isDirectory()) {\n  281:             return copyFolder(path.join(sourceFolder, file), path.join(destFolder, file));\n  282:         }\n  283:         else {"}}, {"message": "copyFileList", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 278, "start_column": 11, "end_line": null, "end_column": 54, "snippet": "  273: }\n  274: function copyFolder(sourceFolder, destFolder) {\n  275:     if (!fs.existsSync(destFolder)) {\n  276:         fs.mkdirSync(destFolder);\n  277:     }\n  278:     const copyFileList = fs.readdirSync(sourceFolder);\n  279:     const promises = copyFileList.map((file) => {\n  280:         if (fs.statSync(path.join(sourceFolder, file)).isDirectory()) {\n  281:             return copyFolder(path.join(sourceFolder, file), path.join(destFolder, file));\n  282:         }\n  283:         else {"}}, {"message": "copyFileList", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 279, "start_column": 22, "end_line": null, "end_column": 34, "snippet": "  274: function copyFolder(sourceFolder, destFolder) {\n  275:     if (!fs.existsSync(destFolder)) {\n  276:         fs.mkdirSync(destFolder);\n  277:     }\n  278:     const copyFileList = fs.readdirSync(sourceFolder);\n  279:     const promises = copyFileList.map((file) => {\n  280:         if (fs.statSync(path.join(sourceFolder, file)).isDirectory()) {\n  281:             return copyFolder(path.join(sourceFolder, file), path.join(destFolder, file));\n  282:         }\n  283:         else {\n  284:             return fspromise.writeFileAsync(path.join(destFolder, file), fspromise.readFileSync(path.join(sourceFolder, file)));"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 279, "start_column": 40, "end_line": null, "end_column": 44, "snippet": "  274: function copyFolder(sourceFolder, destFolder) {\n  275:     if (!fs.existsSync(destFolder)) {\n  276:         fs.mkdirSync(destFolder);\n  277:     }\n  278:     const copyFileList = fs.readdirSync(sourceFolder);\n  279:     const promises = copyFileList.map((file) => {\n  280:         if (fs.statSync(path.join(sourceFolder, file)).isDirectory()) {\n  281:             return copyFolder(path.join(sourceFolder, file), path.join(destFolder, file));\n  282:         }\n  283:         else {\n  284:             return fspromise.writeFileAsync(path.join(destFolder, file), fspromise.readFileSync(path.join(sourceFolder, file)));"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 281, "start_column": 84, "end_line": null, "end_column": 88, "snippet": "  276:         fs.mkdirSync(destFolder);\n  277:     }\n  278:     const copyFileList = fs.readdirSync(sourceFolder);\n  279:     const promises = copyFileList.map((file) => {\n  280:         if (fs.statSync(path.join(sourceFolder, file)).isDirectory()) {\n  281:             return copyFolder(path.join(sourceFolder, file), path.join(destFolder, file));\n  282:         }\n  283:         else {\n  284:             return fspromise.writeFileAsync(path.join(destFolder, file), fspromise.readFileSync(path.join(sourceFolder, file)));\n  285:         }\n  286:     });"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 281, "start_column": 62, "end_line": null, "end_column": 89, "snippet": "  276:         fs.mkdirSync(destFolder);\n  277:     }\n  278:     const copyFileList = fs.readdirSync(sourceFolder);\n  279:     const promises = copyFileList.map((file) => {\n  280:         if (fs.statSync(path.join(sourceFolder, file)).isDirectory()) {\n  281:             return copyFolder(path.join(sourceFolder, file), path.join(destFolder, file));\n  282:         }\n  283:         else {\n  284:             return fspromise.writeFileAsync(path.join(destFolder, file), fspromise.readFileSync(path.join(sourceFolder, file)));\n  285:         }\n  286:     });"}}, {"message": "destFolder", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 274, "start_column": 35, "end_line": null, "end_column": 45, "snippet": "  269:     fs.mkdirSync(_languageServiceRuntimeFolder);\n  270:     const sourceFolder = _fileManager.getInstallDirectory(_scopecompilerFileId);\n  271:     const promises = copyFolder(sourceFolder, _languageServiceRuntimeFolder);\n  272:     return Promise.all(promises);\n  273: }\n  274: function copyFolder(sourceFolder, destFolder) {\n  275:     if (!fs.existsSync(destFolder)) {\n  276:         fs.mkdirSync(destFolder);\n  277:     }\n  278:     const copyFileList = fs.readdirSync(sourceFolder);\n  279:     const promises = copyFileList.map((file) => {"}}, {"message": "destFolder", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 274, "start_column": 35, "end_line": null, "end_column": 45, "snippet": "  269:     fs.mkdirSync(_languageServiceRuntimeFolder);\n  270:     const sourceFolder = _fileManager.getInstallDirectory(_scopecompilerFileId);\n  271:     const promises = copyFolder(sourceFolder, _languageServiceRuntimeFolder);\n  272:     return Promise.all(promises);\n  273: }\n  274: function copyFolder(sourceFolder, destFolder) {\n  275:     if (!fs.existsSync(destFolder)) {\n  276:         fs.mkdirSync(destFolder);\n  277:     }\n  278:     const copyFileList = fs.readdirSync(sourceFolder);\n  279:     const promises = copyFileList.map((file) => {"}}]}
{"result_index": 4, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 704, "start_column": 11, "end_line": null, "end_column": 24, "snippet": "  699: }\n  700: function buildCSharpProjDependency() {\n  701:     // this is only used for resolve dependency and can be reused for all the codeBehind, so put under entension folder\n  702:     const projectFilePath = path.join(vscode.workspace.rootPath, 'usqlCodeBehind.csproj');\n  703:     const projectReferencePath = path.join(vscode.workspace.rootPath, 'usqlCodeBehindReference');\n  704:     const referencePath = path.join(__dirname, '..', '..', 'reference');\n  705:     const codeBehindProjectFileContent = `<Project Sdk=\"Microsoft.NET.Sdk\">\n  706: \t<PropertyGroup>\n  707: \t\t<OutputType>Dll</OutputType>\n  708: \t\t<TargetFramework>netcoreapp1.0</TargetFramework>\n  709: \t</PropertyGroup>"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 704, "start_column": 37, "end_line": null, "end_column": 46, "snippet": "  699: }\n  700: function buildCSharpProjDependency() {\n  701:     // this is only used for resolve dependency and can be reused for all the codeBehind, so put under entension folder\n  702:     const projectFilePath = path.join(vscode.workspace.rootPath, 'usqlCodeBehind.csproj');\n  703:     const projectReferencePath = path.join(vscode.workspace.rootPath, 'usqlCodeBehindReference');\n  704:     const referencePath = path.join(__dirname, '..', '..', 'reference');\n  705:     const codeBehindProjectFileContent = `<Project Sdk=\"Microsoft.NET.Sdk\">\n  706: \t<PropertyGroup>\n  707: \t\t<OutputType>Dll</OutputType>\n  708: \t\t<TargetFramework>netcoreapp1.0</TargetFramework>\n  709: \t</PropertyGroup>"}, "path": [{"message": "__dirname", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 704, "start_column": 37, "end_line": null, "end_column": 46, "snippet": "  699: }\n  700: function buildCSharpProjDependency() {\n  701:     // this is only used for resolve dependency and can be reused for all the codeBehind, so put under entension folder\n  702:     const projectFilePath = path.join(vscode.workspace.rootPath, 'usqlCodeBehind.csproj');\n  703:     const projectReferencePath = path.join(vscode.workspace.rootPath, 'usqlCodeBehindReference');\n  704:     const referencePath = path.join(__dirname, '..', '..', 'reference');\n  705:     const codeBehindProjectFileContent = `<Project Sdk=\"Microsoft.NET.Sdk\">\n  706: \t<PropertyGroup>\n  707: \t\t<OutputType>Dll</OutputType>\n  708: \t\t<TargetFramework>netcoreapp1.0</TargetFramework>\n  709: \t</PropertyGroup>"}}, {"message": "path.jo ... rence')", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 704, "start_column": 27, "end_line": null, "end_column": 72, "snippet": "  699: }\n  700: function buildCSharpProjDependency() {\n  701:     // this is only used for resolve dependency and can be reused for all the codeBehind, so put under entension folder\n  702:     const projectFilePath = path.join(vscode.workspace.rootPath, 'usqlCodeBehind.csproj');\n  703:     const projectReferencePath = path.join(vscode.workspace.rootPath, 'usqlCodeBehindReference');\n  704:     const referencePath = path.join(__dirname, '..', '..', 'reference');\n  705:     const codeBehindProjectFileContent = `<Project Sdk=\"Microsoft.NET.Sdk\">\n  706: \t<PropertyGroup>\n  707: \t\t<OutputType>Dll</OutputType>\n  708: \t\t<TargetFramework>netcoreapp1.0</TargetFramework>\n  709: \t</PropertyGroup>"}}, {"message": "referencePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 704, "start_column": 11, "end_line": null, "end_column": 72, "snippet": "  699: }\n  700: function buildCSharpProjDependency() {\n  701:     // this is only used for resolve dependency and can be reused for all the codeBehind, so put under entension folder\n  702:     const projectFilePath = path.join(vscode.workspace.rootPath, 'usqlCodeBehind.csproj');\n  703:     const projectReferencePath = path.join(vscode.workspace.rootPath, 'usqlCodeBehindReference');\n  704:     const referencePath = path.join(__dirname, '..', '..', 'reference');\n  705:     const codeBehindProjectFileContent = `<Project Sdk=\"Microsoft.NET.Sdk\">\n  706: \t<PropertyGroup>\n  707: \t\t<OutputType>Dll</OutputType>\n  708: \t\t<TargetFramework>netcoreapp1.0</TargetFramework>\n  709: \t</PropertyGroup>"}}, {"message": "referencePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 704, "start_column": 11, "end_line": null, "end_column": 24, "snippet": "  699: }\n  700: function buildCSharpProjDependency() {\n  701:     // this is only used for resolve dependency and can be reused for all the codeBehind, so put under entension folder\n  702:     const projectFilePath = path.join(vscode.workspace.rootPath, 'usqlCodeBehind.csproj');\n  703:     const projectReferencePath = path.join(vscode.workspace.rootPath, 'usqlCodeBehindReference');\n  704:     const referencePath = path.join(__dirname, '..', '..', 'reference');\n  705:     const codeBehindProjectFileContent = `<Project Sdk=\"Microsoft.NET.Sdk\">\n  706: \t<PropertyGroup>\n  707: \t\t<OutputType>Dll</OutputType>\n  708: \t\t<TargetFramework>netcoreapp1.0</TargetFramework>\n  709: \t</PropertyGroup>"}}]}
{"result_index": 5, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/datalakeStorageManager.js", "start_line": 467, "start_column": 23, "end_line": null, "end_column": 37, "snippet": "  462:                 return;\n  463:             }\n  464:             let p = flattenedPaths.pop();\n  465:             getStorageAccount.then((storageAccount) => {\n  466:                 const relativePath = p.full.replace(p.base, '');\n  467:                 const targetFullPath = util_1.util.IsFolderPath(targetPath) ? path.join(targetPath, relativePath) : targetPath;\n  468:                 let theStorageAccount = p.storageAccount ? p.storageAccount : storageAccount;\n  469:                 // check if exists here.\n  470:                 let checkFileStatus = () => {\n  471:                     let targetFileExists;\n  472:                     if (doCopyFunc === DatalakeStorageManager.uploadToPath) {"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 347, "start_column": 9, "end_line": null, "end_column": 26, "snippet": "  342:     static getFilesRecursively(base, p, storageAccount) {\n  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {\n  351:                     result.push(f);\n  352:                 });"}, "path": [{"message": "fs.readdirSync(p)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 347, "start_column": 9, "end_line": null, "end_column": 26, "snippet": "  342:     static getFilesRecursively(base, p, storageAccount) {\n  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {\n  351:                     result.push(f);\n  352:                 });"}}, {"message": "item", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 347, "start_column": 36, "end_line": null, "end_column": 40, "snippet": "  342:     static getFilesRecursively(base, p, storageAccount) {\n  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {\n  351:                     result.push(f);\n  352:                 });"}}, {"message": "item", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 348, "start_column": 43, "end_line": null, "end_column": 47, "snippet": "  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {\n  351:                     result.push(f);\n  352:                 });\n  353:             }"}}, {"message": "path.join(p, item)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 348, "start_column": 30, "end_line": null, "end_column": 48, "snippet": "  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {\n  351:                     result.push(f);\n  352:                 });\n  353:             }"}}, {"message": "itemPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 348, "start_column": 19, "end_line": null, "end_column": 48, "snippet": "  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {\n  351:                     result.push(f);\n  352:                 });\n  353:             }"}}, {"message": "itemPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 355, "start_column": 49, "end_line": null, "end_column": 57, "snippet": "  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {\n  351:                     result.push(f);\n  352:                 });\n  353:             }\n  354:             else {\n  355:                 result.push({ base: base, full: itemPath, storageAccount: storageAccount });\n  356:             }\n  357:         });\n  358:         return result;\n  359:     }\n  360:     static previewContentInFile(tempConfigFilePath, content, onSave) {"}}, {"message": "p.full", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/datalakeStorageManager.js", "start_line": 466, "start_column": 38, "end_line": null, "end_column": 44, "snippet": "  461:             if (concurrency > 5) {\n  462:                 return;\n  463:             }\n  464:             let p = flattenedPaths.pop();\n  465:             getStorageAccount.then((storageAccount) => {\n  466:                 const relativePath = p.full.replace(p.base, '');\n  467:                 const targetFullPath = util_1.util.IsFolderPath(targetPath) ? path.join(targetPath, relativePath) : targetPath;\n  468:                 let theStorageAccount = p.storageAccount ? p.storageAccount : storageAccount;\n  469:                 // check if exists here.\n  470:                 let checkFileStatus = () => {\n  471:                     let targetFileExists;"}}, {"message": "p.full. ... se, '')", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/datalakeStorageManager.js", "start_line": 466, "start_column": 38, "end_line": null, "end_column": 64, "snippet": "  461:             if (concurrency > 5) {\n  462:                 return;\n  463:             }\n  464:             let p = flattenedPaths.pop();\n  465:             getStorageAccount.then((storageAccount) => {\n  466:                 const relativePath = p.full.replace(p.base, '');\n  467:                 const targetFullPath = util_1.util.IsFolderPath(targetPath) ? path.join(targetPath, relativePath) : targetPath;\n  468:                 let theStorageAccount = p.storageAccount ? p.storageAccount : storageAccount;\n  469:                 // check if exists here.\n  470:                 let checkFileStatus = () => {\n  471:                     let targetFileExists;"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/datalakeStorageManager.js", "start_line": 466, "start_column": 23, "end_line": null, "end_column": 64, "snippet": "  461:             if (concurrency > 5) {\n  462:                 return;\n  463:             }\n  464:             let p = flattenedPaths.pop();\n  465:             getStorageAccount.then((storageAccount) => {\n  466:                 const relativePath = p.full.replace(p.base, '');\n  467:                 const targetFullPath = util_1.util.IsFolderPath(targetPath) ? path.join(targetPath, relativePath) : targetPath;\n  468:                 let theStorageAccount = p.storageAccount ? p.storageAccount : storageAccount;\n  469:                 // check if exists here.\n  470:                 let checkFileStatus = () => {\n  471:                     let targetFileExists;"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/datalakeStorageManager.js", "start_line": 467, "start_column": 101, "end_line": null, "end_column": 113, "snippet": "  462:                 return;\n  463:             }\n  464:             let p = flattenedPaths.pop();\n  465:             getStorageAccount.then((storageAccount) => {\n  466:                 const relativePath = p.full.replace(p.base, '');\n  467:                 const targetFullPath = util_1.util.IsFolderPath(targetPath) ? path.join(targetPath, relativePath) : targetPath;\n  468:                 let theStorageAccount = p.storageAccount ? p.storageAccount : storageAccount;\n  469:                 // check if exists here.\n  470:                 let checkFileStatus = () => {\n  471:                     let targetFileExists;\n  472:                     if (doCopyFunc === DatalakeStorageManager.uploadToPath) {"}}, {"message": "path.jo ... vePath)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/datalakeStorageManager.js", "start_line": 467, "start_column": 79, "end_line": null, "end_column": 114, "snippet": "  462:                 return;\n  463:             }\n  464:             let p = flattenedPaths.pop();\n  465:             getStorageAccount.then((storageAccount) => {\n  466:                 const relativePath = p.full.replace(p.base, '');\n  467:                 const targetFullPath = util_1.util.IsFolderPath(targetPath) ? path.join(targetPath, relativePath) : targetPath;\n  468:                 let theStorageAccount = p.storageAccount ? p.storageAccount : storageAccount;\n  469:                 // check if exists here.\n  470:                 let checkFileStatus = () => {\n  471:                     let targetFileExists;\n  472:                     if (doCopyFunc === DatalakeStorageManager.uploadToPath) {"}}, {"message": "util_1. ... getPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/datalakeStorageManager.js", "start_line": 467, "start_column": 40, "end_line": null, "end_column": 127, "snippet": "  462:                 return;\n  463:             }\n  464:             let p = flattenedPaths.pop();\n  465:             getStorageAccount.then((storageAccount) => {\n  466:                 const relativePath = p.full.replace(p.base, '');\n  467:                 const targetFullPath = util_1.util.IsFolderPath(targetPath) ? path.join(targetPath, relativePath) : targetPath;\n  468:                 let theStorageAccount = p.storageAccount ? p.storageAccount : storageAccount;\n  469:                 // check if exists here.\n  470:                 let checkFileStatus = () => {\n  471:                     let targetFileExists;\n  472:                     if (doCopyFunc === DatalakeStorageManager.uploadToPath) {"}}, {"message": "targetFullPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/datalakeStorageManager.js", "start_line": 467, "start_column": 23, "end_line": null, "end_column": 127, "snippet": "  462:                 return;\n  463:             }\n  464:             let p = flattenedPaths.pop();\n  465:             getStorageAccount.then((storageAccount) => {\n  466:                 const relativePath = p.full.replace(p.base, '');\n  467:                 const targetFullPath = util_1.util.IsFolderPath(targetPath) ? path.join(targetPath, relativePath) : targetPath;\n  468:                 let theStorageAccount = p.storageAccount ? p.storageAccount : storageAccount;\n  469:                 // check if exists here.\n  470:                 let checkFileStatus = () => {\n  471:                     let targetFileExists;\n  472:                     if (doCopyFunc === DatalakeStorageManager.uploadToPath) {"}}, {"message": "targetFullPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/datalakeStorageManager.js", "start_line": 467, "start_column": 23, "end_line": null, "end_column": 37, "snippet": "  462:                 return;\n  463:             }\n  464:             let p = flattenedPaths.pop();\n  465:             getStorageAccount.then((storageAccount) => {\n  466:                 const relativePath = p.full.replace(p.base, '');\n  467:                 const targetFullPath = util_1.util.IsFolderPath(targetPath) ? path.join(targetPath, relativePath) : targetPath;\n  468:                 let theStorageAccount = p.storageAccount ? p.storageAccount : storageAccount;\n  469:                 // check if exists here.\n  470:                 let checkFileStatus = () => {\n  471:                     let targetFileExists;\n  472:                     if (doCopyFunc === DatalakeStorageManager.uploadToPath) {"}}]}
{"result_index": 6, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.\n(Experimental) This shell command depends on [an uncontrolled value](2). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 119, "start_column": 33, "end_line": null, "end_column": 46, "snippet": "  114:         }\n  115:         else {\n  116:             return filePath;\n  117:         }\n  118:     }\n  119:     static rmdirSyncRecursively(currentFolder) {\n  120:         fs.readdirSync(currentFolder).forEach((f) => {\n  121:             let currentItem = path.join(currentFolder, f);\n  122:             let currentStat = fs.statSync(currentItem);\n  123:             if (currentStat.isDirectory()) {\n  124:                 this.rmdirSyncRecursively(currentItem);"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 291, "start_column": 9, "end_line": null, "end_column": 31, "snippet": "  286:     });\n  287:     return promises;\n  288: }\n  289: function cleanUserFolder(folder, cleanFolderPrefix) {\n  290:     try {\n  291:         fs.readdirSync(folder).forEach((dir) => {\n  292:             if (dir.startsWith(cleanFolderPrefix)) {\n  293:                 const currentFolder = path.join(folder, dir);\n  294:                 util_1.util.rmdirSyncRecursively(currentFolder);\n  295:             }\n  296:         });"}, "path": [{"message": "fs.read ... folder)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 291, "start_column": 9, "end_line": null, "end_column": 31, "snippet": "  286:     });\n  287:     return promises;\n  288: }\n  289: function cleanUserFolder(folder, cleanFolderPrefix) {\n  290:     try {\n  291:         fs.readdirSync(folder).forEach((dir) => {\n  292:             if (dir.startsWith(cleanFolderPrefix)) {\n  293:                 const currentFolder = path.join(folder, dir);\n  294:                 util_1.util.rmdirSyncRecursively(currentFolder);\n  295:             }\n  296:         });"}}, {"message": "dir", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 291, "start_column": 41, "end_line": null, "end_column": 44, "snippet": "  286:     });\n  287:     return promises;\n  288: }\n  289: function cleanUserFolder(folder, cleanFolderPrefix) {\n  290:     try {\n  291:         fs.readdirSync(folder).forEach((dir) => {\n  292:             if (dir.startsWith(cleanFolderPrefix)) {\n  293:                 const currentFolder = path.join(folder, dir);\n  294:                 util_1.util.rmdirSyncRecursively(currentFolder);\n  295:             }\n  296:         });"}}, {"message": "dir", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 293, "start_column": 57, "end_line": null, "end_column": 60, "snippet": "  288: }\n  289: function cleanUserFolder(folder, cleanFolderPrefix) {\n  290:     try {\n  291:         fs.readdirSync(folder).forEach((dir) => {\n  292:             if (dir.startsWith(cleanFolderPrefix)) {\n  293:                 const currentFolder = path.join(folder, dir);\n  294:                 util_1.util.rmdirSyncRecursively(currentFolder);\n  295:             }\n  296:         });\n  297:     }\n  298:     catch (err) {"}}, {"message": "path.jo ... r, dir)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 293, "start_column": 39, "end_line": null, "end_column": 61, "snippet": "  288: }\n  289: function cleanUserFolder(folder, cleanFolderPrefix) {\n  290:     try {\n  291:         fs.readdirSync(folder).forEach((dir) => {\n  292:             if (dir.startsWith(cleanFolderPrefix)) {\n  293:                 const currentFolder = path.join(folder, dir);\n  294:                 util_1.util.rmdirSyncRecursively(currentFolder);\n  295:             }\n  296:         });\n  297:     }\n  298:     catch (err) {"}}, {"message": "currentFolder", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 293, "start_column": 23, "end_line": null, "end_column": 61, "snippet": "  288: }\n  289: function cleanUserFolder(folder, cleanFolderPrefix) {\n  290:     try {\n  291:         fs.readdirSync(folder).forEach((dir) => {\n  292:             if (dir.startsWith(cleanFolderPrefix)) {\n  293:                 const currentFolder = path.join(folder, dir);\n  294:                 util_1.util.rmdirSyncRecursively(currentFolder);\n  295:             }\n  296:         });\n  297:     }\n  298:     catch (err) {"}}, {"message": "currentFolder", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/extension.js", "start_line": 294, "start_column": 50, "end_line": null, "end_column": 63, "snippet": "  289: function cleanUserFolder(folder, cleanFolderPrefix) {\n  290:     try {\n  291:         fs.readdirSync(folder).forEach((dir) => {\n  292:             if (dir.startsWith(cleanFolderPrefix)) {\n  293:                 const currentFolder = path.join(folder, dir);\n  294:                 util_1.util.rmdirSyncRecursively(currentFolder);\n  295:             }\n  296:         });\n  297:     }\n  298:     catch (err) {\n  299:         // remove temp files. ignore any exceptions."}}, {"message": "currentFolder", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 119, "start_column": 33, "end_line": null, "end_column": 46, "snippet": "  114:         }\n  115:         else {\n  116:             return filePath;\n  117:         }\n  118:     }\n  119:     static rmdirSyncRecursively(currentFolder) {\n  120:         fs.readdirSync(currentFolder).forEach((f) => {\n  121:             let currentItem = path.join(currentFolder, f);\n  122:             let currentStat = fs.statSync(currentItem);\n  123:             if (currentStat.isDirectory()) {\n  124:                 this.rmdirSyncRecursively(currentItem);"}}, {"message": "currentFolder", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 119, "start_column": 33, "end_line": null, "end_column": 46, "snippet": "  114:         }\n  115:         else {\n  116:             return filePath;\n  117:         }\n  118:     }\n  119:     static rmdirSyncRecursively(currentFolder) {\n  120:         fs.readdirSync(currentFolder).forEach((f) => {\n  121:             let currentItem = path.join(currentFolder, f);\n  122:             let currentStat = fs.statSync(currentItem);\n  123:             if (currentStat.isDirectory()) {\n  124:                 this.rmdirSyncRecursively(currentItem);"}}, {"message": "fs.read ... Folder)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 120, "start_column": 9, "end_line": null, "end_column": 38, "snippet": "  115:         else {\n  116:             return filePath;\n  117:         }\n  118:     }\n  119:     static rmdirSyncRecursively(currentFolder) {\n  120:         fs.readdirSync(currentFolder).forEach((f) => {\n  121:             let currentItem = path.join(currentFolder, f);\n  122:             let currentStat = fs.statSync(currentItem);\n  123:             if (currentStat.isDirectory()) {\n  124:                 this.rmdirSyncRecursively(currentItem);\n  125:             }"}}, {"message": "f", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 120, "start_column": 48, "end_line": null, "end_column": 49, "snippet": "  115:         else {\n  116:             return filePath;\n  117:         }\n  118:     }\n  119:     static rmdirSyncRecursively(currentFolder) {\n  120:         fs.readdirSync(currentFolder).forEach((f) => {\n  121:             let currentItem = path.join(currentFolder, f);\n  122:             let currentStat = fs.statSync(currentItem);\n  123:             if (currentStat.isDirectory()) {\n  124:                 this.rmdirSyncRecursively(currentItem);\n  125:             }"}}, {"message": "f", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 121, "start_column": 56, "end_line": null, "end_column": 57, "snippet": "  116:             return filePath;\n  117:         }\n  118:     }\n  119:     static rmdirSyncRecursively(currentFolder) {\n  120:         fs.readdirSync(currentFolder).forEach((f) => {\n  121:             let currentItem = path.join(currentFolder, f);\n  122:             let currentStat = fs.statSync(currentItem);\n  123:             if (currentStat.isDirectory()) {\n  124:                 this.rmdirSyncRecursively(currentItem);\n  125:             }\n  126:             else {"}}, {"message": "path.jo ... der, f)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 121, "start_column": 31, "end_line": null, "end_column": 58, "snippet": "  116:             return filePath;\n  117:         }\n  118:     }\n  119:     static rmdirSyncRecursively(currentFolder) {\n  120:         fs.readdirSync(currentFolder).forEach((f) => {\n  121:             let currentItem = path.join(currentFolder, f);\n  122:             let currentStat = fs.statSync(currentItem);\n  123:             if (currentStat.isDirectory()) {\n  124:                 this.rmdirSyncRecursively(currentItem);\n  125:             }\n  126:             else {"}}, {"message": "currentItem", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 121, "start_column": 17, "end_line": null, "end_column": 58, "snippet": "  116:             return filePath;\n  117:         }\n  118:     }\n  119:     static rmdirSyncRecursively(currentFolder) {\n  120:         fs.readdirSync(currentFolder).forEach((f) => {\n  121:             let currentItem = path.join(currentFolder, f);\n  122:             let currentStat = fs.statSync(currentItem);\n  123:             if (currentStat.isDirectory()) {\n  124:                 this.rmdirSyncRecursively(currentItem);\n  125:             }\n  126:             else {"}}, {"message": "currentItem", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 124, "start_column": 43, "end_line": null, "end_column": 54, "snippet": "  119:     static rmdirSyncRecursively(currentFolder) {\n  120:         fs.readdirSync(currentFolder).forEach((f) => {\n  121:             let currentItem = path.join(currentFolder, f);\n  122:             let currentStat = fs.statSync(currentItem);\n  123:             if (currentStat.isDirectory()) {\n  124:                 this.rmdirSyncRecursively(currentItem);\n  125:             }\n  126:             else {\n  127:                 fs.unlinkSync(path.join(currentFolder, f));\n  128:             }\n  129:         });"}}, {"message": "currentFolder", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 119, "start_column": 33, "end_line": null, "end_column": 46, "snippet": "  114:         }\n  115:         else {\n  116:             return filePath;\n  117:         }\n  118:     }\n  119:     static rmdirSyncRecursively(currentFolder) {\n  120:         fs.readdirSync(currentFolder).forEach((f) => {\n  121:             let currentItem = path.join(currentFolder, f);\n  122:             let currentStat = fs.statSync(currentItem);\n  123:             if (currentStat.isDirectory()) {\n  124:                 this.rmdirSyncRecursively(currentItem);"}}, {"message": "currentFolder", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 119, "start_column": 33, "end_line": null, "end_column": 46, "snippet": "  114:         }\n  115:         else {\n  116:             return filePath;\n  117:         }\n  118:     }\n  119:     static rmdirSyncRecursively(currentFolder) {\n  120:         fs.readdirSync(currentFolder).forEach((f) => {\n  121:             let currentItem = path.join(currentFolder, f);\n  122:             let currentStat = fs.statSync(currentItem);\n  123:             if (currentStat.isDirectory()) {\n  124:                 this.rmdirSyncRecursively(currentItem);"}}]}
{"result_index": 7, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 342, "start_column": 32, "end_line": null, "end_column": 36, "snippet": "  337:     }\n  338:     static toHexString(original) {\n  339:         let buff = new Buffer(original, 'utf8');\n  340:         return buff.toString('hex');\n  341:     }\n  342:     static getFilesRecursively(base, p, storageAccount) {\n  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 347, "start_column": 9, "end_line": null, "end_column": 26, "snippet": "  342:     static getFilesRecursively(base, p, storageAccount) {\n  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {\n  351:                     result.push(f);\n  352:                 });"}, "path": [{"message": "fs.readdirSync(p)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 347, "start_column": 9, "end_line": null, "end_column": 26, "snippet": "  342:     static getFilesRecursively(base, p, storageAccount) {\n  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {\n  351:                     result.push(f);\n  352:                 });"}}, {"message": "item", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 347, "start_column": 36, "end_line": null, "end_column": 40, "snippet": "  342:     static getFilesRecursively(base, p, storageAccount) {\n  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {\n  351:                     result.push(f);\n  352:                 });"}}, {"message": "item", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 348, "start_column": 43, "end_line": null, "end_column": 47, "snippet": "  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {\n  351:                     result.push(f);\n  352:                 });\n  353:             }"}}, {"message": "path.join(p, item)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 348, "start_column": 30, "end_line": null, "end_column": 48, "snippet": "  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {\n  351:                     result.push(f);\n  352:                 });\n  353:             }"}}, {"message": "itemPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 348, "start_column": 19, "end_line": null, "end_column": 48, "snippet": "  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {\n  351:                     result.push(f);\n  352:                 });\n  353:             }"}}, {"message": "itemPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 350, "start_column": 48, "end_line": null, "end_column": 56, "snippet": "  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {\n  351:                     result.push(f);\n  352:                 });\n  353:             }\n  354:             else {\n  355:                 result.push({ base: base, full: itemPath, storageAccount: storageAccount });"}}, {"message": "p", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 342, "start_column": 38, "end_line": null, "end_column": 39, "snippet": "  337:     }\n  338:     static toHexString(original) {\n  339:         let buff = new Buffer(original, 'utf8');\n  340:         return buff.toString('hex');\n  341:     }\n  342:     static getFilesRecursively(base, p, storageAccount) {\n  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {"}}, {"message": "p", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 345, "start_column": 20, "end_line": null, "end_column": 21, "snippet": "  340:         return buff.toString('hex');\n  341:     }\n  342:     static getFilesRecursively(base, p, storageAccount) {\n  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {"}}, {"message": "base", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 345, "start_column": 13, "end_line": null, "end_column": 21, "snippet": "  340:         return buff.toString('hex');\n  341:     }\n  342:     static getFilesRecursively(base, p, storageAccount) {\n  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {"}}, {"message": "base", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 342, "start_column": 32, "end_line": null, "end_column": 36, "snippet": "  337:     }\n  338:     static toHexString(original) {\n  339:         let buff = new Buffer(original, 'utf8');\n  340:         return buff.toString('hex');\n  341:     }\n  342:     static getFilesRecursively(base, p, storageAccount) {\n  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {"}}, {"message": "fs.readdirSync(p)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 347, "start_column": 9, "end_line": null, "end_column": 26, "snippet": "  342:     static getFilesRecursively(base, p, storageAccount) {\n  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {\n  351:                     result.push(f);\n  352:                 });"}}, {"message": "item", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 347, "start_column": 36, "end_line": null, "end_column": 40, "snippet": "  342:     static getFilesRecursively(base, p, storageAccount) {\n  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {\n  351:                     result.push(f);\n  352:                 });"}}, {"message": "item", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 348, "start_column": 43, "end_line": null, "end_column": 47, "snippet": "  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {\n  351:                     result.push(f);\n  352:                 });\n  353:             }"}}, {"message": "path.join(p, item)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 348, "start_column": 30, "end_line": null, "end_column": 48, "snippet": "  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {\n  351:                     result.push(f);\n  352:                 });\n  353:             }"}}, {"message": "itemPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 348, "start_column": 19, "end_line": null, "end_column": 48, "snippet": "  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {\n  351:                     result.push(f);\n  352:                 });\n  353:             }"}}, {"message": "itemPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 350, "start_column": 48, "end_line": null, "end_column": 56, "snippet": "  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {\n  351:                     result.push(f);\n  352:                 });\n  353:             }\n  354:             else {\n  355:                 result.push({ base: base, full: itemPath, storageAccount: storageAccount });"}}, {"message": "p", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 342, "start_column": 38, "end_line": null, "end_column": 39, "snippet": "  337:     }\n  338:     static toHexString(original) {\n  339:         let buff = new Buffer(original, 'utf8');\n  340:         return buff.toString('hex');\n  341:     }\n  342:     static getFilesRecursively(base, p, storageAccount) {\n  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {"}}, {"message": "p", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 345, "start_column": 20, "end_line": null, "end_column": 21, "snippet": "  340:         return buff.toString('hex');\n  341:     }\n  342:     static getFilesRecursively(base, p, storageAccount) {\n  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {"}}, {"message": "base", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 345, "start_column": 13, "end_line": null, "end_column": 21, "snippet": "  340:         return buff.toString('hex');\n  341:     }\n  342:     static getFilesRecursively(base, p, storageAccount) {\n  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {"}}, {"message": "base", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 350, "start_column": 42, "end_line": null, "end_column": 46, "snippet": "  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {\n  351:                     result.push(f);\n  352:                 });\n  353:             }\n  354:             else {\n  355:                 result.push({ base: base, full: itemPath, storageAccount: storageAccount });"}}, {"message": "base", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 342, "start_column": 32, "end_line": null, "end_column": 36, "snippet": "  337:     }\n  338:     static toHexString(original) {\n  339:         let buff = new Buffer(original, 'utf8');\n  340:         return buff.toString('hex');\n  341:     }\n  342:     static getFilesRecursively(base, p, storageAccount) {\n  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {"}}, {"message": "base", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 342, "start_column": 32, "end_line": null, "end_column": 36, "snippet": "  337:     }\n  338:     static toHexString(original) {\n  339:         let buff = new Buffer(original, 'utf8');\n  340:         return buff.toString('hex');\n  341:     }\n  342:     static getFilesRecursively(base, p, storageAccount) {\n  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {"}}]}
{"result_index": 8, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 342, "start_column": 38, "end_line": null, "end_column": 39, "snippet": "  337:     }\n  338:     static toHexString(original) {\n  339:         let buff = new Buffer(original, 'utf8');\n  340:         return buff.toString('hex');\n  341:     }\n  342:     static getFilesRecursively(base, p, storageAccount) {\n  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 347, "start_column": 9, "end_line": null, "end_column": 26, "snippet": "  342:     static getFilesRecursively(base, p, storageAccount) {\n  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {\n  351:                     result.push(f);\n  352:                 });"}, "path": [{"message": "fs.readdirSync(p)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 347, "start_column": 9, "end_line": null, "end_column": 26, "snippet": "  342:     static getFilesRecursively(base, p, storageAccount) {\n  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {\n  351:                     result.push(f);\n  352:                 });"}}, {"message": "item", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 347, "start_column": 36, "end_line": null, "end_column": 40, "snippet": "  342:     static getFilesRecursively(base, p, storageAccount) {\n  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {\n  351:                     result.push(f);\n  352:                 });"}}, {"message": "item", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 348, "start_column": 43, "end_line": null, "end_column": 47, "snippet": "  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {\n  351:                     result.push(f);\n  352:                 });\n  353:             }"}}, {"message": "path.join(p, item)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 348, "start_column": 30, "end_line": null, "end_column": 48, "snippet": "  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {\n  351:                     result.push(f);\n  352:                 });\n  353:             }"}}, {"message": "itemPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 348, "start_column": 19, "end_line": null, "end_column": 48, "snippet": "  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {\n  351:                     result.push(f);\n  352:                 });\n  353:             }"}}, {"message": "itemPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 350, "start_column": 48, "end_line": null, "end_column": 56, "snippet": "  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {\n  348:             const itemPath = path.join(p, item);\n  349:             if (fs.statSync(itemPath).isDirectory()) {\n  350:                 util.getFilesRecursively(base, itemPath, storageAccount).forEach((f) => {\n  351:                     result.push(f);\n  352:                 });\n  353:             }\n  354:             else {\n  355:                 result.push({ base: base, full: itemPath, storageAccount: storageAccount });"}}, {"message": "p", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 342, "start_column": 38, "end_line": null, "end_column": 39, "snippet": "  337:     }\n  338:     static toHexString(original) {\n  339:         let buff = new Buffer(original, 'utf8');\n  340:         return buff.toString('hex');\n  341:     }\n  342:     static getFilesRecursively(base, p, storageAccount) {\n  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {"}}, {"message": "p", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/usqlextpublisher.usql-vscode-ext-0.2.15/extension/out/src/features/util.js", "start_line": 342, "start_column": 38, "end_line": null, "end_column": 39, "snippet": "  337:     }\n  338:     static toHexString(original) {\n  339:         let buff = new Buffer(original, 'utf8');\n  340:         return buff.toString('hex');\n  341:     }\n  342:     static getFilesRecursively(base, p, storageAccount) {\n  343:         const result = [];\n  344:         if (base === undefined || base == '') {\n  345:             base = p;\n  346:         }\n  347:         fs.readdirSync(p).forEach((item) => {"}}]}
