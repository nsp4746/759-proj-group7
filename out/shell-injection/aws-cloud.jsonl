{"result_index": 0, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.\n(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/extension.js", "start_line": 407, "start_column": 42, "end_line": null, "end_column": 46, "snippet": "  402: }\n  403: \n  404: /////\n  405: \n  406: function setEventEmitterEvents() {\n  407:     eventEmitter.on('send_ch4_message', (data) => {\n  408:         websocketProvider.send_ch4_message(data);\n  409:     });\n  410: \n  411:     eventEmitter.on('request_connect', (environment) => {\n  412:         refreshEnvironmentsInSidebar().then(() => {"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 290, "start_column": 90, "end_line": null, "end_column": 102, "snippet": "  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });"}}, {"message": "[\"mkdir ... id() }]", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 290, "start_column": 80, "end_line": null, "end_column": 156, "snippet": "  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });"}}, {"message": "data", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/extension.js", "start_line": 407, "start_column": 42, "end_line": null, "end_column": 46, "snippet": "  402: }\n  403: \n  404: /////\n  405: \n  406: function setEventEmitterEvents() {\n  407:     eventEmitter.on('send_ch4_message', (data) => {\n  408:         websocketProvider.send_ch4_message(data);\n  409:     });\n  410: \n  411:     eventEmitter.on('request_connect', (environment) => {\n  412:         refreshEnvironmentsInSidebar().then(() => {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 290, "start_column": 90, "end_line": null, "end_column": 102, "snippet": "  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });"}}, {"message": "[\"mkdir ... id() }]", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 290, "start_column": 80, "end_line": null, "end_column": 156, "snippet": "  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });"}}, {"message": "data", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/extension.js", "start_line": 407, "start_column": 42, "end_line": null, "end_column": 46, "snippet": "  402: }\n  403: \n  404: /////\n  405: \n  406: function setEventEmitterEvents() {\n  407:     eventEmitter.on('send_ch4_message', (data) => {\n  408:         websocketProvider.send_ch4_message(data);\n  409:     });\n  410: \n  411:     eventEmitter.on('request_connect', (environment) => {\n  412:         refreshEnvironmentsInSidebar().then(() => {"}}, {"message": "data", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/extension.js", "start_line": 407, "start_column": 42, "end_line": null, "end_column": 46, "snippet": "  402: }\n  403: \n  404: /////\n  405: \n  406: function setEventEmitterEvents() {\n  407:     eventEmitter.on('send_ch4_message', (data) => {\n  408:         websocketProvider.send_ch4_message(data);\n  409:     });\n  410: \n  411:     eventEmitter.on('request_connect', (environment) => {\n  412:         refreshEnvironmentsInSidebar().then(() => {"}}]}
{"result_index": 1, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/extension.js", "start_line": 408, "start_column": 44, "end_line": null, "end_column": 48, "snippet": "  403: \n  404: /////\n  405: \n  406: function setEventEmitterEvents() {\n  407:     eventEmitter.on('send_ch4_message', (data) => {\n  408:         websocketProvider.send_ch4_message(data);\n  409:     });\n  410: \n  411:     eventEmitter.on('request_connect', (environment) => {\n  412:         refreshEnvironmentsInSidebar().then(() => {\n  413:             commandConnect(environment);"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 290, "start_column": 90, "end_line": null, "end_column": 102, "snippet": "  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });"}}, {"message": "[\"mkdir ... id() }]", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 290, "start_column": 80, "end_line": null, "end_column": 156, "snippet": "  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });"}}, {"message": "data", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/extension.js", "start_line": 407, "start_column": 42, "end_line": null, "end_column": 46, "snippet": "  402: }\n  403: \n  404: /////\n  405: \n  406: function setEventEmitterEvents() {\n  407:     eventEmitter.on('send_ch4_message', (data) => {\n  408:         websocketProvider.send_ch4_message(data);\n  409:     });\n  410: \n  411:     eventEmitter.on('request_connect', (environment) => {\n  412:         refreshEnvironmentsInSidebar().then(() => {"}}, {"message": "data", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/extension.js", "start_line": 408, "start_column": 44, "end_line": null, "end_column": 48, "snippet": "  403: \n  404: /////\n  405: \n  406: function setEventEmitterEvents() {\n  407:     eventEmitter.on('send_ch4_message', (data) => {\n  408:         websocketProvider.send_ch4_message(data);\n  409:     });\n  410: \n  411:     eventEmitter.on('request_connect', (environment) => {\n  412:         refreshEnvironmentsInSidebar().then(() => {\n  413:             commandConnect(environment);"}}]}
{"result_index": 2, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.\n(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 177, "start_column": 24, "end_line": null, "end_column": 32, "snippet": "  172:         });\n  173:     }\n  174:     uploadNewFile(filename) {\n  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 313, "start_column": 65, "end_line": null, "end_column": 77, "snippet": "  308:                                         console.log(\"Uploading new file\");\n  309:                                         this.uploadRemoteFile(relativePath, fs.readFileSync(filepath));\n  310:                                     }\n  311:                                     else if (lftime > ftime + SYNC_TIME_VARIANCE) {\n  312:                                         console.log(\"Updating existing file\");\n  313:                                         this.uploadExistingFile(relativePath, fs.readFileSync(filepath));\n  314:                                     }\n  315:                                     resolve();\n  316:                                 }\n  317:                                 else {\n  318:                                     console.log(\"Unknown file type\");"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 177, "start_column": 24, "end_line": null, "end_column": 32, "snippet": "  172:         });\n  173:     }\n  174:     uploadNewFile(filename) {\n  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 313, "start_column": 65, "end_line": null, "end_column": 77, "snippet": "  308:                                         console.log(\"Uploading new file\");\n  309:                                         this.uploadRemoteFile(relativePath, fs.readFileSync(filepath));\n  310:                                     }\n  311:                                     else if (lftime > ftime + SYNC_TIME_VARIANCE) {\n  312:                                         console.log(\"Updating existing file\");\n  313:                                         this.uploadExistingFile(relativePath, fs.readFileSync(filepath));\n  314:                                     }\n  315:                                     resolve();\n  316:                                 }\n  317:                                 else {\n  318:                                     console.log(\"Unknown file type\");"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 177, "start_column": 24, "end_line": null, "end_column": 32, "snippet": "  172:         });\n  173:     }\n  174:     uploadNewFile(filename) {\n  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 177, "start_column": 24, "end_line": null, "end_column": 32, "snippet": "  172:         });\n  173:     }\n  174:     uploadNewFile(filename) {\n  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({"}}]}
{"result_index": 3, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 178, "start_column": 38, "end_line": null, "end_column": 46, "snippet": "  173:     }\n  174:     uploadNewFile(filename) {\n  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 313, "start_column": 65, "end_line": null, "end_column": 77, "snippet": "  308:                                         console.log(\"Uploading new file\");\n  309:                                         this.uploadRemoteFile(relativePath, fs.readFileSync(filepath));\n  310:                                     }\n  311:                                     else if (lftime > ftime + SYNC_TIME_VARIANCE) {\n  312:                                         console.log(\"Updating existing file\");\n  313:                                         this.uploadExistingFile(relativePath, fs.readFileSync(filepath));\n  314:                                     }\n  315:                                     resolve();\n  316:                                 }\n  317:                                 else {\n  318:                                     console.log(\"Unknown file type\");"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 177, "start_column": 24, "end_line": null, "end_column": 32, "snippet": "  172:         });\n  173:     }\n  174:     uploadNewFile(filename) {\n  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 178, "start_column": 38, "end_line": null, "end_column": 46, "snippet": "  173:     }\n  174:     uploadNewFile(filename) {\n  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,"}}]}
{"result_index": 4, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.\n(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.\n(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 180, "start_column": 22, "end_line": null, "end_column": 30, "snippet": "  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,\n  184:                 jar: this.cookieJar,\n  185:                 headers: {"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 309, "start_column": 63, "end_line": null, "end_column": 75, "snippet": "  304:                                         }\n  305:                                     });\n  306:                                     console.log(\"ftime: \" + ftime);\n  307:                                     if (ftime == null) {\n  308:                                         console.log(\"Uploading new file\");\n  309:                                         this.uploadRemoteFile(relativePath, fs.readFileSync(filepath));\n  310:                                     }\n  311:                                     else if (lftime > ftime + SYNC_TIME_VARIANCE) {\n  312:                                         console.log(\"Updating existing file\");\n  313:                                         this.uploadExistingFile(relativePath, fs.readFileSync(filepath));\n  314:                                     }"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 180, "start_column": 22, "end_line": null, "end_column": 30, "snippet": "  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,\n  184:                 jar: this.cookieJar,\n  185:                 headers: {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 313, "start_column": 65, "end_line": null, "end_column": 77, "snippet": "  308:                                         console.log(\"Uploading new file\");\n  309:                                         this.uploadRemoteFile(relativePath, fs.readFileSync(filepath));\n  310:                                     }\n  311:                                     else if (lftime > ftime + SYNC_TIME_VARIANCE) {\n  312:                                         console.log(\"Updating existing file\");\n  313:                                         this.uploadExistingFile(relativePath, fs.readFileSync(filepath));\n  314:                                     }\n  315:                                     resolve();\n  316:                                 }\n  317:                                 else {\n  318:                                     console.log(\"Unknown file type\");"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 177, "start_column": 24, "end_line": null, "end_column": 32, "snippet": "  172:         });\n  173:     }\n  174:     uploadNewFile(filename) {\n  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 178, "start_column": 38, "end_line": null, "end_column": 46, "snippet": "  173:     }\n  174:     uploadNewFile(filename) {\n  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 180, "start_column": 22, "end_line": null, "end_column": 30, "snippet": "  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,\n  184:                 jar: this.cookieJar,\n  185:                 headers: {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 309, "start_column": 63, "end_line": null, "end_column": 75, "snippet": "  304:                                         }\n  305:                                     });\n  306:                                     console.log(\"ftime: \" + ftime);\n  307:                                     if (ftime == null) {\n  308:                                         console.log(\"Uploading new file\");\n  309:                                         this.uploadRemoteFile(relativePath, fs.readFileSync(filepath));\n  310:                                     }\n  311:                                     else if (lftime > ftime + SYNC_TIME_VARIANCE) {\n  312:                                         console.log(\"Updating existing file\");\n  313:                                         this.uploadExistingFile(relativePath, fs.readFileSync(filepath));\n  314:                                     }"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 180, "start_column": 22, "end_line": null, "end_column": 30, "snippet": "  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,\n  184:                 jar: this.cookieJar,\n  185:                 headers: {"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 180, "start_column": 22, "end_line": null, "end_column": 30, "snippet": "  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,\n  184:                 jar: this.cookieJar,\n  185:                 headers: {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 309, "start_column": 63, "end_line": null, "end_column": 75, "snippet": "  304:                                         }\n  305:                                     });\n  306:                                     console.log(\"ftime: \" + ftime);\n  307:                                     if (ftime == null) {\n  308:                                         console.log(\"Uploading new file\");\n  309:                                         this.uploadRemoteFile(relativePath, fs.readFileSync(filepath));\n  310:                                     }\n  311:                                     else if (lftime > ftime + SYNC_TIME_VARIANCE) {\n  312:                                         console.log(\"Updating existing file\");\n  313:                                         this.uploadExistingFile(relativePath, fs.readFileSync(filepath));\n  314:                                     }"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 180, "start_column": 22, "end_line": null, "end_column": 30, "snippet": "  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,\n  184:                 jar: this.cookieJar,\n  185:                 headers: {"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 180, "start_column": 22, "end_line": null, "end_column": 30, "snippet": "  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,\n  184:                 jar: this.cookieJar,\n  185:                 headers: {"}}]}
{"result_index": 5, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 183, "start_column": 22, "end_line": null, "end_column": 134, "snippet": "  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,\n  184:                 jar: this.cookieJar,\n  185:                 headers: {\n  186:                     'Content-Type': 'text/plain',\n  187:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  188:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 309, "start_column": 63, "end_line": null, "end_column": 75, "snippet": "  304:                                         }\n  305:                                     });\n  306:                                     console.log(\"ftime: \" + ftime);\n  307:                                     if (ftime == null) {\n  308:                                         console.log(\"Uploading new file\");\n  309:                                         this.uploadRemoteFile(relativePath, fs.readFileSync(filepath));\n  310:                                     }\n  311:                                     else if (lftime > ftime + SYNC_TIME_VARIANCE) {\n  312:                                         console.log(\"Updating existing file\");\n  313:                                         this.uploadExistingFile(relativePath, fs.readFileSync(filepath));\n  314:                                     }"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 180, "start_column": 22, "end_line": null, "end_column": 30, "snippet": "  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,\n  184:                 jar: this.cookieJar,\n  185:                 headers: {"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 183, "start_column": 126, "end_line": null, "end_column": 134, "snippet": "  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,\n  184:                 jar: this.cookieJar,\n  185:                 headers: {\n  186:                     'Content-Type': 'text/plain',\n  187:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  188:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}, {"message": "'https: ... ilename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 183, "start_column": 22, "end_line": null, "end_column": 134, "snippet": "  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,\n  184:                 jar: this.cookieJar,\n  185:                 headers: {\n  186:                     'Content-Type': 'text/plain',\n  187:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  188:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 313, "start_column": 65, "end_line": null, "end_column": 77, "snippet": "  308:                                         console.log(\"Uploading new file\");\n  309:                                         this.uploadRemoteFile(relativePath, fs.readFileSync(filepath));\n  310:                                     }\n  311:                                     else if (lftime > ftime + SYNC_TIME_VARIANCE) {\n  312:                                         console.log(\"Updating existing file\");\n  313:                                         this.uploadExistingFile(relativePath, fs.readFileSync(filepath));\n  314:                                     }\n  315:                                     resolve();\n  316:                                 }\n  317:                                 else {\n  318:                                     console.log(\"Unknown file type\");"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 177, "start_column": 24, "end_line": null, "end_column": 32, "snippet": "  172:         });\n  173:     }\n  174:     uploadNewFile(filename) {\n  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 178, "start_column": 38, "end_line": null, "end_column": 46, "snippet": "  173:     }\n  174:     uploadNewFile(filename) {\n  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 180, "start_column": 22, "end_line": null, "end_column": 30, "snippet": "  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,\n  184:                 jar: this.cookieJar,\n  185:                 headers: {"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 183, "start_column": 126, "end_line": null, "end_column": 134, "snippet": "  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,\n  184:                 jar: this.cookieJar,\n  185:                 headers: {\n  186:                     'Content-Type': 'text/plain',\n  187:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  188:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}, {"message": "'https: ... ilename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 183, "start_column": 22, "end_line": null, "end_column": 134, "snippet": "  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,\n  184:                 jar: this.cookieJar,\n  185:                 headers: {\n  186:                     'Content-Type': 'text/plain',\n  187:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  188:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}]}
{"result_index": 6, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 183, "start_column": 126, "end_line": null, "end_column": 134, "snippet": "  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,\n  184:                 jar: this.cookieJar,\n  185:                 headers: {\n  186:                     'Content-Type': 'text/plain',\n  187:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  188:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 309, "start_column": 63, "end_line": null, "end_column": 75, "snippet": "  304:                                         }\n  305:                                     });\n  306:                                     console.log(\"ftime: \" + ftime);\n  307:                                     if (ftime == null) {\n  308:                                         console.log(\"Uploading new file\");\n  309:                                         this.uploadRemoteFile(relativePath, fs.readFileSync(filepath));\n  310:                                     }\n  311:                                     else if (lftime > ftime + SYNC_TIME_VARIANCE) {\n  312:                                         console.log(\"Updating existing file\");\n  313:                                         this.uploadExistingFile(relativePath, fs.readFileSync(filepath));\n  314:                                     }"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 180, "start_column": 22, "end_line": null, "end_column": 30, "snippet": "  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,\n  184:                 jar: this.cookieJar,\n  185:                 headers: {"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 183, "start_column": 126, "end_line": null, "end_column": 134, "snippet": "  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,\n  184:                 jar: this.cookieJar,\n  185:                 headers: {\n  186:                     'Content-Type': 'text/plain',\n  187:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  188:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 313, "start_column": 65, "end_line": null, "end_column": 77, "snippet": "  308:                                         console.log(\"Uploading new file\");\n  309:                                         this.uploadRemoteFile(relativePath, fs.readFileSync(filepath));\n  310:                                     }\n  311:                                     else if (lftime > ftime + SYNC_TIME_VARIANCE) {\n  312:                                         console.log(\"Updating existing file\");\n  313:                                         this.uploadExistingFile(relativePath, fs.readFileSync(filepath));\n  314:                                     }\n  315:                                     resolve();\n  316:                                 }\n  317:                                 else {\n  318:                                     console.log(\"Unknown file type\");"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 177, "start_column": 24, "end_line": null, "end_column": 32, "snippet": "  172:         });\n  173:     }\n  174:     uploadNewFile(filename) {\n  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 178, "start_column": 38, "end_line": null, "end_column": 46, "snippet": "  173:     }\n  174:     uploadNewFile(filename) {\n  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 180, "start_column": 22, "end_line": null, "end_column": 30, "snippet": "  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,\n  184:                 jar: this.cookieJar,\n  185:                 headers: {"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 183, "start_column": 126, "end_line": null, "end_column": 134, "snippet": "  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,\n  184:                 jar: this.cookieJar,\n  185:                 headers: {\n  186:                     'Content-Type': 'text/plain',\n  187:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  188:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}]}
{"result_index": 7, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 200, "start_column": 47, "end_line": null, "end_column": 55, "snippet": "  195:                 console.log(body);\n  196:                 let response = httpResponse; //JSON.parse(httpResponse);\n  197:                 if (response && response.statusCode == 429) { // retry with backoff\n  198:                     console.warn(\"retrying with backoff\");\n  199:                     setTimeout(() => {\n  200:                         this.uploadRemoteFile(filename, content).then(() => {\n  201:                             resolve();\n  202:                         }).catch(err => {\n  203:                             reject(err);\n  204:                         });\n  205:                     }, response.error.retryIn);"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 309, "start_column": 63, "end_line": null, "end_column": 75, "snippet": "  304:                                         }\n  305:                                     });\n  306:                                     console.log(\"ftime: \" + ftime);\n  307:                                     if (ftime == null) {\n  308:                                         console.log(\"Uploading new file\");\n  309:                                         this.uploadRemoteFile(relativePath, fs.readFileSync(filepath));\n  310:                                     }\n  311:                                     else if (lftime > ftime + SYNC_TIME_VARIANCE) {\n  312:                                         console.log(\"Updating existing file\");\n  313:                                         this.uploadExistingFile(relativePath, fs.readFileSync(filepath));\n  314:                                     }"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 180, "start_column": 22, "end_line": null, "end_column": 30, "snippet": "  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,\n  184:                 jar: this.cookieJar,\n  185:                 headers: {"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 200, "start_column": 47, "end_line": null, "end_column": 55, "snippet": "  195:                 console.log(body);\n  196:                 let response = httpResponse; //JSON.parse(httpResponse);\n  197:                 if (response && response.statusCode == 429) { // retry with backoff\n  198:                     console.warn(\"retrying with backoff\");\n  199:                     setTimeout(() => {\n  200:                         this.uploadRemoteFile(filename, content).then(() => {\n  201:                             resolve();\n  202:                         }).catch(err => {\n  203:                             reject(err);\n  204:                         });\n  205:                     }, response.error.retryIn);"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 313, "start_column": 65, "end_line": null, "end_column": 77, "snippet": "  308:                                         console.log(\"Uploading new file\");\n  309:                                         this.uploadRemoteFile(relativePath, fs.readFileSync(filepath));\n  310:                                     }\n  311:                                     else if (lftime > ftime + SYNC_TIME_VARIANCE) {\n  312:                                         console.log(\"Updating existing file\");\n  313:                                         this.uploadExistingFile(relativePath, fs.readFileSync(filepath));\n  314:                                     }\n  315:                                     resolve();\n  316:                                 }\n  317:                                 else {\n  318:                                     console.log(\"Unknown file type\");"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 177, "start_column": 24, "end_line": null, "end_column": 32, "snippet": "  172:         });\n  173:     }\n  174:     uploadNewFile(filename) {\n  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 178, "start_column": 38, "end_line": null, "end_column": 46, "snippet": "  173:     }\n  174:     uploadNewFile(filename) {\n  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 180, "start_column": 22, "end_line": null, "end_column": 30, "snippet": "  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,\n  184:                 jar: this.cookieJar,\n  185:                 headers: {"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 200, "start_column": 47, "end_line": null, "end_column": 55, "snippet": "  195:                 console.log(body);\n  196:                 let response = httpResponse; //JSON.parse(httpResponse);\n  197:                 if (response && response.statusCode == 429) { // retry with backoff\n  198:                     console.warn(\"retrying with backoff\");\n  199:                     setTimeout(() => {\n  200:                         this.uploadRemoteFile(filename, content).then(() => {\n  201:                             resolve();\n  202:                         }).catch(err => {\n  203:                             reject(err);\n  204:                         });\n  205:                     }, response.error.retryIn);"}}]}
{"result_index": 8, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.\n(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.\n(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}]}
{"result_index": 9, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 234, "start_column": 49, "end_line": null, "end_column": 58, "snippet": "  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 234, "start_column": 49, "end_line": null, "end_column": 58, "snippet": "  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");"}}]}
{"result_index": 10, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 29, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 63, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "startPath + \"/\"", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 69, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "path.jo ...  + \"/\")", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 29, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}]}
{"result_index": 11, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 63, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 63, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}]}
{"result_index": 12, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 244, "start_column": 22, "end_line": null, "end_column": 166, "snippet": "  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',\n  248:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  249:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 244, "start_column": 150, "end_line": null, "end_column": 159, "snippet": "  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',\n  248:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  249:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}, {"message": "Utils.E ... rtPath)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 244, "start_column": 125, "end_line": null, "end_column": 160, "snippet": "  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',\n  248:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  249:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}, {"message": "'https: ... ) + \"/\"", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 244, "start_column": 22, "end_line": null, "end_column": 166, "snippet": "  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',\n  248:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  249:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}]}
{"result_index": 13, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 244, "start_column": 22, "end_line": null, "end_column": 160, "snippet": "  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',\n  248:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  249:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 244, "start_column": 150, "end_line": null, "end_column": 159, "snippet": "  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',\n  248:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  249:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}, {"message": "Utils.E ... rtPath)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 244, "start_column": 125, "end_line": null, "end_column": 160, "snippet": "  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',\n  248:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  249:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}, {"message": "'https: ... rtPath)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 244, "start_column": 22, "end_line": null, "end_column": 160, "snippet": "  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',\n  248:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  249:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}]}
{"result_index": 14, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 244, "start_column": 125, "end_line": null, "end_column": 160, "snippet": "  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',\n  248:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  249:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 244, "start_column": 150, "end_line": null, "end_column": 159, "snippet": "  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',\n  248:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  249:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}, {"message": "Utils.E ... rtPath)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 244, "start_column": 125, "end_line": null, "end_column": 160, "snippet": "  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',\n  248:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  249:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}]}
{"result_index": 15, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 269, "start_column": 56, "end_line": null, "end_column": 65, "snippet": "  264:                 catch (err) {\n  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 63, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "startPath + \"/\"", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 69, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "path.jo ...  + \"/\")", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 29, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "inodePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 17, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "inodePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 269, "start_column": 56, "end_line": null, "end_column": 65, "snippet": "  264:                 catch (err) {\n  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);"}}]}
{"result_index": 16, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.\n(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}]}
{"result_index": 17, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 273, "start_column": 48, "end_line": null, "end_column": 57, "snippet": "  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 63, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "startPath + \"/\"", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 69, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "path.jo ...  + \"/\")", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 29, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "inodePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 17, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "inodePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 273, "start_column": 48, "end_line": null, "end_column": 57, "snippet": "  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }"}}]}
{"result_index": 18, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.\n(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 275, "start_column": 26, "end_line": null, "end_column": 31, "snippet": "  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 275, "start_column": 26, "end_line": null, "end_column": 31, "snippet": "  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 275, "start_column": 26, "end_line": null, "end_column": 31, "snippet": "  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);"}}]}
{"result_index": 19, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.\n(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.\n(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}]}
{"result_index": 20, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 54, "end_line": null, "end_column": 63, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "startPath + \"/\"", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 54, "end_line": null, "end_column": 69, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}]}
{"result_index": 21, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 54, "end_line": null, "end_column": 63, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 54, "end_line": null, "end_column": 63, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}]}
{"result_index": 22, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 281, "start_column": 59, "end_line": null, "end_column": 71, "snippet": "  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 281, "start_column": 59, "end_line": null, "end_column": 71, "snippet": "  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);"}}]}
{"result_index": 23, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 282, "start_column": 29, "end_line": null, "end_column": 41, "snippet": "  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 282, "start_column": 29, "end_line": null, "end_column": 41, "snippet": "  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");"}}]}
{"result_index": 24, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 282, "start_column": 55, "end_line": null, "end_column": 67, "snippet": "  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 282, "start_column": 55, "end_line": null, "end_column": 67, "snippet": "  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");"}}]}
{"result_index": 25, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 282, "start_column": 85, "end_line": null, "end_column": 97, "snippet": "  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 282, "start_column": 85, "end_line": null, "end_column": 97, "snippet": "  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");"}}]}
{"result_index": 26, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 44, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 65, "end_line": null, "end_column": 69, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 44, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 63, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "startPath + \"/\"", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 69, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "path.jo ...  + \"/\")", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 29, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "inodePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 17, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "inodePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 54, "end_line": null, "end_column": 63, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 44, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}]}
{"result_index": 27, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 287, "start_column": 41, "end_line": null, "end_column": 107, "snippet": "  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 287, "start_column": 95, "end_line": null, "end_column": 107, "snippet": "  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();"}}, {"message": "\"Beginn ... ivePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 287, "start_column": 41, "end_line": null, "end_column": 107, "snippet": "  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 65, "end_line": null, "end_column": 69, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 44, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "filepath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 33, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "filepath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 287, "start_column": 77, "end_line": null, "end_column": 85, "snippet": "  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();"}}, {"message": "\"Beginn ... ivePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 287, "start_column": 41, "end_line": null, "end_column": 107, "snippet": "  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();"}}]}
{"result_index": 28, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 287, "start_column": 41, "end_line": null, "end_column": 92, "snippet": "  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 65, "end_line": null, "end_column": 69, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 44, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "filepath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 33, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "filepath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 287, "start_column": 77, "end_line": null, "end_column": 85, "snippet": "  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();"}}, {"message": "\"Beginn ...  + \" (\"", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 287, "start_column": 41, "end_line": null, "end_column": 92, "snippet": "  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 63, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "startPath + \"/\"", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 69, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "path.jo ...  + \"/\")", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 29, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "inodePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 17, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "inodePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 54, "end_line": null, "end_column": 63, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 44, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "filepath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 33, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "filepath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 287, "start_column": 77, "end_line": null, "end_column": 85, "snippet": "  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();"}}, {"message": "\"Beginn ...  + \" (\"", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 287, "start_column": 41, "end_line": null, "end_column": 92, "snippet": "  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();"}}]}
{"result_index": 29, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 287, "start_column": 41, "end_line": null, "end_column": 85, "snippet": "  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 65, "end_line": null, "end_column": 69, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 44, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "filepath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 33, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "filepath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 287, "start_column": 77, "end_line": null, "end_column": 85, "snippet": "  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();"}}, {"message": "\"Beginn ... ilepath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 287, "start_column": 41, "end_line": null, "end_column": 85, "snippet": "  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 63, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "startPath + \"/\"", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 69, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "path.jo ...  + \"/\")", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 29, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "inodePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 17, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "inodePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 54, "end_line": null, "end_column": 63, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 44, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "filepath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 33, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "filepath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 287, "start_column": 77, "end_line": null, "end_column": 85, "snippet": "  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();"}}, {"message": "\"Beginn ... ilepath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 287, "start_column": 41, "end_line": null, "end_column": 85, "snippet": "  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();"}}]}
{"result_index": 30, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 287, "start_column": 77, "end_line": null, "end_column": 85, "snippet": "  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 65, "end_line": null, "end_column": 69, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 44, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "filepath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 33, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "filepath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 287, "start_column": 77, "end_line": null, "end_column": 85, "snippet": "  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 63, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "startPath + \"/\"", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 69, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "path.jo ...  + \"/\")", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 29, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "inodePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 17, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "inodePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 54, "end_line": null, "end_column": 63, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 44, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "filepath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 33, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "filepath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 287, "start_column": 77, "end_line": null, "end_column": 85, "snippet": "  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();"}}]}
{"result_index": 31, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 287, "start_column": 95, "end_line": null, "end_column": 107, "snippet": "  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 287, "start_column": 95, "end_line": null, "end_column": 107, "snippet": "  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();"}}]}
{"result_index": 32, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 290, "start_column": 90, "end_line": null, "end_column": 102, "snippet": "  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 290, "start_column": 90, "end_line": null, "end_column": 102, "snippet": "  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });"}}]}
{"result_index": 33, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}]}
{"result_index": 34, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 302, "start_column": 64, "end_line": null, "end_column": 76, "snippet": "  297:                                 else if (fstat.isFile()) {\n  298:                                     let ftime = null;\n  299:                                     let lftime = new Date(fstat['mtime']).getTime();\n  300:                                     console.log(\"Checking remote stats now\");\n  301:                                     remoteStats.forEach(remoteStat => {\n  302:                                         if (remoteStat.name == relativePath) {\n  303:                                             ftime = remoteStat.mtime;\n  304:                                         }\n  305:                                     });\n  306:                                     console.log(\"ftime: \" + ftime);\n  307:                                     if (ftime == null) {"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 302, "start_column": 64, "end_line": null, "end_column": 76, "snippet": "  297:                                 else if (fstat.isFile()) {\n  298:                                     let ftime = null;\n  299:                                     let lftime = new Date(fstat['mtime']).getTime();\n  300:                                     console.log(\"Checking remote stats now\");\n  301:                                     remoteStats.forEach(remoteStat => {\n  302:                                         if (remoteStat.name == relativePath) {\n  303:                                             ftime = remoteStat.mtime;\n  304:                                         }\n  305:                                     });\n  306:                                     console.log(\"ftime: \" + ftime);\n  307:                                     if (ftime == null) {"}}]}
{"result_index": 35, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 309, "start_column": 63, "end_line": null, "end_column": 75, "snippet": "  304:                                         }\n  305:                                     });\n  306:                                     console.log(\"ftime: \" + ftime);\n  307:                                     if (ftime == null) {\n  308:                                         console.log(\"Uploading new file\");\n  309:                                         this.uploadRemoteFile(relativePath, fs.readFileSync(filepath));\n  310:                                     }\n  311:                                     else if (lftime > ftime + SYNC_TIME_VARIANCE) {\n  312:                                         console.log(\"Updating existing file\");\n  313:                                         this.uploadExistingFile(relativePath, fs.readFileSync(filepath));\n  314:                                     }"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 309, "start_column": 63, "end_line": null, "end_column": 75, "snippet": "  304:                                         }\n  305:                                     });\n  306:                                     console.log(\"ftime: \" + ftime);\n  307:                                     if (ftime == null) {\n  308:                                         console.log(\"Uploading new file\");\n  309:                                         this.uploadRemoteFile(relativePath, fs.readFileSync(filepath));\n  310:                                     }\n  311:                                     else if (lftime > ftime + SYNC_TIME_VARIANCE) {\n  312:                                         console.log(\"Updating existing file\");\n  313:                                         this.uploadExistingFile(relativePath, fs.readFileSync(filepath));\n  314:                                     }"}}]}
{"result_index": 36, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 313, "start_column": 65, "end_line": null, "end_column": 77, "snippet": "  308:                                         console.log(\"Uploading new file\");\n  309:                                         this.uploadRemoteFile(relativePath, fs.readFileSync(filepath));\n  310:                                     }\n  311:                                     else if (lftime > ftime + SYNC_TIME_VARIANCE) {\n  312:                                         console.log(\"Updating existing file\");\n  313:                                         this.uploadExistingFile(relativePath, fs.readFileSync(filepath));\n  314:                                     }\n  315:                                     resolve();\n  316:                                 }\n  317:                                 else {\n  318:                                     console.log(\"Unknown file type\");"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 313, "start_column": 65, "end_line": null, "end_column": 77, "snippet": "  308:                                         console.log(\"Uploading new file\");\n  309:                                         this.uploadRemoteFile(relativePath, fs.readFileSync(filepath));\n  310:                                     }\n  311:                                     else if (lftime > ftime + SYNC_TIME_VARIANCE) {\n  312:                                         console.log(\"Updating existing file\");\n  313:                                         this.uploadExistingFile(relativePath, fs.readFileSync(filepath));\n  314:                                     }\n  315:                                     resolve();\n  316:                                 }\n  317:                                 else {\n  318:                                     console.log(\"Unknown file type\");"}}]}
{"result_index": 37, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.\n(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 156, "start_column": 29, "end_line": null, "end_column": 32, "snippet": "  151:         }\n  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 244, "start_column": 150, "end_line": null, "end_column": 159, "snippet": "  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',\n  248:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  249:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 156, "start_column": 29, "end_line": null, "end_column": 32, "snippet": "  151:         }\n  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 244, "start_column": 150, "end_line": null, "end_column": 159, "snippet": "  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',\n  248:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  249:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 156, "start_column": 29, "end_line": null, "end_column": 32, "snippet": "  151:         }\n  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 156, "start_column": 29, "end_line": null, "end_column": 32, "snippet": "  151:         }\n  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;"}}]}
{"result_index": 38, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 157, "start_column": 9, "end_line": null, "end_column": 15, "snippet": "  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;\n  162: function GetRegion() {"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 244, "start_column": 150, "end_line": null, "end_column": 159, "snippet": "  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',\n  248:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  249:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 156, "start_column": 29, "end_line": null, "end_column": 32, "snippet": "  151:         }\n  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 157, "start_column": 9, "end_line": null, "end_column": 12, "snippet": "  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;\n  162: function GetRegion() {"}}, {"message": "str[0]", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 157, "start_column": 9, "end_line": null, "end_column": 15, "snippet": "  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;\n  162: function GetRegion() {"}}]}
{"result_index": 39, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 157, "start_column": 9, "end_line": null, "end_column": 12, "snippet": "  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;\n  162: function GetRegion() {"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 244, "start_column": 150, "end_line": null, "end_column": 159, "snippet": "  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',\n  248:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  249:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 156, "start_column": 29, "end_line": null, "end_column": 32, "snippet": "  151:         }\n  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 157, "start_column": 9, "end_line": null, "end_column": 12, "snippet": "  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;\n  162: function GetRegion() {"}}]}
{"result_index": 40, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 157, "start_column": 26, "end_line": null, "end_column": 32, "snippet": "  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;\n  162: function GetRegion() {"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 244, "start_column": 150, "end_line": null, "end_column": 159, "snippet": "  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',\n  248:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  249:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 156, "start_column": 29, "end_line": null, "end_column": 32, "snippet": "  151:         }\n  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 157, "start_column": 26, "end_line": null, "end_column": 29, "snippet": "  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;\n  162: function GetRegion() {"}}, {"message": "str[0]", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 157, "start_column": 26, "end_line": null, "end_column": 32, "snippet": "  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;\n  162: function GetRegion() {"}}]}
{"result_index": 41, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 157, "start_column": 26, "end_line": null, "end_column": 29, "snippet": "  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;\n  162: function GetRegion() {"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 244, "start_column": 150, "end_line": null, "end_column": 159, "snippet": "  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',\n  248:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  249:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 156, "start_column": 29, "end_line": null, "end_column": 32, "snippet": "  151:         }\n  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 157, "start_column": 26, "end_line": null, "end_column": 29, "snippet": "  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;\n  162: function GetRegion() {"}}]}
{"result_index": 42, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 158, "start_column": 16, "end_line": null, "end_column": 19, "snippet": "  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;\n  162: function GetRegion() {\n  163:     let extensionConfig = vscode.workspace.getConfiguration('cloud9sync');"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 244, "start_column": 150, "end_line": null, "end_column": 159, "snippet": "  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',\n  248:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  249:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 156, "start_column": 29, "end_line": null, "end_column": 32, "snippet": "  151:         }\n  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 158, "start_column": 16, "end_line": null, "end_column": 19, "snippet": "  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;\n  162: function GetRegion() {\n  163:     let extensionConfig = vscode.workspace.getConfiguration('cloud9sync');"}}]}
{"result_index": 43, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 159, "start_column": 12, "end_line": null, "end_column": 21, "snippet": "  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;\n  162: function GetRegion() {\n  163:     let extensionConfig = vscode.workspace.getConfiguration('cloud9sync');\n  164:     return extensionConfig.get('region');"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 244, "start_column": 150, "end_line": null, "end_column": 159, "snippet": "  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',\n  248:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  249:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 156, "start_column": 29, "end_line": null, "end_column": 32, "snippet": "  151:         }\n  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 159, "start_column": 18, "end_line": null, "end_column": 21, "snippet": "  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;\n  162: function GetRegion() {\n  163:     let extensionConfig = vscode.workspace.getConfiguration('cloud9sync');\n  164:     return extensionConfig.get('region');"}}, {"message": "\"/\" + str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 159, "start_column": 12, "end_line": null, "end_column": 21, "snippet": "  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;\n  162: function GetRegion() {\n  163:     let extensionConfig = vscode.workspace.getConfiguration('cloud9sync');\n  164:     return extensionConfig.get('region');"}}]}
{"result_index": 44, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 159, "start_column": 18, "end_line": null, "end_column": 21, "snippet": "  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;\n  162: function GetRegion() {\n  163:     let extensionConfig = vscode.workspace.getConfiguration('cloud9sync');\n  164:     return extensionConfig.get('region');"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 244, "start_column": 150, "end_line": null, "end_column": 159, "snippet": "  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',\n  248:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  249:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 156, "start_column": 29, "end_line": null, "end_column": 32, "snippet": "  151:         }\n  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 159, "start_column": 18, "end_line": null, "end_column": 21, "snippet": "  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;\n  162: function GetRegion() {\n  163:     let extensionConfig = vscode.workspace.getConfiguration('cloud9sync');\n  164:     return extensionConfig.get('region');"}}]}
{"result_index": 45, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.\n(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 175, "start_column": 25, "end_line": null, "end_column": 30, "snippet": "  170:     if (proxy == \"\")\n  171:         return null;\n  172:     return proxy;\n  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "array", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 175, "start_column": 25, "end_line": null, "end_column": 30, "snippet": "  170:     if (proxy == \"\")\n  171:         return null;\n  172:     return proxy;\n  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "array", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 175, "start_column": 25, "end_line": null, "end_column": 30, "snippet": "  170:     if (proxy == \"\")\n  171:         return null;\n  172:     return proxy;\n  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);"}}, {"message": "array", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 175, "start_column": 25, "end_line": null, "end_column": 30, "snippet": "  170:     if (proxy == \"\")\n  171:         return null;\n  172:     return proxy;\n  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);"}}]}
{"result_index": 46, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 177, "start_column": 12, "end_line": null, "end_column": 24, "snippet": "  172:     return proxy;\n  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);\n  181:                 return results;\n  182:             }).catch((y) => {"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "array", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 175, "start_column": 25, "end_line": null, "end_column": 30, "snippet": "  170:     if (proxy == \"\")\n  171:         return null;\n  172:     return proxy;\n  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);"}}, {"message": "array", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 177, "start_column": 12, "end_line": null, "end_column": 17, "snippet": "  172:     return proxy;\n  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);\n  181:                 return results;\n  182:             }).catch((y) => {"}}, {"message": "array.reduce", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 177, "start_column": 12, "end_line": null, "end_column": 24, "snippet": "  172:     return proxy;\n  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);\n  181:                 return results;\n  182:             }).catch((y) => {"}}]}
{"result_index": 47, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 177, "start_column": 12, "end_line": null, "end_column": 17, "snippet": "  172:     return proxy;\n  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);\n  181:                 return results;\n  182:             }).catch((y) => {"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "array", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 175, "start_column": 25, "end_line": null, "end_column": 30, "snippet": "  170:     if (proxy == \"\")\n  171:         return null;\n  172:     return proxy;\n  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);"}}, {"message": "array", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 177, "start_column": 12, "end_line": null, "end_column": 17, "snippet": "  172:     return proxy;\n  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);\n  181:                 return results;\n  182:             }).catch((y) => {"}}]}
{"result_index": 48, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.\n(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.\n(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 177, "start_column": 38, "end_line": null, "end_column": 42, "snippet": "  172:     return proxy;\n  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);\n  181:                 return results;\n  182:             }).catch((y) => {"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "array", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 175, "start_column": 25, "end_line": null, "end_column": 30, "snippet": "  170:     if (proxy == \"\")\n  171:         return null;\n  172:     return proxy;\n  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);"}}, {"message": "array", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 177, "start_column": 12, "end_line": null, "end_column": 17, "snippet": "  172:     return proxy;\n  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);\n  181:                 return results;\n  182:             }).catch((y) => {"}}, {"message": "item", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 177, "start_column": 38, "end_line": null, "end_column": 42, "snippet": "  172:     return proxy;\n  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);\n  181:                 return results;\n  182:             }).catch((y) => {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "array", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 175, "start_column": 25, "end_line": null, "end_column": 30, "snippet": "  170:     if (proxy == \"\")\n  171:         return null;\n  172:     return proxy;\n  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);"}}, {"message": "array", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 177, "start_column": 12, "end_line": null, "end_column": 17, "snippet": "  172:     return proxy;\n  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);\n  181:                 return results;\n  182:             }).catch((y) => {"}}, {"message": "item", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 177, "start_column": 38, "end_line": null, "end_column": 42, "snippet": "  172:     return proxy;\n  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);\n  181:                 return results;\n  182:             }).catch((y) => {"}}, {"message": "item", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 177, "start_column": 38, "end_line": null, "end_column": 42, "snippet": "  172:     return proxy;\n  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);\n  181:                 return results;\n  182:             }).catch((y) => {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "array", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 175, "start_column": 25, "end_line": null, "end_column": 30, "snippet": "  170:     if (proxy == \"\")\n  171:         return null;\n  172:     return proxy;\n  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);"}}, {"message": "array", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 177, "start_column": 12, "end_line": null, "end_column": 17, "snippet": "  172:     return proxy;\n  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);\n  181:                 return results;\n  182:             }).catch((y) => {"}}, {"message": "item", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 177, "start_column": 38, "end_line": null, "end_column": 42, "snippet": "  172:     return proxy;\n  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);\n  181:                 return results;\n  182:             }).catch((y) => {"}}, {"message": "item", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 177, "start_column": 38, "end_line": null, "end_column": 42, "snippet": "  172:     return proxy;\n  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);\n  181:                 return results;\n  182:             }).catch((y) => {"}}]}
{"result_index": 49, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 179, "start_column": 23, "end_line": null, "end_column": 27, "snippet": "  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);\n  181:                 return results;\n  182:             }).catch((y) => {\n  183:                 console.error(y);\n  184:             });"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "array", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 175, "start_column": 25, "end_line": null, "end_column": 30, "snippet": "  170:     if (proxy == \"\")\n  171:         return null;\n  172:     return proxy;\n  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);"}}, {"message": "array", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 177, "start_column": 12, "end_line": null, "end_column": 17, "snippet": "  172:     return proxy;\n  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);\n  181:                 return results;\n  182:             }).catch((y) => {"}}, {"message": "item", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 177, "start_column": 38, "end_line": null, "end_column": 42, "snippet": "  172:     return proxy;\n  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);\n  181:                 return results;\n  182:             }).catch((y) => {"}}, {"message": "item", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 179, "start_column": 23, "end_line": null, "end_column": 27, "snippet": "  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);\n  181:                 return results;\n  182:             }).catch((y) => {\n  183:                 console.error(y);\n  184:             });"}}]}
{"result_index": 50, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.\n(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/websocketProvider.js", "start_line": 150, "start_column": 22, "end_line": null, "end_column": 26, "snippet": "  145:         this.send_ch4_message([\"call\", \"ping\", \"ping\", [\"serverTime\", { \"$\": this.next_event_id() }]]);\n  146:         this.send_ch4_message([\"extend\", \"collab\", { \"file\": \"c9.ide.collab/server/collab-server.js\" }, { \"$\": this.next_event_id() }]);\n  147:         this.eventEmitter.emit('websocket_init_complete');\n  148:         this.sessionState = \"CONNECTED\";\n  149:     }\n  150:     send_ch4_message(data) {\n  151:         let seq = this.my_seq;\n  152:         this.my_seq += 1;\n  153:         let msg = {\n  154:             'ack': this.last_seq,\n  155:             'seq': seq,"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 290, "start_column": 90, "end_line": null, "end_column": 102, "snippet": "  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });"}}, {"message": "[\"mkdir ... id() }]", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 290, "start_column": 80, "end_line": null, "end_column": 156, "snippet": "  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });"}}, {"message": "data", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/extension.js", "start_line": 407, "start_column": 42, "end_line": null, "end_column": 46, "snippet": "  402: }\n  403: \n  404: /////\n  405: \n  406: function setEventEmitterEvents() {\n  407:     eventEmitter.on('send_ch4_message', (data) => {\n  408:         websocketProvider.send_ch4_message(data);\n  409:     });\n  410: \n  411:     eventEmitter.on('request_connect', (environment) => {\n  412:         refreshEnvironmentsInSidebar().then(() => {"}}, {"message": "data", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/extension.js", "start_line": 408, "start_column": 44, "end_line": null, "end_column": 48, "snippet": "  403: \n  404: /////\n  405: \n  406: function setEventEmitterEvents() {\n  407:     eventEmitter.on('send_ch4_message', (data) => {\n  408:         websocketProvider.send_ch4_message(data);\n  409:     });\n  410: \n  411:     eventEmitter.on('request_connect', (environment) => {\n  412:         refreshEnvironmentsInSidebar().then(() => {\n  413:             commandConnect(environment);"}}, {"message": "data", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/websocketProvider.js", "start_line": 150, "start_column": 22, "end_line": null, "end_column": 26, "snippet": "  145:         this.send_ch4_message([\"call\", \"ping\", \"ping\", [\"serverTime\", { \"$\": this.next_event_id() }]]);\n  146:         this.send_ch4_message([\"extend\", \"collab\", { \"file\": \"c9.ide.collab/server/collab-server.js\" }, { \"$\": this.next_event_id() }]);\n  147:         this.eventEmitter.emit('websocket_init_complete');\n  148:         this.sessionState = \"CONNECTED\";\n  149:     }\n  150:     send_ch4_message(data) {\n  151:         let seq = this.my_seq;\n  152:         this.my_seq += 1;\n  153:         let msg = {\n  154:             'ack': this.last_seq,\n  155:             'seq': seq,"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 290, "start_column": 90, "end_line": null, "end_column": 102, "snippet": "  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });"}}, {"message": "[\"mkdir ... id() }]", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 290, "start_column": 80, "end_line": null, "end_column": 156, "snippet": "  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });"}}, {"message": "data", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/extension.js", "start_line": 407, "start_column": 42, "end_line": null, "end_column": 46, "snippet": "  402: }\n  403: \n  404: /////\n  405: \n  406: function setEventEmitterEvents() {\n  407:     eventEmitter.on('send_ch4_message', (data) => {\n  408:         websocketProvider.send_ch4_message(data);\n  409:     });\n  410: \n  411:     eventEmitter.on('request_connect', (environment) => {\n  412:         refreshEnvironmentsInSidebar().then(() => {"}}, {"message": "data", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/extension.js", "start_line": 408, "start_column": 44, "end_line": null, "end_column": 48, "snippet": "  403: \n  404: /////\n  405: \n  406: function setEventEmitterEvents() {\n  407:     eventEmitter.on('send_ch4_message', (data) => {\n  408:         websocketProvider.send_ch4_message(data);\n  409:     });\n  410: \n  411:     eventEmitter.on('request_connect', (environment) => {\n  412:         refreshEnvironmentsInSidebar().then(() => {\n  413:             commandConnect(environment);"}}, {"message": "data", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/websocketProvider.js", "start_line": 150, "start_column": 22, "end_line": null, "end_column": 26, "snippet": "  145:         this.send_ch4_message([\"call\", \"ping\", \"ping\", [\"serverTime\", { \"$\": this.next_event_id() }]]);\n  146:         this.send_ch4_message([\"extend\", \"collab\", { \"file\": \"c9.ide.collab/server/collab-server.js\" }, { \"$\": this.next_event_id() }]);\n  147:         this.eventEmitter.emit('websocket_init_complete');\n  148:         this.sessionState = \"CONNECTED\";\n  149:     }\n  150:     send_ch4_message(data) {\n  151:         let seq = this.my_seq;\n  152:         this.my_seq += 1;\n  153:         let msg = {\n  154:             'ack': this.last_seq,\n  155:             'seq': seq,"}}, {"message": "data", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/websocketProvider.js", "start_line": 150, "start_column": 22, "end_line": null, "end_column": 26, "snippet": "  145:         this.send_ch4_message([\"call\", \"ping\", \"ping\", [\"serverTime\", { \"$\": this.next_event_id() }]]);\n  146:         this.send_ch4_message([\"extend\", \"collab\", { \"file\": \"c9.ide.collab/server/collab-server.js\" }, { \"$\": this.next_event_id() }]);\n  147:         this.eventEmitter.emit('websocket_init_complete');\n  148:         this.sessionState = \"CONNECTED\";\n  149:     }\n  150:     send_ch4_message(data) {\n  151:         let seq = this.my_seq;\n  152:         this.my_seq += 1;\n  153:         let msg = {\n  154:             'ack': this.last_seq,\n  155:             'seq': seq,"}}]}
{"result_index": 51, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/websocketProvider.js", "start_line": 156, "start_column": 18, "end_line": null, "end_column": 22, "snippet": "  151:         let seq = this.my_seq;\n  152:         this.my_seq += 1;\n  153:         let msg = {\n  154:             'ack': this.last_seq,\n  155:             'seq': seq,\n  156:             'd': data\n  157:         };\n  158:         console.log(\"Sending:\");\n  159:         console.log('4' + JSON.stringify(msg));\n  160:         this.ws.send('4' + JSON.stringify(msg));\n  161:         return seq;"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 290, "start_column": 90, "end_line": null, "end_column": 102, "snippet": "  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });"}}, {"message": "[\"mkdir ... id() }]", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 290, "start_column": 80, "end_line": null, "end_column": 156, "snippet": "  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });"}}, {"message": "data", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/extension.js", "start_line": 407, "start_column": 42, "end_line": null, "end_column": 46, "snippet": "  402: }\n  403: \n  404: /////\n  405: \n  406: function setEventEmitterEvents() {\n  407:     eventEmitter.on('send_ch4_message', (data) => {\n  408:         websocketProvider.send_ch4_message(data);\n  409:     });\n  410: \n  411:     eventEmitter.on('request_connect', (environment) => {\n  412:         refreshEnvironmentsInSidebar().then(() => {"}}, {"message": "data", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/extension.js", "start_line": 408, "start_column": 44, "end_line": null, "end_column": 48, "snippet": "  403: \n  404: /////\n  405: \n  406: function setEventEmitterEvents() {\n  407:     eventEmitter.on('send_ch4_message', (data) => {\n  408:         websocketProvider.send_ch4_message(data);\n  409:     });\n  410: \n  411:     eventEmitter.on('request_connect', (environment) => {\n  412:         refreshEnvironmentsInSidebar().then(() => {\n  413:             commandConnect(environment);"}}, {"message": "data", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/websocketProvider.js", "start_line": 150, "start_column": 22, "end_line": null, "end_column": 26, "snippet": "  145:         this.send_ch4_message([\"call\", \"ping\", \"ping\", [\"serverTime\", { \"$\": this.next_event_id() }]]);\n  146:         this.send_ch4_message([\"extend\", \"collab\", { \"file\": \"c9.ide.collab/server/collab-server.js\" }, { \"$\": this.next_event_id() }]);\n  147:         this.eventEmitter.emit('websocket_init_complete');\n  148:         this.sessionState = \"CONNECTED\";\n  149:     }\n  150:     send_ch4_message(data) {\n  151:         let seq = this.my_seq;\n  152:         this.my_seq += 1;\n  153:         let msg = {\n  154:             'ack': this.last_seq,\n  155:             'seq': seq,"}}, {"message": "data", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/websocketProvider.js", "start_line": 156, "start_column": 18, "end_line": null, "end_column": 22, "snippet": "  151:         let seq = this.my_seq;\n  152:         this.my_seq += 1;\n  153:         let msg = {\n  154:             'ack': this.last_seq,\n  155:             'seq': seq,\n  156:             'd': data\n  157:         };\n  158:         console.log(\"Sending:\");\n  159:         console.log('4' + JSON.stringify(msg));\n  160:         this.ws.send('4' + JSON.stringify(msg));\n  161:         return seq;"}}]}
{"result_index": 52, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/websocketProvider.js", "start_line": 159, "start_column": 27, "end_line": null, "end_column": 46, "snippet": "  154:             'ack': this.last_seq,\n  155:             'seq': seq,\n  156:             'd': data\n  157:         };\n  158:         console.log(\"Sending:\");\n  159:         console.log('4' + JSON.stringify(msg));\n  160:         this.ws.send('4' + JSON.stringify(msg));\n  161:         return seq;\n  162:     }\n  163: }\n  164: exports.WebsocketProvider = WebsocketProvider;"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 290, "start_column": 90, "end_line": null, "end_column": 102, "snippet": "  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });"}}, {"message": "[\"mkdir ... id() }]", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 290, "start_column": 80, "end_line": null, "end_column": 156, "snippet": "  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });"}}, {"message": "data", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/extension.js", "start_line": 407, "start_column": 42, "end_line": null, "end_column": 46, "snippet": "  402: }\n  403: \n  404: /////\n  405: \n  406: function setEventEmitterEvents() {\n  407:     eventEmitter.on('send_ch4_message', (data) => {\n  408:         websocketProvider.send_ch4_message(data);\n  409:     });\n  410: \n  411:     eventEmitter.on('request_connect', (environment) => {\n  412:         refreshEnvironmentsInSidebar().then(() => {"}}, {"message": "data", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/extension.js", "start_line": 408, "start_column": 44, "end_line": null, "end_column": 48, "snippet": "  403: \n  404: /////\n  405: \n  406: function setEventEmitterEvents() {\n  407:     eventEmitter.on('send_ch4_message', (data) => {\n  408:         websocketProvider.send_ch4_message(data);\n  409:     });\n  410: \n  411:     eventEmitter.on('request_connect', (environment) => {\n  412:         refreshEnvironmentsInSidebar().then(() => {\n  413:             commandConnect(environment);"}}, {"message": "data", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/websocketProvider.js", "start_line": 150, "start_column": 22, "end_line": null, "end_column": 26, "snippet": "  145:         this.send_ch4_message([\"call\", \"ping\", \"ping\", [\"serverTime\", { \"$\": this.next_event_id() }]]);\n  146:         this.send_ch4_message([\"extend\", \"collab\", { \"file\": \"c9.ide.collab/server/collab-server.js\" }, { \"$\": this.next_event_id() }]);\n  147:         this.eventEmitter.emit('websocket_init_complete');\n  148:         this.sessionState = \"CONNECTED\";\n  149:     }\n  150:     send_ch4_message(data) {\n  151:         let seq = this.my_seq;\n  152:         this.my_seq += 1;\n  153:         let msg = {\n  154:             'ack': this.last_seq,\n  155:             'seq': seq,"}}, {"message": "data", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/websocketProvider.js", "start_line": 156, "start_column": 18, "end_line": null, "end_column": 22, "snippet": "  151:         let seq = this.my_seq;\n  152:         this.my_seq += 1;\n  153:         let msg = {\n  154:             'ack': this.last_seq,\n  155:             'seq': seq,\n  156:             'd': data\n  157:         };\n  158:         console.log(\"Sending:\");\n  159:         console.log('4' + JSON.stringify(msg));\n  160:         this.ws.send('4' + JSON.stringify(msg));\n  161:         return seq;"}}, {"message": "JSON.stringify(msg)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/websocketProvider.js", "start_line": 159, "start_column": 27, "end_line": null, "end_column": 46, "snippet": "  154:             'ack': this.last_seq,\n  155:             'seq': seq,\n  156:             'd': data\n  157:         };\n  158:         console.log(\"Sending:\");\n  159:         console.log('4' + JSON.stringify(msg));\n  160:         this.ws.send('4' + JSON.stringify(msg));\n  161:         return seq;\n  162:     }\n  163: }\n  164: exports.WebsocketProvider = WebsocketProvider;"}}]}
{"result_index": 53, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/websocketProvider.js", "start_line": 160, "start_column": 22, "end_line": null, "end_column": 47, "snippet": "  155:             'seq': seq,\n  156:             'd': data\n  157:         };\n  158:         console.log(\"Sending:\");\n  159:         console.log('4' + JSON.stringify(msg));\n  160:         this.ws.send('4' + JSON.stringify(msg));\n  161:         return seq;\n  162:     }\n  163: }\n  164: exports.WebsocketProvider = WebsocketProvider;"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 290, "start_column": 90, "end_line": null, "end_column": 102, "snippet": "  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });"}}, {"message": "[\"mkdir ... id() }]", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 290, "start_column": 80, "end_line": null, "end_column": 156, "snippet": "  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });"}}, {"message": "data", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/extension.js", "start_line": 407, "start_column": 42, "end_line": null, "end_column": 46, "snippet": "  402: }\n  403: \n  404: /////\n  405: \n  406: function setEventEmitterEvents() {\n  407:     eventEmitter.on('send_ch4_message', (data) => {\n  408:         websocketProvider.send_ch4_message(data);\n  409:     });\n  410: \n  411:     eventEmitter.on('request_connect', (environment) => {\n  412:         refreshEnvironmentsInSidebar().then(() => {"}}, {"message": "data", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/extension.js", "start_line": 408, "start_column": 44, "end_line": null, "end_column": 48, "snippet": "  403: \n  404: /////\n  405: \n  406: function setEventEmitterEvents() {\n  407:     eventEmitter.on('send_ch4_message', (data) => {\n  408:         websocketProvider.send_ch4_message(data);\n  409:     });\n  410: \n  411:     eventEmitter.on('request_connect', (environment) => {\n  412:         refreshEnvironmentsInSidebar().then(() => {\n  413:             commandConnect(environment);"}}, {"message": "data", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/websocketProvider.js", "start_line": 150, "start_column": 22, "end_line": null, "end_column": 26, "snippet": "  145:         this.send_ch4_message([\"call\", \"ping\", \"ping\", [\"serverTime\", { \"$\": this.next_event_id() }]]);\n  146:         this.send_ch4_message([\"extend\", \"collab\", { \"file\": \"c9.ide.collab/server/collab-server.js\" }, { \"$\": this.next_event_id() }]);\n  147:         this.eventEmitter.emit('websocket_init_complete');\n  148:         this.sessionState = \"CONNECTED\";\n  149:     }\n  150:     send_ch4_message(data) {\n  151:         let seq = this.my_seq;\n  152:         this.my_seq += 1;\n  153:         let msg = {\n  154:             'ack': this.last_seq,\n  155:             'seq': seq,"}}, {"message": "data", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/websocketProvider.js", "start_line": 156, "start_column": 18, "end_line": null, "end_column": 22, "snippet": "  151:         let seq = this.my_seq;\n  152:         this.my_seq += 1;\n  153:         let msg = {\n  154:             'ack': this.last_seq,\n  155:             'seq': seq,\n  156:             'd': data\n  157:         };\n  158:         console.log(\"Sending:\");\n  159:         console.log('4' + JSON.stringify(msg));\n  160:         this.ws.send('4' + JSON.stringify(msg));\n  161:         return seq;"}}, {"message": "JSON.stringify(msg)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/websocketProvider.js", "start_line": 160, "start_column": 28, "end_line": null, "end_column": 47, "snippet": "  155:             'seq': seq,\n  156:             'd': data\n  157:         };\n  158:         console.log(\"Sending:\");\n  159:         console.log('4' + JSON.stringify(msg));\n  160:         this.ws.send('4' + JSON.stringify(msg));\n  161:         return seq;\n  162:     }\n  163: }\n  164: exports.WebsocketProvider = WebsocketProvider;"}}, {"message": "'4' + J ... fy(msg)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/websocketProvider.js", "start_line": 160, "start_column": 22, "end_line": null, "end_column": 47, "snippet": "  155:             'seq': seq,\n  156:             'd': data\n  157:         };\n  158:         console.log(\"Sending:\");\n  159:         console.log('4' + JSON.stringify(msg));\n  160:         this.ws.send('4' + JSON.stringify(msg));\n  161:         return seq;\n  162:     }\n  163: }\n  164: exports.WebsocketProvider = WebsocketProvider;"}}]}
{"result_index": 54, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/websocketProvider.js", "start_line": 160, "start_column": 28, "end_line": null, "end_column": 47, "snippet": "  155:             'seq': seq,\n  156:             'd': data\n  157:         };\n  158:         console.log(\"Sending:\");\n  159:         console.log('4' + JSON.stringify(msg));\n  160:         this.ws.send('4' + JSON.stringify(msg));\n  161:         return seq;\n  162:     }\n  163: }\n  164: exports.WebsocketProvider = WebsocketProvider;"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 290, "start_column": 90, "end_line": null, "end_column": 102, "snippet": "  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });"}}, {"message": "[\"mkdir ... id() }]", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 290, "start_column": 80, "end_line": null, "end_column": 156, "snippet": "  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });"}}, {"message": "data", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/extension.js", "start_line": 407, "start_column": 42, "end_line": null, "end_column": 46, "snippet": "  402: }\n  403: \n  404: /////\n  405: \n  406: function setEventEmitterEvents() {\n  407:     eventEmitter.on('send_ch4_message', (data) => {\n  408:         websocketProvider.send_ch4_message(data);\n  409:     });\n  410: \n  411:     eventEmitter.on('request_connect', (environment) => {\n  412:         refreshEnvironmentsInSidebar().then(() => {"}}, {"message": "data", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/extension.js", "start_line": 408, "start_column": 44, "end_line": null, "end_column": 48, "snippet": "  403: \n  404: /////\n  405: \n  406: function setEventEmitterEvents() {\n  407:     eventEmitter.on('send_ch4_message', (data) => {\n  408:         websocketProvider.send_ch4_message(data);\n  409:     });\n  410: \n  411:     eventEmitter.on('request_connect', (environment) => {\n  412:         refreshEnvironmentsInSidebar().then(() => {\n  413:             commandConnect(environment);"}}, {"message": "data", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/websocketProvider.js", "start_line": 150, "start_column": 22, "end_line": null, "end_column": 26, "snippet": "  145:         this.send_ch4_message([\"call\", \"ping\", \"ping\", [\"serverTime\", { \"$\": this.next_event_id() }]]);\n  146:         this.send_ch4_message([\"extend\", \"collab\", { \"file\": \"c9.ide.collab/server/collab-server.js\" }, { \"$\": this.next_event_id() }]);\n  147:         this.eventEmitter.emit('websocket_init_complete');\n  148:         this.sessionState = \"CONNECTED\";\n  149:     }\n  150:     send_ch4_message(data) {\n  151:         let seq = this.my_seq;\n  152:         this.my_seq += 1;\n  153:         let msg = {\n  154:             'ack': this.last_seq,\n  155:             'seq': seq,"}}, {"message": "data", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/websocketProvider.js", "start_line": 156, "start_column": 18, "end_line": null, "end_column": 22, "snippet": "  151:         let seq = this.my_seq;\n  152:         this.my_seq += 1;\n  153:         let msg = {\n  154:             'ack': this.last_seq,\n  155:             'seq': seq,\n  156:             'd': data\n  157:         };\n  158:         console.log(\"Sending:\");\n  159:         console.log('4' + JSON.stringify(msg));\n  160:         this.ws.send('4' + JSON.stringify(msg));\n  161:         return seq;"}}, {"message": "JSON.stringify(msg)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/websocketProvider.js", "start_line": 160, "start_column": 28, "end_line": null, "end_column": 47, "snippet": "  155:             'seq': seq,\n  156:             'd': data\n  157:         };\n  158:         console.log(\"Sending:\");\n  159:         console.log('4' + JSON.stringify(msg));\n  160:         this.ws.send('4' + JSON.stringify(msg));\n  161:         return seq;\n  162:     }\n  163: }\n  164: exports.WebsocketProvider = WebsocketProvider;"}}]}
{"result_index": 55, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 156, "start_column": null, "end_line": 160, "end_column": 2, "snippet": "  151:         }\n  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 244, "start_column": 150, "end_line": null, "end_column": 159, "snippet": "  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',\n  248:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  249:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 156, "start_column": 29, "end_line": null, "end_column": 32, "snippet": "  151:         }\n  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 158, "start_column": 16, "end_line": null, "end_column": 19, "snippet": "  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;\n  162: function GetRegion() {\n  163:     let extensionConfig = vscode.workspace.getConfiguration('cloud9sync');"}}, {"message": "return of function EnsureLeadingSlash", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 156, "start_column": null, "end_line": 160, "end_column": 2, "snippet": "  151:         }\n  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 244, "start_column": 150, "end_line": null, "end_column": 159, "snippet": "  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',\n  248:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  249:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 156, "start_column": 29, "end_line": null, "end_column": 32, "snippet": "  151:         }\n  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 159, "start_column": 18, "end_line": null, "end_column": 21, "snippet": "  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;\n  162: function GetRegion() {\n  163:     let extensionConfig = vscode.workspace.getConfiguration('cloud9sync');\n  164:     return extensionConfig.get('region');"}}, {"message": "\"/\" + str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 159, "start_column": 12, "end_line": null, "end_column": 21, "snippet": "  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;\n  162: function GetRegion() {\n  163:     let extensionConfig = vscode.workspace.getConfiguration('cloud9sync');\n  164:     return extensionConfig.get('region');"}}, {"message": "return of function EnsureLeadingSlash", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 156, "start_column": null, "end_line": 160, "end_column": 2, "snippet": "  151:         }\n  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;"}}]}
{"result_index": 56, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 17, "end_line": null, "end_column": 26, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 63, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "startPath + \"/\"", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 69, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "path.jo ...  + \"/\")", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 29, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "inodePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 17, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "inodePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 17, "end_line": null, "end_column": 26, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}]}
{"result_index": 57, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 41, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 41, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}]}
{"result_index": 58, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 33, "end_line": null, "end_column": 41, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 65, "end_line": null, "end_column": 69, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 44, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "filepath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 33, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "filepath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 33, "end_line": null, "end_column": 41, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 63, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "startPath + \"/\"", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 69, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "path.jo ...  + \"/\")", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 29, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "inodePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 17, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "inodePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 54, "end_line": null, "end_column": 63, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 44, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "filepath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 33, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "filepath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 33, "end_line": null, "end_column": 41, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}]}
{"result_index": 59, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 282, "start_column": 29, "end_line": null, "end_column": 51, "snippet": "  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 282, "start_column": 29, "end_line": null, "end_column": 51, "snippet": "  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");"}}]}
{"result_index": 60, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 282, "start_column": 55, "end_line": null, "end_column": 81, "snippet": "  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 282, "start_column": 55, "end_line": null, "end_column": 81, "snippet": "  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");"}}]}
{"result_index": 61, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.\n(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 157, "start_column": 9, "end_line": null, "end_column": 22, "snippet": "  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;\n  162: function GetRegion() {"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 244, "start_column": 150, "end_line": null, "end_column": 159, "snippet": "  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',\n  248:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  249:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 156, "start_column": 29, "end_line": null, "end_column": 32, "snippet": "  151:         }\n  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 157, "start_column": 9, "end_line": null, "end_column": 22, "snippet": "  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;\n  162: function GetRegion() {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 244, "start_column": 150, "end_line": null, "end_column": 159, "snippet": "  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',\n  248:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  249:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 156, "start_column": 29, "end_line": null, "end_column": 32, "snippet": "  151:         }\n  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 157, "start_column": 9, "end_line": null, "end_column": 22, "snippet": "  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;\n  162: function GetRegion() {"}}]}
{"result_index": 62, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.\n(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 157, "start_column": 26, "end_line": null, "end_column": 40, "snippet": "  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;\n  162: function GetRegion() {"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 244, "start_column": 150, "end_line": null, "end_column": 159, "snippet": "  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',\n  248:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  249:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 156, "start_column": 29, "end_line": null, "end_column": 32, "snippet": "  151:         }\n  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 157, "start_column": 26, "end_line": null, "end_column": 40, "snippet": "  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;\n  162: function GetRegion() {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 244, "start_column": 150, "end_line": null, "end_column": 159, "snippet": "  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',\n  248:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  249:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 156, "start_column": 29, "end_line": null, "end_column": 32, "snippet": "  151:         }\n  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 157, "start_column": 26, "end_line": null, "end_column": 40, "snippet": "  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;\n  162: function GetRegion() {"}}]}
{"result_index": 63, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 235, "start_column": 28, "end_line": null, "end_column": 28, "snippet": "  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 235, "start_column": 28, "end_line": null, "end_column": 28, "snippet": "  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;"}}]}
{"result_index": 64, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 253, "start_column": 16, "end_line": null, "end_column": 16, "snippet": "  248:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  249:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,\n  250:                     'x-authorization': this.xauth\n  251:                 },\n  252:                 proxy: Utils.GetProxy()\n  253:             }, (err, httpResponse, body) => {\n  254:                 console.log(\"REMOTE STAT FOR UPLOAD\");\n  255:                 console.log(err);\n  256:                 console.log(body);\n  257:                 let remoteStats = [];\n  258:                 try {"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 63, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "startPath + \"/\"", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 69, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "path.jo ...  + \"/\")", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 29, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "inodePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 17, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "inodePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 253, "start_column": 16, "end_line": null, "end_column": 16, "snippet": "  248:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  249:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,\n  250:                     'x-authorization': this.xauth\n  251:                 },\n  252:                 proxy: Utils.GetProxy()\n  253:             }, (err, httpResponse, body) => {\n  254:                 console.log(\"REMOTE STAT FOR UPLOAD\");\n  255:                 console.log(err);\n  256:                 console.log(body);\n  257:                 let remoteStats = [];\n  258:                 try {"}}]}
{"result_index": 65, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 39, "end_line": null, "end_column": 39, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 63, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "startPath + \"/\"", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 69, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "path.jo ...  + \"/\")", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 29, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "inodePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 17, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "inodePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 39, "end_line": null, "end_column": 39, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}]}
{"result_index": 66, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 49, "end_line": null, "end_column": 49, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 49, "end_line": null, "end_column": 49, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}]}
{"result_index": 67, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.\n(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.\n(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 285, "start_column": 44, "end_line": null, "end_column": 44, "snippet": "  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 63, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "startPath + \"/\"", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 69, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "path.jo ...  + \"/\")", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 29, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "inodePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 17, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "inodePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 285, "start_column": 44, "end_line": null, "end_column": 44, "snippet": "  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 285, "start_column": 44, "end_line": null, "end_column": 44, "snippet": "  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 285, "start_column": 44, "end_line": null, "end_column": 44, "snippet": "  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);"}}]}
{"result_index": 68, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.\n(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 288, "start_column": 47, "end_line": null, "end_column": 47, "snippet": "  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 288, "start_column": 47, "end_line": null, "end_column": 47, "snippet": "  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 65, "end_line": null, "end_column": 69, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 44, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "filepath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 33, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "filepath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 288, "start_column": 47, "end_line": null, "end_column": 47, "snippet": "  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 63, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "startPath + \"/\"", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 69, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "path.jo ...  + \"/\")", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 29, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "inodePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 17, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "inodePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 54, "end_line": null, "end_column": 63, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 44, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "filepath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 33, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "filepath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 288, "start_column": 47, "end_line": null, "end_column": 47, "snippet": "  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {"}}]}
{"result_index": 69, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 301, "start_column": 57, "end_line": null, "end_column": 57, "snippet": "  296:                                 }\n  297:                                 else if (fstat.isFile()) {\n  298:                                     let ftime = null;\n  299:                                     let lftime = new Date(fstat['mtime']).getTime();\n  300:                                     console.log(\"Checking remote stats now\");\n  301:                                     remoteStats.forEach(remoteStat => {\n  302:                                         if (remoteStat.name == relativePath) {\n  303:                                             ftime = remoteStat.mtime;\n  304:                                         }\n  305:                                     });\n  306:                                     console.log(\"ftime: \" + ftime);"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 301, "start_column": 57, "end_line": null, "end_column": 57, "snippet": "  296:                                 }\n  297:                                 else if (fstat.isFile()) {\n  298:                                     let ftime = null;\n  299:                                     let lftime = new Date(fstat['mtime']).getTime();\n  300:                                     console.log(\"Checking remote stats now\");\n  301:                                     remoteStats.forEach(remoteStat => {\n  302:                                         if (remoteStat.name == relativePath) {\n  303:                                             ftime = remoteStat.mtime;\n  304:                                         }\n  305:                                     });\n  306:                                     console.log(\"ftime: \" + ftime);"}}]}
{"result_index": 70, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 181, "start_column": 28, "end_line": null, "end_column": 28, "snippet": "  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,\n  184:                 jar: this.cookieJar,\n  185:                 headers: {\n  186:                     'Content-Type': 'text/plain',"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 309, "start_column": 63, "end_line": null, "end_column": 75, "snippet": "  304:                                         }\n  305:                                     });\n  306:                                     console.log(\"ftime: \" + ftime);\n  307:                                     if (ftime == null) {\n  308:                                         console.log(\"Uploading new file\");\n  309:                                         this.uploadRemoteFile(relativePath, fs.readFileSync(filepath));\n  310:                                     }\n  311:                                     else if (lftime > ftime + SYNC_TIME_VARIANCE) {\n  312:                                         console.log(\"Updating existing file\");\n  313:                                         this.uploadExistingFile(relativePath, fs.readFileSync(filepath));\n  314:                                     }"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 180, "start_column": 22, "end_line": null, "end_column": 30, "snippet": "  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,\n  184:                 jar: this.cookieJar,\n  185:                 headers: {"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 181, "start_column": 28, "end_line": null, "end_column": 28, "snippet": "  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,\n  184:                 jar: this.cookieJar,\n  185:                 headers: {\n  186:                     'Content-Type': 'text/plain',"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 313, "start_column": 65, "end_line": null, "end_column": 77, "snippet": "  308:                                         console.log(\"Uploading new file\");\n  309:                                         this.uploadRemoteFile(relativePath, fs.readFileSync(filepath));\n  310:                                     }\n  311:                                     else if (lftime > ftime + SYNC_TIME_VARIANCE) {\n  312:                                         console.log(\"Updating existing file\");\n  313:                                         this.uploadExistingFile(relativePath, fs.readFileSync(filepath));\n  314:                                     }\n  315:                                     resolve();\n  316:                                 }\n  317:                                 else {\n  318:                                     console.log(\"Unknown file type\");"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 177, "start_column": 24, "end_line": null, "end_column": 32, "snippet": "  172:         });\n  173:     }\n  174:     uploadNewFile(filename) {\n  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 178, "start_column": 38, "end_line": null, "end_column": 46, "snippet": "  173:     }\n  174:     uploadNewFile(filename) {\n  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 180, "start_column": 22, "end_line": null, "end_column": 30, "snippet": "  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,\n  184:                 jar: this.cookieJar,\n  185:                 headers: {"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 181, "start_column": 28, "end_line": null, "end_column": 28, "snippet": "  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,\n  184:                 jar: this.cookieJar,\n  185:                 headers: {\n  186:                     'Content-Type': 'text/plain',"}}]}
{"result_index": 71, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 199, "start_column": 32, "end_line": null, "end_column": 32, "snippet": "  194:                 console.log(httpResponse);\n  195:                 console.log(body);\n  196:                 let response = httpResponse; //JSON.parse(httpResponse);\n  197:                 if (response && response.statusCode == 429) { // retry with backoff\n  198:                     console.warn(\"retrying with backoff\");\n  199:                     setTimeout(() => {\n  200:                         this.uploadRemoteFile(filename, content).then(() => {\n  201:                             resolve();\n  202:                         }).catch(err => {\n  203:                             reject(err);\n  204:                         });"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 309, "start_column": 63, "end_line": null, "end_column": 75, "snippet": "  304:                                         }\n  305:                                     });\n  306:                                     console.log(\"ftime: \" + ftime);\n  307:                                     if (ftime == null) {\n  308:                                         console.log(\"Uploading new file\");\n  309:                                         this.uploadRemoteFile(relativePath, fs.readFileSync(filepath));\n  310:                                     }\n  311:                                     else if (lftime > ftime + SYNC_TIME_VARIANCE) {\n  312:                                         console.log(\"Updating existing file\");\n  313:                                         this.uploadExistingFile(relativePath, fs.readFileSync(filepath));\n  314:                                     }"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 180, "start_column": 22, "end_line": null, "end_column": 30, "snippet": "  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,\n  184:                 jar: this.cookieJar,\n  185:                 headers: {"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 199, "start_column": 32, "end_line": null, "end_column": 32, "snippet": "  194:                 console.log(httpResponse);\n  195:                 console.log(body);\n  196:                 let response = httpResponse; //JSON.parse(httpResponse);\n  197:                 if (response && response.statusCode == 429) { // retry with backoff\n  198:                     console.warn(\"retrying with backoff\");\n  199:                     setTimeout(() => {\n  200:                         this.uploadRemoteFile(filename, content).then(() => {\n  201:                             resolve();\n  202:                         }).catch(err => {\n  203:                             reject(err);\n  204:                         });"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 313, "start_column": 65, "end_line": null, "end_column": 77, "snippet": "  308:                                         console.log(\"Uploading new file\");\n  309:                                         this.uploadRemoteFile(relativePath, fs.readFileSync(filepath));\n  310:                                     }\n  311:                                     else if (lftime > ftime + SYNC_TIME_VARIANCE) {\n  312:                                         console.log(\"Updating existing file\");\n  313:                                         this.uploadExistingFile(relativePath, fs.readFileSync(filepath));\n  314:                                     }\n  315:                                     resolve();\n  316:                                 }\n  317:                                 else {\n  318:                                     console.log(\"Unknown file type\");"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 177, "start_column": 24, "end_line": null, "end_column": 32, "snippet": "  172:         });\n  173:     }\n  174:     uploadNewFile(filename) {\n  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 178, "start_column": 38, "end_line": null, "end_column": 46, "snippet": "  173:     }\n  174:     uploadNewFile(filename) {\n  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 180, "start_column": 22, "end_line": null, "end_column": 30, "snippet": "  175:         return this.uploadRemoteFile(filename, \"\");\n  176:     }\n  177:     uploadExistingFile(filename, content) {\n  178:         return this.uploadRemoteFile(filename, content);\n  179:     }\n  180:     uploadRemoteFile(filename, content) {\n  181:         return new Promise((resolve, reject) => {\n  182:             request.put({\n  183:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment/' + filename,\n  184:                 jar: this.cookieJar,\n  185:                 headers: {"}}, {"message": "filename", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 199, "start_column": 32, "end_line": null, "end_column": 32, "snippet": "  194:                 console.log(httpResponse);\n  195:                 console.log(body);\n  196:                 let response = httpResponse; //JSON.parse(httpResponse);\n  197:                 if (response && response.statusCode == 429) { // retry with backoff\n  198:                     console.warn(\"retrying with backoff\");\n  199:                     setTimeout(() => {\n  200:                         this.uploadRemoteFile(filename, content).then(() => {\n  201:                             resolve();\n  202:                         }).catch(err => {\n  203:                             reject(err);\n  204:                         });"}}]}
{"result_index": 72, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 178, "start_column": 23, "end_line": null, "end_column": 23, "snippet": "  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);\n  181:                 return results;\n  182:             }).catch((y) => {\n  183:                 console.error(y);"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "array", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 175, "start_column": 25, "end_line": null, "end_column": 30, "snippet": "  170:     if (proxy == \"\")\n  171:         return null;\n  172:     return proxy;\n  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);"}}, {"message": "array", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 177, "start_column": 12, "end_line": null, "end_column": 17, "snippet": "  172:     return proxy;\n  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);\n  181:                 return results;\n  182:             }).catch((y) => {"}}, {"message": "item", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 177, "start_column": 38, "end_line": null, "end_column": 42, "snippet": "  172:     return proxy;\n  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);\n  181:                 return results;\n  182:             }).catch((y) => {"}}, {"message": "item", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 178, "start_column": 23, "end_line": null, "end_column": 23, "snippet": "  173: }\n  174: exports.GetProxy = GetProxy;\n  175: function ReducePromises(array, fn) {\n  176:     var results = [];\n  177:     return array.reduce(function (p, item) {\n  178:         return p.then(function () {\n  179:             return fn(item).then(function (data) {\n  180:                 results.push(data);\n  181:                 return results;\n  182:             }).catch((y) => {\n  183:                 console.error(y);"}}]}
{"result_index": 73, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}]}
{"result_index": 74, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 33, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 65, "end_line": null, "end_column": 69, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 44, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "filepath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 33, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 63, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "startPath + \"/\"", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 69, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "path.jo ...  + \"/\")", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 29, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "inodePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 17, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "inodePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 54, "end_line": null, "end_column": 63, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 44, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}, {"message": "filepath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 286, "start_column": 33, "end_line": null, "end_column": 70, "snippet": "  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {\n  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {"}}]}
{"result_index": 75, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 17, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 63, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "startPath + \"/\"", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 54, "end_line": null, "end_column": 69, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "path.jo ...  + \"/\")", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 29, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}, {"message": "inodePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 242, "start_column": 17, "end_line": null, "end_column": 70, "snippet": "  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");\n  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',"}}]}
{"result_index": 76, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 21, "end_line": null, "end_column": 22, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 21, "end_line": null, "end_column": 22, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}]}
{"result_index": 77, "rule_id": "js/ml-powered/shell-command-injection-from-environment", "message": "(Experimental) This shell command depends on [an uncontrolled value](1). Identified using machine learning.", "score": 1.0, "sink": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 158, "start_column": 16, "end_line": null, "end_column": 17, "snippet": "  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;\n  162: function GetRegion() {\n  163:     let extensionConfig = vscode.workspace.getConfiguration('cloud9sync');"}, "source": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}, "path": [{"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 270, "start_column": 45, "end_line": null, "end_column": 50, "snippet": "  265:                     console.log(\"Could not get remote stats\");\n  266:                     console.log(body);\n  267:                     resolve();\n  268:                 }\n  269:                 console.log(\"About to do readdir on\" + inodePath);\n  270:                 fs.readdir(inodePath, (err, files) => {\n  271:                     if (err)\n  272:                         reject(err);\n  273:                     console.log(\"Reading - \" + inodePath);\n  274:                     console.log(files);\n  275:                     if (!files) {"}}, {"message": "files", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 42, "end_line": null, "end_column": 47, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 279, "start_column": 50, "end_line": null, "end_column": 54, "snippet": "  274:                     console.log(files);\n  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }"}}, {"message": "file", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 71, "end_line": null, "end_column": 75, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "path.jo ... , file)", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 44, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 280, "start_column": 29, "end_line": null, "end_column": 76, "snippet": "  275:                     if (!files) {\n  276:                         console.log(\"No files, skipping...\");\n  277:                         resolve();\n  278:                     }\n  279:                     Utils.ReducePromises(files, (file) => {\n  280:                         let relativePath = path.join(startPath + \"/\", file);\n  281:                         console.log(\"Processing file: \" + relativePath);\n  282:                         if (relativePath == \"/.c9\" || relativePath == \"/.vscode\" || relativePath == \"/.git\") {\n  283:                             return Promise.resolve();\n  284:                         }\n  285:                         return new Promise((resolve, reject) => {"}}, {"message": "relativePath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 291, "start_column": 58, "end_line": null, "end_column": 70, "snippet": "  286:                             var filepath = path.join(inodePath, file);\n  287:                             console.log(\"Beginning upload processing of \" + filepath + \" (\" + relativePath + \")\");\n  288:                             fs.stat(filepath, (err, fstat) => {\n  289:                                 if (fstat.isDirectory()) {\n  290:                                     this.eventEmitter.emit('send_ch4_message', [\"mkdir\", relativePath, {}, { \"$\": this.websocketProvider.next_event_id() }]);\n  291:                                     this.recursiveUpload(relativePath).then(function () {\n  292:                                         resolve();\n  293:                                     }).catch((err) => {\n  294:                                         console.error(err);\n  295:                                     });\n  296:                                 }"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 233, "start_column": 21, "end_line": null, "end_column": 30, "snippet": "  228:                 console.log(body);\n  229:                 resolve();\n  230:             });\n  231:         });\n  232:     }\n  233:     recursiveUpload(startPath) {\n  234:         console.log(\"Performing lookup from \" + startPath);\n  235:         return new Promise((resolve, reject) => {\n  236:             let workspacePath = this.getFileWorkspacePath();\n  237:             if (workspacePath == null) {\n  238:                 vscode.window.showWarningMessage(\"Could not find local directory to sync to\");"}}, {"message": "startPath", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/fileManager.js", "start_line": 244, "start_column": 150, "end_line": null, "end_column": 159, "snippet": "  239:                 reject(\"no local directory\");\n  240:                 return;\n  241:             }\n  242:             let inodePath = path.join(workspacePath, startPath + \"/\");\n  243:             request.get({\n  244:                 url: 'https://vfs.cloud9.' + this.awsregion + '.amazonaws.com/vfs/' + this.environmentId + '/environment' + Utils.EnsureLeadingSlash(startPath) + \"/\",\n  245:                 jar: this.cookieJar,\n  246:                 headers: {\n  247:                     'Content-Type': 'text/plain',\n  248:                     'Origin': 'https://' + this.awsregion + '.console.aws.amazon.com',\n  249:                     'Referer': 'https://' + this.awsregion + '.console.aws.amazon.com/cloud9/ide/' + this.environmentId,"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 156, "start_column": 29, "end_line": null, "end_column": 32, "snippet": "  151:         }\n  152:     });\n  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;"}}, {"message": "str", "location": {"uri": "mnt/drive/vscode_extensions/data/download_packages/iann0036.live-share-for-aws-cloud9-0.11.4/extension/utils.js", "start_line": 158, "start_column": 16, "end_line": null, "end_column": 17, "snippet": "  153:     return filePath.replace(rootPath, \"\").replace(\"\\\\\", \"/\");\n  154: }\n  155: exports.GetShortFilePath = GetShortFilePath;\n  156: function EnsureLeadingSlash(str) {\n  157:     if (str[0] == '/' || str[0] == '\\\\')\n  158:         return str;\n  159:     return \"/\" + str;\n  160: }\n  161: exports.EnsureLeadingSlash = EnsureLeadingSlash;\n  162: function GetRegion() {\n  163:     let extensionConfig = vscode.workspace.getConfiguration('cloud9sync');"}}]}
